
<!DOCTYPE HTML>
<html lang="de" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Konfigurationsdatei wollmux.conf · WollMux Handbuch</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Landeshauptstadt München">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-atoc/atoc.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-forkmegithub/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Schnittstellen_des_WollMux_fuer_Experten.html" />
    
    
    <link rel="prev" href="Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Suchbegriff eingeben" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://www.wollmux.org" target="_blank" class="custom-link">Homepage</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Einführung
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../Features.html">
            
                <a href="../Features.html">
            
                    
                    Features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../Getting_Started.html">
            
                <a href="../Getting_Started.html">
            
                    
                    Getting started
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Handbuch_des_WollMux.html">
            
                <a href="Handbuch_des_WollMux.html">
            
                    
                    WollMux 18.1
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="Handbuch_des_WollMux.html">
            
                <a href="Handbuch_des_WollMux.html">
            
                    
                    Handbuch des WollMux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1.1" data-path="Bedienelemente_des_WollMux.html">
            
                <a href="Bedienelemente_des_WollMux.html">
            
                    
                    Bedienelemente des WollMux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.2" data-path="Datenbanken_mit_dem_WollMux_verwenden.html">
            
                <a href="Datenbanken_mit_dem_WollMux_verwenden.html">
            
                    
                    Datenbanken mit dem WollMux verwenden
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.3" data-path="Dokumentkommandos_des_WollMux.html">
            
                <a href="Dokumentkommandos_des_WollMux.html">
            
                    
                    Dokumentkommandos des WollMux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.4" data-path="Format_von_WollMux-Config-Dateien.html">
            
                <a href="Format_von_WollMux-Config-Dateien.html">
            
                    
                    Format von WollMux Config Dateien
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.5" data-path="Formatvorlagen.html">
            
                <a href="Formatvorlagen.html">
            
                    
                    Formatvorlagen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.6" data-path="FormularMax_4000.html">
            
                <a href="FormularMax_4000.html">
            
                    
                    FormularMax 4000
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.7" data-path="Fragen_rund_um_Datenquellen.html">
            
                <a href="Fragen_rund_um_Datenquellen.html">
            
                    
                    Fragen rund um Datenquellen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.8" data-path="Funktionen_des_WollMux_in_der_Praxis.html">
            
                <a href="Funktionen_des_WollMux_in_der_Praxis.html">
            
                    
                    Funktionen des WollMux in der Praxis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.9" data-path="Funktionen_im_WollMux_-_Workshop.html">
            
                <a href="Funktionen_im_WollMux_-_Workshop.html">
            
                    
                    Funktionen im WollMux - Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.10" data-path="Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.html">
            
                <a href="Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.html">
            
                    
                    Hilfen für Sachleitende Verfügungen verwenden
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.1.11" data-path="Konfigurationsdatei_wollmux_conf.html">
            
                <a href="Konfigurationsdatei_wollmux_conf.html">
            
                    
                    Konfigurationsdatei wollmux.conf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.12" data-path="Schnittstellen_des_WollMux_fuer_Experten.html">
            
                <a href="Schnittstellen_des_WollMux_fuer_Experten.html">
            
                    
                    Schnittstellen des WollMux für Experten
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.13" data-path="Standardkonfiguration_des_WollMux.html">
            
                <a href="Standardkonfiguration_des_WollMux.html">
            
                    
                    Standardkonfiguration des WollMux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.14" data-path="Standardkonfiguration_des_WollMux_installieren_und_pflegen.html">
            
                <a href="Standardkonfiguration_des_WollMux_installieren_und_pflegen.html">
            
                    
                    Standardkonfiguration des WollMux installieren und pflegen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.15" data-path="Textfragmente_im_WollMux.html">
            
                <a href="Textfragmente_im_WollMux.html">
            
                    
                    Textfragmente im WollMux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.1.16" data-path="WollMuxBar.html">
            
                <a href="WollMuxBar.html">
            
                    
                    WollMux-Sidebar
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="FormularMax/FormularMax.html">
            
                <a href="FormularMax/FormularMax.html">
            
                    
                    Handbuch des FormularMax
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="FormularMax/WollMux_Vorlage.html">
            
                <a href="FormularMax/WollMux_Vorlage.html">
            
                    
                    Erstellung einer (WollMux-)Vorlage
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="FormularMax/Erstellung_oder_Anpassung_einer_Vorlage_-_Beispiel.html">
            
                <a href="FormularMax/Erstellung_oder_Anpassung_einer_Vorlage_-_Beispiel.html">
            
                    
                    Erstellung oder Anpassung einer Vorlage - Beispiel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="FormularMax/SLV.html">
            
                <a href="FormularMax/SLV.html">
            
                    
                    Sachleitende Verfügungen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="FormularMax/FM4000.html">
            
                <a href="FormularMax/FM4000.html">
            
                    
                    Formular erstellen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="FormularMax/Komfortfunktionen.html">
            
                <a href="FormularMax/Komfortfunktionen.html">
            
                    
                    Komfortfunktionen und weitere Features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="FormularMax/KomboSeriendruck.html">
            
                <a href="FormularMax/KomboSeriendruck.html">
            
                    
                    Kombinationsmöglichkeiten mit dem Seriendruck
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.7" data-path="FormularMax/MS_Word_Vorlagen.html">
            
                <a href="FormularMax/MS_Word_Vorlagen.html">
            
                    
                    Umstellung von MS Word Vorlagen
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="MailMerge/Seriendruck.html">
            
                <a href="MailMerge/Seriendruck.html">
            
                    
                    Seriendruck Handbuch
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="MailMerge/Seriendruck_erweiterte_Funktion.html">
            
                <a href="MailMerge/Seriendruck_erweiterte_Funktion.html">
            
                    
                    Seriendruck, erweiterte Funktion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="MailMerge/Seriendruckvorlagen_mit_dem_WollMux_erstellen.html">
            
                <a href="MailMerge/Seriendruckvorlagen_mit_dem_WollMux_erstellen.html">
            
                    
                    Seriendruckvorlagen mit dem WollMux erstellen
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../README.md">
            
                <span>
            
                    
                    Hidden
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Veröffentlicht mit GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Konfigurationsdatei wollmux.conf</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="wollmux-konfiguration">WollMux Konfiguration</h1>
<!-- toc -->
<ul>
<li><a href="#der-defaultcontext">Der DEFAULT_CONTEXT</a></li>
<li><a href="#einbinden-referatseigener-pluginsclasspath">Einbinden referatseigener Plugins/CLASSPATH</a></li>
<li><a href="#logging-und-debugging">Logging und Debugging</a><ul>
<li><a href="#der-loggingmode">Der LOGGING_MODE</a></li>
<li><a href="#der-debugmodus">Der Debugmodus</a></li>
</ul>
</li>
<li><a href="#der-persistentdatamode">Der PERSISTENT_DATA_MODE</a></li>
<li><a href="#der-abschnitt-oooeinstellungen">Der Abschnitt OOoEinstellungen</a><ul>
<li><a href="#bestimmung-von-node-prop-und-type">Bestimmung von NODE, PROP und TYPE</a></li>
</ul>
</li>
<li><a href="#look-and-feel-konfiguration">Look And Feel Konfiguration</a></li>
<li><a href="#dialoge">Dialoge</a><ul>
<li><a href="#fontzoom">FONT_ZOOM</a></li>
<li><a href="#warndialog-bei-mehrfacher-installation-des-wollmux">Warndialog bei mehrfacher Installation des WollMux</a><ul>
<li><a href="#warndialog-deaktivieren">Warndialog deaktivieren</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#textfragmente">Textfragmente</a><ul>
<li><a href="#der-abschnitt-textfragmente">Der Abschnitt Textfragmente</a><ul>
<li><a href="#fragmentbeschreibungn"><fragmentbeschreibungn></fragmentbeschreibungn></a><ul>
<li><a href="#fragid-regex">FRAG_ID &quot;&lt;regex&gt;&quot;</a></li>
<li><a href="#url-urldertextfragment-datei">URL &quot;&lt;URL_der_Textfragment-Datei&gt;&quot;</a></li>
</ul>
</li>
<li><a href="#variablen">Variablen</a><ul>
<li><a href="#variablen-definition-mit-var">Variablen-Definition mit VAR</a></li>
<li><a href="#variablen-referenzieren">Variablen referenzieren</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#textbausteine">Textbausteine</a><ul>
<li><a href="#separator">SEPARATOR</a></li>
<li><a href="#warnungen">Warnungen</a><ul>
<li><a href="#msgtoomanyargs-argument">MSG_TOO_MANY_ARGS <argument></argument></a></li>
</ul>
</li>
<li><a href="#kuerzel">Kuerzel</a><ul>
<li><a href="#matchlistemitregexstrings-">MATCH(<listemitregexstrings> )</listemitregexstrings></a></li>
<li><a href="#fragid-replacementstring">FRAG_ID &apos;&lt;replacementString&gt;&apos;</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#tastenkuerzel">Tastenkuerzel</a><ul>
<li><a href="#shortcut-tastenkombination">SHORTCUT &quot;&lt;Tastenkombination&gt;&quot;</a></li>
<li><a href="#url-dispatchkommando">URL &quot;&lt;Dispatch_Kommando&gt;&quot;</a></li>
</ul>
</li>
<li><a href="#datenquellen">Datenquellen</a><ul>
<li><a href="#der-abschnitt-datenquellen">Der Abschnitt <em>Datenquellen</em></a></li>
<li><a href="#registriere">Registriere</a></li>
<li><a href="#datenquellen-referenzen">Datenquellen-Referenzen</a></li>
<li><a href="#sendersource">SENDER_SOURCE</a></li>
<li><a href="#datasourcetimeout">DATASOURCE_TIMEOUT</a></li>
<li><a href="#overridefragdbspalte">OVERRIDE_FRAG_DB_SPALTE</a></li>
<li><a href="#der-abschnitt-absenderdatenspaltenumsetzung">Der Abschnitt <em>AbsenderdatenSpaltenumsetzung</em></a></li>
<li><a href="#unterst&#xFC;tzte-datenquellen-typen">Unterst&#xFC;tzte Datenquellen-Typen</a><ul>
<li><a href="#type-ldap">TYPE &quot;ldap&quot;</a><ul>
<li><a href="#url-url">URL &quot;&lt;url&gt;&quot;</a></li>
<li><a href="#basedn-dn">BASE_DN &quot;&lt;dn&gt;&quot;</a></li>
<li><a href="#user-user">USER &quot;&lt;user&gt;&quot;</a></li>
<li><a href="#password-password">PASSWORD &quot;&lt;password&gt;&quot;</a></li>
<li><a href="#objectclass-klasse">OBJECT_CLASS &quot;&lt;Klasse&gt;&quot;</a></li>
<li><a href="#spalten-beschreibung">Spalten-Beschreibung</a><ul>
<li><a href="#dbspalte-spaltenname">DB_SPALTE &quot;&lt;Spaltenname&gt;&quot;</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- tocstop -->
<p>Der WollMux hat konzeptuell nur eine einzige Konfigurationsdatei, im Folgenden als <em>wollmux.conf</em> bezeichnet. In der Praxis wird diese meist mit Hilfe des <a href="Format_von_WollMux-Config-Dateien.html#include">%include-Mechanismus</a> auf mehrere Dateien verteilt (siehe <a href="Format_von_WollMux-Config-Dateien.html">Format vonWollMux-Config-Dateien</a>). Die <em>wollmux.conf</em> wird vom WollMux an folgenden Stellen in der angegebenen Reihenfolge gesucht:</p>
<p><strong>Unter Windows:</strong></p>
<ol>
<li>&#xFC;ber die Umgebungsvariable %WOLLMUX_CONF_PATH% (Pfad inklusive Dateiname, Beispiel: <em>C:\Programme\wollmux\wollmux.conf</em>)</li>
<li><em>&lt;Profilverzeichnis&gt;/.wollmux/wollmux.conf</em>, wobei &lt;Profilverzeichnis&gt; auf einem deutschen Windows das Verzeichnis &quot;C:\Benutzer\&lt;Benutzername&gt;&quot; bezeichnet</li>
<li>unter dem Dateipfad (inkl. Dateiname), der im Wert &quot;ConfigPath&quot; im Registrierungsschl&#xFC;ssel <em>HKEY_CURRENT_USER\Software\WollMux</em> festgelegt ist</li>
<li>unter dem Dateipfad (inkl. Dateiname), der im Wert &quot;ConfigPath&quot; im Registrierungsschl&#xFC;ssel <em>HKEY_LOCAL_MACHINE\Software\WollMux</em> festgelegt ist</li>
<li><em>%APPDATA%/.wollmux/wollmux.conf</em>, wobei %APPDATA% auf einem deutschen Windows das Verzeichnis &quot;C:\Benutzer\&lt;Benutzername&gt;\AppData\Roaming&quot; bezeichnet</li>
<li><em>%COMMON_APPDATA/.wollmux/wollmux.conf</em>, wobei %COMMON_APPDATA% auf einem deutschen Windows das Verzeichnis &quot;C:\ProgramData&quot; bezeichnet</li>
<li><em>C:\Programme (x86)\.wollmux\wollmux.con</em></li>
<li><em>C:\Programme\.wollmux\wollmux.conf</em></li>
</ol>
<p><strong>Unter Linux:</strong></p>
<ol>
<li>&#xFC;ber die Umgebungsvariable $WOLLMUX_CONF_PATH (Pfad inklusive Dateiname, Beispiel: <em>/etc/wollmux/wollmux.conf</em>)</li>
<li><em><code>$HOME</code>/.wollmux/wollmux.conf</em></li>
<li><em>&lt;Startverzeichnis&gt;/.wollmux/wollmux.conf</em>, wobei &lt;Startverzeichnis&gt; den Ordner bezeichnet, in dem die Anwendung aufgerufen wird.</li>
<li><em>/etc/wollmux/wollmux.conf</em></li>
</ol>
<p>Sobald die Konfigurationsdatei gefunden wurde, wird vom WollMux nicht mehr an den &#xFC;brigen Stellen weitergesucht. Wenn also unter Linux eine Datei <em><code>$HOME</code>/.wollmux/wollmux.conf</em> existiert, ist das eventuelle Vorhandensein einer Konfigurationsdatei unter <em>/etc/wollmux/wollmux.conf</em> irrelevant und wird vom WollMux ignoriert.</p>
<p>Bitte achten Sie beim Editieren der wollmux.conf immer auf die <strong>korrekte Gross-/Kleinschreibung</strong>! Verwenden Sie bitte insbesondere alle Schl&#xFC;ssel (bzw. Attribute) ausschlie&#xDF;lich wie in der hier beschriebenen Form.</p>
<p>Seit WollMux 13.5 wird f&#xFC;r die WollMux-SideBar neben der Datei <em>wollmux.conf</em> auch die Datei <em>wollmuxbar.conf</em> ausgewertet. Dies ist ausf&#xFC;hrlicher beschrieben auf der Seite <a href="WollMuxBar.html#konfiguration">WollMux-SideBar</a>.</p>
<h2 id="der-defaultcontext">Der DEFAULT_CONTEXT</h2>
<p>Der DEFAULT_CONTEXT beschreibt einen Verzeichnis-Pfad in <a href="Format_von_WollMux-Config-Dateien.html#urls">URL-Notation</a>, an dem zentrale WollMux-Daten (z.B. Textfragmente, Benutzerdaten) abgelegt sind. An verschiedenen Stellen der wollmux.conf wird der DEFAULT_CONTEXT als Basis zur Aufl&#xF6;sung relativer URLs verwendet. Dies ist an den entsprechenden Stellen vermerkt. Die Syntax zur Festlegung des DEFAULT_CONTEXT ist wie folgt:</p>
<p><code>DEFAULT_CONTEXT &quot;&lt;url&gt;&quot;</code></p>
<p>Dazu ein kleines Beispiel:</p>
<p><code>DEFAULT_CONTEXT &quot;[file:///L:/WollMuxDaten](file:///L:/WollMuxDaten)&quot; # WollMux-Daten werden im zentralen Verzeichnis L:/WollMuxDaten vorgehalten.</code></p>
<p>Der DEFAULT_CONTEXT kann &#xFC;berall auf oberster Ebene der Konfigurationsdatei au&#xDF;erhalb aller Abschnitte definiert werden. Der DEFAULT_CONTEXT kann an einer sp&#xE4;teren Stelle in der Konfigurationsdatei redefiniert werden. Die letzte Definition hat G&#xFC;ltigkeit f&#xFC;r die <em>gesamte</em> wollmux.conf.</p>
<p>Wird der DEFAULT_CONTEXT nicht angegeben, so wird das Verzeichnis als DEFAULT_CONTEXT verwendet, in dem die wollmux.conf <a href="#top">gefunden wurde</a>.</p>
<p>Wird ein relativer Pfad als DEFAULT_CONTEXT angegeben (z.B. ../netzlaufwerke/fileserver/wollmux), so wird dieser relativ zu dem Verzeichnis ausgewertet, in dem die wollmux.conf <a href="#top">gefunden wurde</a>.</p>
<h2 id="einbinden-referatseigener-pluginsclasspath">Einbinden referatseigener Plugins/CLASSPATH</h2>
<p>Der WollMux erlaubt den Referaten an verschiedenen Stellen das Einbinden eigener Plugins, z.B. zur Transformation von aus einer Datenquelle eingef&#xFC;gten Werten oder um Komfortdruckfunktionen zur Verf&#xFC;gung zu stellen. Das Einbinden derartiger externer Funktionen erfolgt mittels <a href="#extern-url--params--">EXTERN-Grundfunktion</a>. Dies kann global in den Abschnitten <a href="#druckfunktionen">Druckfunktionen</a> und <a href="#funktionen">Funktionen</a> erfolgen, oder direkt in einer Vorlage. Siehe hierzu die [entsprechende Dokumentation zum FormularMax 4000] (FormularMax_4000.md#referatsspezifische-plugins).</p>
<p>Der eigentliche Programmcode der externen Funktion muss als statische Methode einer beliebigen Klasse realisiert sein. Damit der WollMux die entsprechende Klasse auch findet, muss das Verzeichnis bzw. die JAR-Datei in der die Klasse enthalten ist dem WollMux &#xFC;ber CLASSPATH-Direktiven bekannt gemacht werden. Im folgenden einige Beispiele f&#xFC;r erlaubte CLASSPATH-Angaben:</p>
<pre><code>CLASSPATH( &quot;file:///usr/share/wollmux/&quot; &quot;http://foo.bar.muenchen.de/funktionen.jar&quot;)
CLASSPATH &quot;file:///usr/share/wollmux/&quot;
</code></pre><p>Zu beachten ist:</p>
<ul>
<li>CLASSPATH-Angaben m&#xFC;ssen auf oberster Verschachtelungsebene der wollmux.conf stehen.</li>
<li>Die angebenen Werte sind immer URLs.</li>
<li>Es wird <em>nicht</em> das Verzeichnis angegeben, in dem sich die .class Datei befindet, sondern das Oberverzeichnis der Package-Hierarchie. Die .class-Datei muss sich in einer ihrem Package entsprechendem Unterverzeichnis befinden. Beispiel: Die Funktion de.muenchen.sozref.Druck.komfortDruck() ist in der .class Datei Druck.class zu finden. Diese Datei liegt im Verzeichnis /usr/share/wollmux/de/muenchen/sozref/. Dann ist die CLASSPATH Angabe dazu &quot;&lt;file:///usr/share/wollmux/&gt;&quot;.</li>
<li>Relative URLs werden relativ zum DEFAULT_CONTEXT aufgel&#xF6;st.</li>
</ul>
<h2 id="logging-und-debugging">Logging und Debugging</h2>
<p>Der WollMux schreibt jede auszugebende Meldung an das Ende der Log-Datei <em>$HOME/.wollmux/wollmux.log</em>, die mit der ersten auszugebenden Meldung automatisch erzeugt wird. Der WollMux kann in den verschiedensten Situationen Meldungen erzeugen, die jedoch nicht alle protokolliert werden m&#xFC;ssen. &#xDC;ber den LOGGING_MODE k&#xF6;nnen Sie steuern, in welchem Detailgrad die Informationen des WollMux protokolliert werden. Die Datei wird nie automatisch gel&#xF6;scht. In der Standardeinstellung schreibt der WollMux jedoch nur Meldungen in die Datei wollmux.log, um &#xFC;ber kritische Fehler oder Meldungen zu informieren. Ein unn&#xF6;tiges Anwachsen der Log-Datei wird dadurch verhindert.</p>
<h3 id="der-loggingmode">Der LOGGING_MODE</h3>
<p>Syntax</p>
<p><code>LOGGING_MODE &quot;&lt;modus&gt;&quot;</code></p>
<p>Beispiel</p>
<pre><code>LOGGING_MODE &quot;ERROR&quot;
oder
LOGGING_MODE &quot;DEBUG&quot;
</code></pre><p>Beschreibung: Steuert den Detaillierungsgrad in dem <strong>Ausgaben des WollMux (und der WollMux-Sidebar) in der Datei wollmux.log</strong> erfolgen.</p>
<p>Dabei kennt der WollMux folgende Modi:</p>
<table>
<thead>
<tr class="header">
<th><p><modus></modus></p></th>
<th><p>Beschreibung</p></th>
<th><p>Debugmodus</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>NONE</p></td>
<td><p>Im Logging-Modus NONE werden in keinem Fall Nachrichten ausgegeben.</p></td>
<td><p>Nein</p></td>
</tr>
<tr class="even">
<td><p>ERROR</p></td>
<td><p>Der Logging-Modus ERROR zeigt nur dann Nachrichten an, wenn bei der Ausf&#xFC;hrung des WollMux Fehler auftreten. Darin sind u.A. enthalten</p>
<ul>
<li>Meldungen &#xFC;ber Fehler in den Konfigurationsdateien,</li>
<li>Meldungen &#xFC;ber Fehler in Vorlagen,</li>
<li>Meldungen &#xFC;ber Fehler beim Zugriff auf die konfigurierten Datenbanken,</li>
<li>Meldungen &#xFC;ber interne Fehler des WollMux.</li>
</ul></td>
<td><p>Nein</p></td>
</tr>
<tr class="odd">
<td><p>LOG</p></td>
<td><p>Im Logging-Modus LOG werden alle Meldungen ausgegeben, die f&#xFC;r den t&#xE4;glichen Einsatz des WollMux interessant und n&#xFC;tzlich sein k&#xF6;nnen, ohne jedoch die Logdatei wollmux.log sinnlos anwachsen zu lassen. Dazu z&#xE4;hlen alle Fehlermeldungen (wie im Logging-Modus ERROR) und zus&#xE4;tzlich wichtige Warnungen oder Informationen im laufenden Betrieb. <strong>Der Logging-Modus LOG ist standardm&#xE4;&#xDF;ig gesetzt</strong>, wenn die Konfigurationsdatei wollmux.conf keine andere Festlegung enth&#xE4;lt.</p></td>
<td><p>Nein</p></td>
</tr>
<tr class="even">
<td><p>DEBUG</p></td>
<td><p>Der Logging-Modus DEBUG wird genutzt, um erg&#xE4;nzend zum Logging-Modus LOG detaillierte Informationen &#xFC;ber den Status des Programmablaufs auszugeben, mit denen die Fehlersuche bei der Entwicklung und Pflege der Konfigurationsdateien, der Textfragmente und Vorlagen und bei der internen Programmentwicklung erleichtert werden kann. Im Logging-Modus DEBUG werden sehr viele Meldungen erzeugt, von denen nicht alle f&#xFC;r den t&#xE4;glichen Einsatz bei Anwenderinnen und Anwendern notwendig sind. Durch die vielen Ausgaben kann sich die Logdatei wollmux.log unn&#xF6;tig aufbl&#xE4;hen und sollte von Zeit zu Zeit manuell wieder gel&#xF6;scht werden. Ist der Logging-Modus DEBUG gesetzt, so reduziert sich die Bearbeitungsgeschwindigkeit des WollMux sp&#xFC;rbar!</p>
<p>Erw&#xE4;hnenswert sind au&#xDF;erdem die ersten drei Ausgaben beim Starten des WollMux im Logging-Modus DEBUG, wie in folgendem Beispiel:</p>
<p><code>2006-07-13 11:14 DEBUG2(Logger:162): =========== Logger::init(): LoggingMode = 7 ==========</code><br>
<br>
<code>2006-07-13 11:14 DEBUG(WollMuxSingleton:146): StartupWollMux</code><br>
<br>
<code>2006-07-13 11:14 DEBUG(WollMuxSingleton:147): </code><strong><code>Build-Info:</code> <code>Paketversion:</code> <code>1.2.1,</code> <code>Revision:</code> <code>986</code></strong></p>
<p>Sie enthalten Informationen &#xFC;ber die eingesetzte WollMux-Version, die Sie insbesondere bei R&#xFC;ckfragen zum WollMux oder bei der Meldung von Problemen stets angegeben sollten.</p></td>
<td><p>Ja</p></td>
</tr>
<tr class="odd">
<td><p>ALL</p></td>
<td><p>Der Logging-Modus ALL gibt uneingeschr&#xE4;nkt alle Nachrichten des WollMux aus. Er liefert zus&#xE4;tzlich zum Logging-Modus DEBUG interne Statusinformationen zur&#xFC;ck, die selbst f&#xFC;r normale DEBUG-Zwecke zu detailliert sind und im Regelfall nur von den Entwicklern des WollMux ben&#xF6;tigt werden. F&#xFC;r die reine Fehlersuche bei der Pflege von Konfigurationsdateien, Textfragmenten und Vorlagen ist dieser Modus nicht zu empfehlen.</p></td>
<td><p>Ja</p></td>
</tr>
</tbody>
</table>

<h3 id="der-debugmodus">Der Debugmodus</h3>
<p>Neben dem Logging-Modus, der festlegt welche Meldungen in die wollmux.log-Datei geschrieben werden, gibt es ausserdem eine Betriebsart des WollMux, in der die Fehlersuche f&#xFC;r Vorlagenersteller, Systemverwalter und Entwickler erleichtert werden soll, den sog. Debugmodus. Der Debugmodus ist automatisch eingeschalten, wenn der LOGGING_MODE &quot;DEBUG&quot; oder &quot;ALL&quot; gesetzt ist (siehe auch obige Tabelle).</p>
<p>Im Debugmodus verh&#xE4;lt sich der WollMux in folgenden Punkten anders als bei nicht gesetztem Debugmodus:</p>
<ul>
<li>Beim &#xD6;ffnen einer Vorlage f&#xFC;hrt der WollMux alle darin enthaltenen Dokumentkommandos aus. Im Normalfall werden danach alle Bookmarks der vollst&#xE4;ndig abgearbeiteten Dokumentkommandos aus dem Dokument entfernt. Im Debugmodus bleiben die Bookmarks der Dokumentkommandos erhalten. Auf diese Weise k&#xF6;nnen Fehler in Dokumentkommandos leichter gefunden werden, ohne die entsprechende Vorlage zum Bearbeiten &#xF6;ffnen zu m&#xFC;ssen.</li>
</ul>
<h2 id="der-persistentdatamode">Der PERSISTENT_DATA_MODE</h2>
<p>Syntax</p>
<p><code>PERSISTENT_DATA_MODE &quot;&lt;modus&gt;&quot;</code></p>
<p>Beispiel</p>
<pre><code>PERSISTENT_DATA_MODE &quot;transition&quot;
oder
PERSISTENT_DATA_MODE &quot;rdfReadLegacy&quot;
</code></pre><p>F&#xFC;r mehrere Zwecke speichert der WollMux bestimmte Informationen &#xFC;ber interne Zust&#xE4;nde (sog. Metadaten) im Dokument ab. &#xDC;ber das Setzen von PERSISTENT_DATA_MODE kann gesteuert werden wie und wo der WollMux diese Daten hinterlegt. Folgende Werte stehen zur Auswahl:</p>
<table>
<thead>
<tr class="header">
<th><p><modus></modus></p></th>
<th><p>Beschreibung</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>annotation<br>
<em>(deprecated)</em></p></td>
<td><p>Im Modus &quot;annotation&quot; werden Metadaten wie standardm&#xE4;&#xDF;ig in allen Vorg&#xE4;ngerversionen von WollMux 11.9 in versteckten Notizen im Dokument hinterlegt. Dieser Mechanismus hat sich in der Vergangenheit als Fehleranf&#xE4;llig erwiesen, da Notizen nicht f&#xFC;r die Speicherung von Metadaten vorgesehen sind. Seit OpenOffice.org 3.0 wurde das Benutzerkonzept f&#xFC;r Notizen/Kommentare komplett &#xFC;berarbeitet und vereinfacht, so dass sich die Speicherung von WollMux-Metdaten in Notizen f&#xFC;r Anwenderinnen und Anwender zunehmend st&#xF6;rend auswirkt. So kam es z.B. vor, dass Metadaten ungewollt f&#xFC;r Anwenderinnen und Anwender sichtbar wurden.</p>
<p><strong>Von einer Verwendung dieses Modus wird ausdr&#xFC;cklich abgeraten</strong>. Der Modus kann in Einzelf&#xE4;llen eingesetzt werden, um im Fehlerfall das Verhalten von WollMux-Versionen &#xE4;lter als 11.9 nachzubilden.</p></td>
</tr>
<tr class="even">
<td><p>rdf</p></td>
<td><p>Im Modus &quot;rdf&quot; werden Metadaten in einer eigenen XML-Datei namens &quot;wollmux.rdf&quot; im ODF-Paket des Dokuments abgelegt. Dieser Modus sorgt daf&#xFC;r, dass WollMux-Metadaten und das eigentliche Dokument sauber getrennt sind und keine st&#xF6;renden Effekte m&#xF6;glich sind. Da der RDF-Modus explizit eine <a href="http://wiki.services.openoffice.org/wiki/Documentation/DevGuide/OfficeDev/RDF_metadata" target="_blank">UNO-Schnittstelle f&#xFC;r Metadaten</a> verwendet, ist davon auszugehen, dass der Modus &quot;rdf&quot; dauerhaft stabil und zuverl&#xE4;ssig bleiben wird.</p>
<p>Der Modus &quot;rdf&quot; ist aus konzeptioneller Sicht der sauberste Weg zur Speicherung von WollMux-Metadaten. In diesem Modus werden Metadaten ausschlie&#xDF;lich in die XML-Datei geschrieben und ausschlie&#xDF;lich von dort gelesen. Das macht den Modus in der Praxis ungeeignet, wenn bereits WollMux-Dokumente im Modus &quot;annotation&quot; (also mit &#xE4;lteren WollMux-Versionen) erzeugt wurden und diese sich noch im Umlauf befinden.</p>
<p><strong>Von einer Verwendung dieses Modus wird abgeraten, wenn Ihr Dokumentenbestand Dokumente enth&#xE4;lt, die mit WollMux-Versionen &#xE4;lter als 11.9 erzeugt wurden, oder Austausch mit solchen Dokumenten besteht.</strong> Der Modus ist empfohlen und geeignet f&#xFC;r alle Unternehmen/Kommunen, die ab WollMux 11.9 eine Neueinf&#xFC;hrung des WollMux planen und bisher noch keine WollMux-Dokumente im Einsatz haben.</p></td>
</tr>
<tr class="odd">
<td><p>transition</p></td>
<td><p>Im Modus &quot;transition&quot; werden Metadaten sowohl im Modus &quot;annotation&quot; als auch im Modus &quot;rdf&quot; geschrieben. Beim Lesen von Metadaten haben immer die in den Notizen verf&#xFC;gbaren Werte den Vorrang, so dass die Abw&#xE4;rtskompatibilit&#xE4;t in der Phase eines Mischbetriebs von WollMux 11.9 und &#xE4;lter problemfrei sichergestellt ist.</p>
<p><strong>Dieser Modus erm&#xF6;glicht mittelfristig die &#xDC;berf&#xFC;hrung des Dokumentenbestands in die XML-Metadaten (siehe Modus &quot;rdf&quot;), ohne den Mischbetrieb mit alten WollMux-Versionen (im Modus &quot;annotation&quot;) zu gef&#xE4;hrden.</strong></p></td>
</tr>
<tr class="even">
<td><p>rdfReadLegacy</p></td>
<td><p>Im Modus &quot;rdfReadLegacy&quot; werden Metadaten ausschlie&#xDF;lich wie in Modus &quot;rdf&quot; gespeichert. Befinden sich im Dokument noch mit &quot;annotation&quot; geschriebene Notizen, so werden sie aus Gr&#xFC;nden der Abw&#xE4;rtskompatibilit&#xE4;t vorrangig gelesen, jedoch anschlie&#xDF;end sofort gel&#xF6;scht und durch entsprechende Eintr&#xE4;ge in den RDF-Daten ersetzt.</p>
<p><strong>Dieser Modus ist f&#xFC;r den langfristigen Einsatz</strong> in allen Unternehmen/Kommunen <strong>vorgesehen</strong>, die bereits WollMux-Dokumente mit in Notizen hinterlegten Metadaten im Einsatz haben und fl&#xE4;chendeckend &#xE4;ltere WollMux-Versionen (im Modus &quot;annotation&quot;) abgel&#xF6;st haben.&apos;&apos;&apos;</p></td>
</tr>
<tr class="odd">
</tr>
</tbody>
</table>

<p>Ist die Einstellung PERSISTENT_DATA_MODE nicht angegeben, so gilt:</p>
<ul>
<li>F&#xFC;r Alle WollMux-Versionen &lt; Version 11.9 ist implizit der Modus &quot;annotation&quot; gesetzt.</li>
<li>Ab WollMux-Version 11.9 ist der Modus &quot;transition&quot; voreingestellt.</li>
<li>Ab WollMux-Version 18.0 ist der Modus &quot;rdfReadLegacy&quot; voreingestellt.</li>
</ul>
<p>Weitere Informationen zu WollMux-Metadaten sind auf der Seite <a href="Dokumentkommandos_des_WollMux.html#wollmux-metadaten-im-dokument">Dokumentkommandos des WollMux</a> beschrieben.</p>
<h2 id="der-abschnitt-oooeinstellungen">Der Abschnitt OOoEinstellungen</h2>
<p>F&#xFC;r die korrekte Funktionsf&#xE4;higkeit des WollMux ist es notwendig, dass bestimmte Konfigurationsoptionen in LibreOffice eingestellt sind. Um das zu erreichen, k&#xF6;nnen im Abschnitt &quot;OOoEinstellungen&quot; Werte f&#xFC;r Konfigurationseinstellungen vorgegeben werden, die bei jedem Start des WollMux neu gesetzt werden.</p>
<p>Hier ein Beispiel eines solchen Abschnitts:</p>
<pre><code>OOoEinstellungen (

  (NODE &quot;/org.openoffice.Office.Writer/AutoFunction/Format/ByInput/ApplyNumbering&quot;
   PROP &quot;Enable&quot; TYPE &quot;boolean&quot;
   VALUE &quot;false&quot;)

  (NODE &quot;/org.openoffice.Office.Writer/Content/NonprintingCharacter&quot;
   PROP &quot;HiddenCharacter&quot; TYPE &quot;boolean&quot;
   VALUE &quot;false&quot;)

  (NODE &quot;/org.openoffice.Inet/Settings&quot;
   PROP &quot;ooInetProxyType&quot; TYPE &quot;integer&quot;
   VALUE &quot;0&quot;)

)
</code></pre><p>Wie im Beispiel gezeigt enth&#xE4;lt der Abschnitt eine Liste mit Konfigurationsoptionen und den zugeh&#xF6;rigen Werten. Jedes Element der Liste hat den Aufbau</p>
<p><code>(NODE &quot;&lt;Pfad/Knotenname&gt;&quot; PROP &quot;&lt;NameDerProperty&gt;&quot; TYPE &quot;&lt;DatentypDerProperty&gt;&quot; VALUE &quot;&lt;zuSetzenderWert&gt;&quot;)</code></p>
<ul>
<li>NODE: Beschreibt den Pfad und den Knotennamen unter dem die Konfigurationseinstellung im OOo-Konfigurationsbaum liegt. (Anmerkung: Technisch gesehen ist dies der HierarchicalName)</li>
<li>PROP: Beschreibt den Namen der Property und damit die zu ver&#xE4;ndernde Einstellung selbst.</li>
<li>TYPE: Beschreibt den Datentyp, in dem der Wert VALUE in die Property &#xFC;bertragen werden soll. Folgende Typen stehen zur Auswahl: &quot;string&quot;, &quot;boolean&quot;, &quot;integer&quot; und &quot;float&quot;.</li>
<li>VALUE: Enth&#xE4;lt den zu setzenden Wert, der vom Typ TYPE sein muss. Entspricht der Wert nicht dem angegebenen Typ, so erscheint eine Fehlermeldung in der wollmux.log und die Einstellung wird nicht gesetzt.</li>
</ul>
<p>Innerhalb der Konfigurationsdatei wollmux.conf k&#xF6;nnen mehrere Abschnitte OOoEinstellungen definiert werden, wobei alle darin enthalten Einstellungen der Reihe nach gesetzt werden. So ist es z.B. m&#xF6;glich zentrale Vorgaben &#xFC;ber die WollMux-Standard-Config zu machen, die dann in der Datei referat.conf bei Bedarf erweitert werden k&#xF6;nnen.</p>
<h3 id="bestimmung-von-node-prop-und-type">Bestimmung von NODE, PROP und TYPE</h3>
<p>Wenn bereits eine Konfigurationsdatei (*.xcu) vorliegt, so k&#xF6;nnen die Namen aus dem Inhalt dieser Datei abgeleitet werden. Z.B.</p>
<pre><code class="lang-xml"><span class="php"><span class="hljs-meta">&lt;?</span>xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span><span class="hljs-meta">?&gt;</span></span>
<span class="hljs-tag">&lt;<span class="hljs-name">oor:component-data</span> <span class="hljs-attr">xmlns:oor</span>=<span class="hljs-string">&quot;http://openoffice.org/2001/registry&quot;</span> <span class="hljs-attr">xmlns:xs</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span> <span class="hljs-attr">oor:name</span>=<span class="hljs-string">&quot;Inet&quot;</span> <span class="hljs-attr">oor:package</span>=<span class="hljs-string">&quot;org.openoffice&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">node</span> <span class="hljs-attr">oor:name</span>=<span class="hljs-string">&quot;Settings&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">prop</span> <span class="hljs-attr">oor:name</span>=<span class="hljs-string">&quot;ooInetProxyType&quot;</span> <span class="hljs-attr">oor:type</span>=<span class="hljs-string">&quot;xs:int&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span>
   <span class="hljs-tag">&lt;/<span class="hljs-name">prop</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">node</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">oor:component-data</span>&gt;</span>
</code></pre>
<ul>
<li>NODE = /org.openoffice.Inet/Settings</li>
<li>PROP = ooInetProxyType</li>
<li>TYPE = integer</li>
</ul>
<p>Also in etwa nach der Regel:</p>
<ul>
<li>NODE = &quot;/&quot; + <oor:component-data oor:package=""> + &quot;.&quot; +
<oor:component-data oor:name=""> + &quot;/&quot; + <node oor:name=""> [ + &quot;/&quot; +
<node oor:name=""> ](f&#xFC;r jeden Unterknoten)</node></node></oor:component-data></oor:component-data></li>
<li>PROP = <prop oor:name=""></prop></li>
<li>TYPE = Abgeleitet aus <prop oor:type=""> (z.B. xs:int &#x2192; integer)</prop></li>
</ul>
<h2 id="look-and-feel-konfiguration">Look And Feel Konfiguration</h2>
<p>Ab WollMux 11.9 wird das globale Attribut LAF_CLASS_NAME ausgewertet.</p>
<p>Syntax</p>
<p><code>LAF_CLASS_NAME &quot;&lt;package.class&gt;&quot;</code></p>
<p>Beispiel</p>
<p><code>LAF_CLASS_NAME &quot;com.sun.java.swing.plaf.nimbus.NimbusLookAndFeel&quot;</code></p>
<p>&#xDC;ber das Setzen des LAF_CLASS_NAME wird somit die Oberfl&#xE4;che aller WollMux-Dialoge an das vorgegebene LookAndFeel angepasst. Diese Option ist besonders f&#xFC;r Anwendungen interessant, die den WollMux einbetten m&#xF6;chten. Bei unterschiedlichen LookAndFeels des WollMux und der Anwendung kommt es ansonsten sehr wahrscheinlich zu Problemen.</p>
<p>Wird diese Option nicht verwendet, bleibt das Metal-LAF (javax.swing.plaf.metal.MetalLookAndFeel) die Standardeinstellung.</p>
<h2 id="dialoge">Dialoge</h2>
<p>Der WollMux hat verschiedene Dialoge, die sich konfigurativ beeinflussen und auf die Bed&#xFC;rfnisse der Referate ma&#xDF;schneidern lassen.</p>
<h3 id="fontzoom">FONT_ZOOM</h3>
<p>Durch die Direktive FONT_ZOOM auf der obersten Verschachtelungsebene des Dialoge-Abschnitts kann f&#xFC;r alle WollMux-Eingabemasken die Schriftgr&#xF6;&#xDF;e ver&#xE4;ndert werden. Hinter FONT_ZOOM wird eine Gleitkommazahl angegeben, mit der alle Schriftgr&#xF6;&#xDF;en multipliziert werden. Beispiel</p>
<pre><code>Dialoge(
  FONT_ZOOM &quot;2.0&quot;  # alle Schriften doppelt so gro&#xDF; wie normal.
)
</code></pre><h3 id="warndialog-bei-mehrfacher-installation-des-wollmux">Warndialog bei mehrfacher Installation des WollMux</h3>
<p>Eine h&#xE4;ufige Quelle f&#xFC;r &#xC4;rger und zeitaufendige Fehlersuchen sind sog. Mehrfachinstallationen des WollMux. Sie entstehen &#xFC;blicherweise dann, wenn ein WollMux-Paket installiert wird, w&#xE4;hrend noch ein offener soffice-Prozess l&#xE4;uft. Dadurch kann die alte Version des WollMux-Pakets u.U. nicht fehlerfrei deinstalliert werden und es bleibt eine alte, nicht funktionierende WollMux-Installation &#xFC;brig. Eine Mehrfachinstallation kann auch dann auftreten, wenn eine systemweite Installation und eine benutzerspezifische Installation des WollMux gleichzeitig vorliegen. Als Folge kann es sein, dass der WollMux nicht fehlerfrei arbeitet und unverhersehbare Fehler produziert.</p>
<p>Um die Ursache derartiger Fehler fr&#xFC;hzeitig erkennen zu k&#xF6;nnen, wurde folgender Warndialog eingef&#xFC;hrt. Beim Starten von LibreOffice oder beim &#xD6;ffnen der WollMux-Leiste erfolgt eine Pr&#xFC;fung, ob der WollMux mehrfach installiert ist. Dabei werden sowohl die systemweiten als auch die benutzerspezifischen Installationsziele von LibreOffice untersucht. Wird mehr als eine WollMux-Installation erkannt oder &#xE4;ndert sich das Datum der j&#xFC;ngsten Installation, so wird der Warndialog und eine entsprechende Fehlermeldung in der Datei wollmux.log ausgegeben.</p>
<p>Der angezeigte Text des Warndialogs kann wie im folgenden Beispiel &#xFC;ber den Konfigurationsabschnitt Dialoge/MehrfachinstallationWarndialog frei konfiguriert werden:</p>
<pre><code>Dialoge(
  MehrfachinstallationWarndialog(
    TITLE &quot;Mehrfachinstallation des WollMux&quot;
    MSG(
         &quot;Der WollMux ist mehrfach auf Ihrem System installiert.%n&quot;
         &quot;Dieser Zustand kann zu unerkl&#xE4;rbaren Effekten f&#xFC;hren%n&quot;
         &quot;und sollte daher dringend bereinigt werden.%n&quot;
         &quot;%n&quot;
         &quot;Die j&#xFC;ngste Installation liegt unter:%n&quot;
         &quot;- ${RECENT_INST_PATH}%n&quot;
         &quot;%n&quot;
         &quot;Au&#xDF;erdem wurden folgende Installationen gefunden:%n&quot;
         &quot;${OTHER_INSTS_LIST}&quot;
       )
    )
)
</code></pre><p>Der gesamte Abschnitt MehrfachinstallationWarndialog ist optional. Fehlt er, so wird im Fehlerfall ein Warndialog mit den voreingestellten Inhalten des WollMux angezeigt. Ist der Abschnitt definiert, so k&#xF6;nnen folgende Werte gesetzt werden:</p>
<p>Das Attribut &apos;TITLE&apos;: Das Attribut enth&#xE4;lt die Kopfzeile des Warndialogs. Die Angabe von TITLE ist optional. Wenn TITLE nicht angebeben ist, wird die entsprechende Voreinstellungen des WollMux verwendet.</p>
<p>Das Attribut &apos;MSG&apos;: Das Attribut enth&#xE4;lt den eigentlichen Text Inhalt des Warndialogs. Innerhalb des Abschnitts MehrfachinstallationWarndialog ist die Angabe von MSG immer notwendig. Fehlt MSG, so wird die Anzeige des Dialogs dadurch deaktiviert. Innerhalb von MSG k&#xF6;nnen folgende Variablen verwendet werden, die mit den zur Laufzeit bestimmten Werten des WollMux gef&#xFC;llt werden:</p>
<ul>
<li><strong>${RECENT_INST_PATH}</strong>: Enth&#xE4;lt den Pfad der j&#xFC;ngsten WollMux-Installation, die auf dem System gefunden wurde.</li>
<li><strong>${RECENT_INST_LAST_MODIFIED}</strong>: Enth&#xE4;lt das Datum der letzten &#xC4;nderung der j&#xFC;ngsten WollMux-Installation, die auf dem System gefunden wurde.</li>
<li><strong>${OTHER_INSTS_LIST}</strong>: Enth&#xE4;lt eine Liste mit den Pfaden aller anderen konkurrierenden WollMux-Installation, die auf dem System gefunden wurden.</li>
</ul>
<h4 id="warndialog-deaktivieren">Warndialog deaktivieren</h4>
<p>Zum Deaktivieren des Warndialogs gen&#xFC;gt es, einen leeren Dialoge/MehrfachinstallationWarndialog-Abschnitt in der wollmux.conf zu definieren:</p>
<pre><code>Dialoge(
  MehrfachinstallationWarndialog(
  )
)
</code></pre><p>Der Warndialog wird damit nicht mehr angezeigt. Die entsprechende Fehlermeldung in der Datei wollmux.log erscheint aber trotzdem.</p>
<h2 id="textfragmente">Textfragmente</h2>
<p>Der WollMux unterst&#xFC;tzt sog. &quot;Textfragmente&quot;. Ein Textfragment ist ein Teil des Inhalts eines Gesamtdokuments. Textfragmente k&#xF6;nnen in eigene Dokumentdateien ausgelagert und &#xFC;ber den WollMux zu einem Gesamtdokument zusammengef&#xFC;gt werden. So k&#xF6;nnen Sie Ihre Vorlagen beliebig strukturieren und in flexibel zusammensetzbare Module unterteilen. Das Konzept ist im Artikel <a href="Textfragmente_im_WollMux.html">Textfragmente im WollMux</a> detailliert beschrieben.</p>
<h3 id="der-abschnitt-textfragmente">Der Abschnitt Textfragmente</h3>
<p>Die Liste der im WollMux verf&#xFC;gbaren Textfragmente kann in der Konfigurationsdatei durch die Referate gepflegt werden. Dazu gibt es die Abschnitte <em>Textfragmente</em> mit folgendem Aufbau:</p>
<pre><code>Textfragmente(

   (&lt;Fragmentbeschreibung1&gt;)
   ...
   (&lt;FragmentbeschreibungN&gt;)

)
</code></pre><p>Der Abschnitt Textfragmente darf innerhalb der Konfigurationsdatei mehrfach auftreten. In jedem Textfragmente-Abschnitt k&#xF6;nnen Sie Textfragmente definieren. Der WollMux erkennt die Textfragmente, die in der Gesamtheit aller Textfragment-Abschnitte definiert wurden. Dabei haben Textfragmente die in sp&#xE4;teren Textfragment-Abschnitten definiert sind Vorrang vor Textfragmenten, die in fr&#xFC;heren Abschnitten definiert sind. Die entsprechende Beschreibung sieht wie folgt aus:</p>
<h4 id=""><fragmentbeschreibungn></fragmentbeschreibungn></h4>
<p>Eine Fragmentbeschreibung besteht aus Schl&#xFC;ssel-Wert-Paaren. Sie hat folgenden Aufbau:</p>
<p><code>(FRAG_ID &quot;&lt;regEx&gt;&quot; URL &quot;&lt;URL_der_Textfragment-Datei&gt;&quot;)</code></p>
<p><code>(FRAG_ID &quot;&lt;regEx&gt;&quot; URL (&quot;&lt;url1&gt;&quot; &quot;&lt;url2&gt;&quot; &quot;&lt;urlN&gt;&quot;))</code></p>
<p>Folgende Werte m&#xFC;ssen dabei in jeder Fragmentbeschreibung angegeben werden:</p>
<h5 id="fragid-regex">FRAG_ID &quot;&lt;regex&gt;&quot;</h5>
<p>Die FRAG_ID enth&#xE4;lt einen Kurzbezeichner, der das Textfragment f&#xFC;r die interne Verarbeitung durch den WollMux auszeichnet. Der Bezeichner muss den <a href="Format_von_WollMux-Config-Dateien.html#schl&#xFC;ssel">Syntax-Regeln f&#xFC;r Schl&#xFC;ssel</a> folgen und eindeutig sein. Das bedeutet, dass zwei verschiedene Textfragmente nicht die selbe FRAG_ID besitzen d&#xFC;rfen. Es ist jedoch erlaubt, ein bereits definiertes Textfragment neu zu definieren. Wurde ein Textfragment mehrfach definiert, so gewinnt stets die zuletzt in der Konfigurationsdatei aufgef&#xFC;hrte Definition. FRAG_ID unterst&#xFC;tzt auch <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html" target="_blank">Regul&#xE4;re Ausdr&#xFC;cke</a>.</p>
<h5 id="url-urldertextfragment-datei">URL &quot;&lt;URL_der_Textfragment-Datei&gt;&quot;</h5>
<p>Die URL beschreibt die Datei des entsprechenden Textfragment-Dokuments. Der Aufbau von URLs ist unter <a href="Format_von_WollMux-Config-Dateien.html#urls">Format_von_WollMux-Config-Dateien</a> beschrieben. Relative URLs gelten relativ zu dem Pfad der in <a href="#der-defaultcontext">DEFAULT_CONTEXT</a> festgelegt wurde. Sie k&#xF6;nnen aber auch einen absoluten Pfad angeben ohne den DEFAULT_CONTEXT zu verwenden. Werden mehrere URLs angegeben, wird die erste URL verwendet, die sich fehlerfrei aufl&#xF6;sen l&#xE4;sst.</p>
<p>Wenn innerhalb des regul&#xE4;ren Ausdrucks in der FRAG_ID eine sog. <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html#cg" target="_blank">Capturing-Group</a> definiert wurde, dann kann diese Gruppe in der URL mit der Notation &quot;$n&quot; referenziert werden, wobei n die Nummer der Gruppe ist. Die Gruppe $0 ist dabei standardm&#xE4;&#xDF;ig definiert und enth&#xE4;lt immer den Inhalt der vollst&#xE4;ndigen FRAG_ID. So k&#xF6;nnen abh&#xE4;ngig von der FRAG_ID verschiedene URLs angesprochen werden.</p>
<p>Beispiel:</p>
<pre><code>Textfragmente(
   (FRAG_ID &quot;Abt.*&quot; URL &quot;./vorlagen/fragmente/beispiele/$0.ott&quot;)
)
</code></pre><p>Dieser Ausdruck definiert alle Textfragmente, die mit &quot;Abt&quot; anfangen und leitet sie auf die jeweils entsprechende Datei im Verzeichnis ./vorlagen/fragmente/beispiele/*.ott um. Ein g&#xFC;ltiges Textfragment ist daher z.B. &quot;AbtKopf&quot;, und die zugeh&#xF6;rige Datei wird unter ./vorlagen/fragmente/beispiele/AbtKopf.ott gesucht.</p>
<h4 id="variablen">Variablen</h4>
<p>Durch die Verwendung von Variablen l&#xE4;sst sich die Konfigurationsdatei leichter pflegen. Sie k&#xF6;nnen Variablen z.B. verwenden, um h&#xE4;ufig verwendete Pfade in den obigen URL-Werten nicht mehrfach pflegen zu m&#xFC;ssen.</p>
<h5 id="variablen-definition-mit-var">Variablen-Definition mit VAR</h5>
<p>Eine Variable wird wie folgt definiert:</p>
<p><code>VAR(NAME &quot;Variablenname&quot; VALUE &quot;Inhalt&quot;)</code></p>
<p>Eine Variable kann an verschiedenen Stellen der Konfigurationsdatei definiert werden. Dazu folgendes Beispiel:</p>
<pre><code>VAR(NAME &quot;Variable1&quot; VALUE &quot;Inhalt&quot;)             # im Hauptabschnitt am Anfang der Konfigurationsdatei.

Textfragmente(
   VAR(NAME &quot;Variable2&quot; VALUE &quot;Inhalt&quot;)          # innerhalb eines Textfragmente-Abschnitts.
   ...
)

VAR(NAME &quot;Variable3&quot; VALUE &quot;Inhalt&quot;)             # oder im Hauptabschnitt irgendwo anders in der Konfigurationsdatei.

Textfragmente(
   ...
   VAR(NAME &quot;Variable4&quot; VALUE &quot;noch ein Inhalt&quot;) # oder irgendwo in einem weiteren Textfragmente-Abschnitt
   ...
)

VAR(NAME &quot;Variable5&quot; VALUE &quot;noch ein Inhalt&quot;)    # oder im Hauptabschnitt am Ende der Konfigurationsdatei.
</code></pre><p>Kurzbeschreibung der Elemente:</p>
<ul>
<li>NAME: Mit dem Schl&#xFC;ssel &quot;NAME&quot; wird der Name der Variable festgelegt. Die Syntax f&#xFC;r den Namen folgt den &#xFC;blichen Regeln f&#xFC;r Bezeichner, d.h. erlaubte Zeichen sind Buchstaben, Ziffern und der Unterstrich, wobei das erste Zeichen keine Ziffer sein darf.\</li>
<li>VALUE: Mit dem Schl&#xFC;ssel &quot;VALUE&quot; wird der Variable ein Inhalt gegeben.</li>
</ul>
<p>Variablen k&#xF6;nnen an einer sp&#xE4;teren Stelle in der Konfigurationsdatei redefiniert werden. Prinzipiell hat immer die letzte Definition G&#xFC;ltigkeit.</p>
<p>Beispiel:</p>
<pre><code>VAR(NAME &quot;Foo&quot; VALUE &quot;Inhalt&quot;)       # Urspr&#xFC;ngliche Definition der Variable Foo

Irgendwelche_Abschnitte(
   ...
)

Irgendwelche_Abschnitte2(
   ...
)

VAR(NAME &quot;Foo&quot; VALUE &quot;neuer Inhalt&quot;) # Eine sp&#xE4;tere Redefinition &#xFC;berschreibt die alte Definition
</code></pre><p>Variablen k&#xF6;nnen in zwei verschiedenen Verschachtelungsebenen definiert werden: Im Hauptabschnitt der Konfigurationsdatei und in einem Textfragmente-Abschnitt. Eine Definition in einer h&#xF6;heren Ebene &#xFC;berschreibt eine Definition aus einer tieferen Ebene.</p>
<pre><code>VAR(NAME &quot;Foo&quot; VALUE &quot;Inhalt&quot;)          # Definition irgendwo im Hauptabschnitt der Konfigurationsdatei
                                        # (Verschachtelungsebene 0)

Textfragmente(
   VAR(NAME &quot;Foo&quot; VALUE &quot;neuer Inhalt&quot;) # Die Redefinition in einem Textfragmente-Abschnitt
                                        # (Verschachtelungsebene 1)
   ...
)
</code></pre><p>Variablen selbst k&#xF6;nnen auf andere Variablen verweisen (siehe <a href="Konfigurationsdatei_wollmux.conf#Variablen_referenzieren">Variablen referenzieren</a>).</p>
<p>Dazu ein kleines Beispiel:</p>
<p><code>VAR(NAME &quot;Variable_A&quot; VALUE &quot;Mein Inhalt A&quot;)</code></p>
<p><code>VAR(NAME &quot;Variable_B&quot; VALUE &quot;${Variable_A} und mein zus&#xE4;tzlicher Inhalt B&quot;)</code></p>
<h5 id="variablen-referenzieren">Variablen referenzieren</h5>
<p>Variablen werden innerhalb eines Wertes wie folgt referenziert:</p>
<p><code>${Variablenname}</code></p>
<p>Jede Variablen-Referenz beginnt mit einem &quot;$&quot;-Zeichen und ist zwingend in geschweifte Klammern einzuschlie&#xDF;en.</p>
<p>Folgendes Beispiel veranschaulicht die Verwendung von Variablen in URL-Werten:</p>
<pre><code>VAR(NAME &quot;Abteilungslaufwerk&quot; VALUE &quot;file:/L:/unsereVorlagen&quot;)

Textfragmente(
   (FRAG_ID &quot;fragment_a&quot; URL &quot;${Abteilungslaufwerk}/Fragment_a.odt&quot;)
   (FRAG_ID &quot;fragment_b&quot; URL &quot;${Abteilungslaufwerk}/Fragment_b.odt&quot;)
)
</code></pre><p>Da Variablen in verschiedenen Verschachtelungsebenen (Ebene 0 und Ebene 1) definiert werden k&#xF6;nnen, wird jeweils die n&#xE4;chste aus der Ebene der Referenz sichtbaren Variablen-Definition verwendet. Dazu ein Beispiel:</p>
<pre><code>VAR(NAME &quot;Variable A&quot; VALUE &quot;nieSichtbar&quot;)  # Erste Definition der &quot;Variable A&quot; (in Ebene 0)

Textfragmente(
  VAR(NAME &quot;Variable A&quot; VALUE &quot;bar&quot;)        # redefiniert &quot;Variable A&quot; in einer h&#xF6;heren Ebene 1
  (FRAG_ID &quot;frag1&quot; URL &quot;${Variable A}&quot;)     # URL --&gt; &quot;bar&quot;
)

Textfragmente(
  (FRAG_ID &quot;frag1&quot; URL &quot;${Variable A}&quot;)     # URL --&gt; &quot;foo&quot;
)

VAR(NAME &quot;Variable A&quot; VALUE &quot;foo&quot;)          # Letzte g&#xFC;ltige (Re)Definition von &quot;Variable A&quot; in Ebene 0
</code></pre><p>Die Variablenersetzung findet erst bei der Verwendung der Variable statt, nicht bereits zum Zeitpunkt der Variablendefinition.</p>
<h2 id="textbausteine">Textbausteine</h2>
<p>Das Textbausteinsystem erm&#xF6;glicht es, in einem aktuell bearbeiteten Dokument Textfragmente interaktiv nach zu laden. Jedes Textfragment kann wiederum weitere Textfragmente automatisch hinzuladen. Ein Textbaustein wird geladen, in dem im Dokument ein Textbausteinbezeichner und evtl. Argumente angegeben werden. Durch eine konfigurierbare Tastenkombination wird ein Ereignis ausgel&#xF6;st, welches den zuvor eingegebenen Textbausteinbezeichner (+Argumente) erkennt und das damit verkn&#xFC;pfte Textfragment l&#xE4;dt.</p>
<p>&#xDC;ber den Abschnitt &quot;Textbausteine&quot; kann das Textbausteinsystem konfiguriert werden. Es k&#xF6;nnen mehrere Abschnitte dieser Form in der Konfigurationsdatei wollmux.conf vorkommen, wobei die Festlegungen in sp&#xE4;teren Textbaustein-Abschnitten immer Vorrang haben vor Festlegungen, die in fr&#xFC;heren Textbaustein-Abschnitten getroffen wurden.</p>
<p>Hier ein Beispiel eines Textbausteine-Abschnittes:</p>
<pre><code>  Textbausteine(
    SEPARATOR &quot;#&quot;
    Warnungen(
      MSG_TOO_MANY_ARGS &quot;true&quot;  #oder on oder 1
    )
    Kuerzel(
     (MATCH(&lt;listeMitRegExStrings&gt;) FRAG_ID &apos;&lt;replacementString&gt;&apos;)
     (MATCH(&quot;NOST&quot;, &quot;NSOT&quot;) FRAG_ID &quot;TBS_nostalgie&quot;)
     (MATCH(&quot;UNT&quot;) FRAG_ID &quot;Unterschrift&quot;)
     (MATCH(&quot;IB&quot;) FRAG_ID &quot;internerBriefkopf&quot; )
     (MATCH &quot;(NOST)|(NSOT)&quot; FRAG_ID &quot;TBS_nostalgie2&quot;)
     (MATCH &quot;\$(.+)&quot; FRAG_ID &quot;$1&quot;)                                    # Eingabe $Test1 --&gt; FRAG_ID &quot;Test1&quot;
     (MATCH &quot;SF(\d{4})&quot; FRAG_ID &quot;SF$1&quot;)                               # Eingabe SF2400 --&gt; FRAG_ID &quot;SF2400&quot;
     (MATCH &quot;(BS\d+)&quot; FRAG_ID &quot;TBS_$1&quot;)                               # Eingabe BS10 --&gt; FRAG_ID &quot;TBS_BS10&quot;
     (MATCH (...) FRAG_ID &quot;TBS_$1&quot;)
   )
 )
</code></pre><h3 id="separator">SEPARATOR</h3>
<p>&#xDC;ber das optionale Attribut SEPARATOR kann ein Separator spezifiziert werden, der f&#xFC;r die Abgrenzung der einzelnen Parameter beim Einf&#xFC;gen von Textbausteinen verwendet wird. Die &#xFC;bergebenen Parameter werden automatisch in freie Platzhalter des eingef&#xFC;gten Textbausteins eingetragen. Ist kein SEPARATOR angegeben, so wird &quot;#&quot; als Standardeinstellung verwendet. Beispiel $BB0815#eins#zwei.</p>
<p>Soll ein Platzhalter beim Einf&#xFC;gen nicht ausgef&#xFC;llt werden, so ist der Bereich zwischen zwei Separatoren an dieser Stelle leer zu lassen (z.B. &quot;$BB0815#eins##drei&quot;). Der zweite Platzhalter w&#xFC;rde in diesem Fall nicht ausgef&#xFC;llt werden und unver&#xE4;ndert bleiben.</p>
<p>Soll ein Platzhalter beim Einf&#xFC;gen entfernt werden (also ohne Inhalt), so muss ein Leerzeichen zwischen den beiden Separatoren angegeben werden (z.B. $BB0815#eins# #drei). Der zweite Platzhalter w&#xFC;rde in diesem Fall gel&#xF6;scht werden.</p>
<h3 id="warnungen">Warnungen</h3>
<p>In diesem optionalen Abschnitt kann definiert werden, welche Warnungen des Textbausteinsystems dem Benutzer als Dialoge angezeigt werden sollen.</p>
<h4 id="msgtoomanyargs-">MSG_TOO_MANY_ARGS <argument></argument></h4>
<p>Mit dem Attribut MSG_TOO_MANY_ARGS kann die Fehlermeldung &quot;Es sind mehr Parameter als Einf&#xFC;gestellen vorhanden&quot; &#xFC;ber <em>true</em>, <em>on</em> oder <em>1</em> eingeschalten werden. Die Fehlermeldung erscheint dann, wenn mehr Parameter beim Aufruf eines Textbausteins &#xFC;bergeben wurde, als Platzhalter im eingef&#xFC;gten Textbaustein vorhanden sind. Ist das Attribut nicht angegeben oder enth&#xE4;lt es nicht true, on oder 1, so wird der Warndialog nicht angezeigt.</p>
<h3 id="kuerzel">Kuerzel</h3>
<p>Im Abschnitt Kuerzel kann definiert werden, welche Textbausteinbezeichner der WollMux erkennen soll. Hier findet eine Zuordnung von MATCH auf FRAG_ID statt, die beschreibt, welches Textfragment eingef&#xFC;gt werden soll, wenn ausgehend vom Cursor r&#xFC;ckw&#xE4;rts gesucht wird ein MATCH greift. Wird z.B in OOo-Writer $BB0815 eingegeben und mit einem Button/Tastenkombination <em>Textbaustein einf&#xFC;gen</em> gestartet, dann wird der eingegebene Textbausteinbezeichner mit dem Textbausteinbezeichner im MATCH verglichen. Falls er &#xFC;bereinstimmt wird die dazugeh&#xF6;rige FRAG_ID mit der FRAG_ID aus dem Abschnitt Textfragmente verkn&#xFC;pft. In Abschnitt Textfragmente wird die FRAG_ID dann in URLs aufgel&#xF6;st und der erste Textbaustein der aufgel&#xF6;st werden kann eingef&#xFC;gt.</p>
<h4 id="match-">MATCH(<listemitregexstrings> )</listemitregexstrings></h4>
<p>Syntax:</p>
<p><code>MATCH &quot;&lt;regex&gt;&quot;</code></p>
<p><code>MATCH (&quot;&lt;regex1&gt;&quot; &quot;&lt;regex2&gt;&quot; ...)</code></p>
<p>Mit MATCH wird der Textbausteinbezeichner festgelegt. &#xDC;ber <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html" target="_blank">Regul&#xE4;re Ausdr&#xFC;cke</a> k&#xF6;nnen mehrere Textbausteinbezeichner auf einmal behandelt werden.</p>
<h4 id="fragid-replacementstring">FRAG_ID &apos;&lt;replacementString&gt;&apos;</h4>
<p>Mit der FRAG_ID wird die <a href="#fragid-regex.3E.22">FRAG_ID</a> aus dem <a href="Konfigurationsdatei_wollmux.conf#Der_Abschnitt_Textfragmente">Abschnitt Textfragmente</a> verkn&#xFC;pft in der wiederum die <a href="#url-urldertextfragment-datei">URLs</a> aufgef&#xFC;hrt werden.</p>
<p>Wenn innerhalb des regul&#xE4;ren Ausdrucks von MATCH eine sog. <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html#cg" target="_blank">Capturing-Group</a> definiert wurde, dann kann diese Gruppe in der FRAG_ID mit der Notation &quot;$n&quot; referenziert werden, wobei n die Nummer der Gruppe ist. Die Gruppe $0 ist dabei standardm&#xE4;&#xDF;ig definiert und enth&#xE4;lt immer den Inhalt des vollst&#xE4;ndigen MATCH-Ausdrucks. So k&#xF6;nnen abh&#xE4;ngig von MATCH verschiedene FRAG_IDs angesprochen werden.</p>
<p>Beispiel:</p>
<pre><code>Textbausteine(
  Kuerzel(
    (MATCH &quot;Abt.*&quot; FRAG_ID &quot;$0&quot;)
  )
)
</code></pre><p>Dieser Ausdruck sorgt daf&#xFC;r, dass alle Strings, die mit &quot;Abt&quot; anfangen als Textbausteinbezeichner betrachtet werden. Um die entsprechenden Textbausteine aufzul&#xF6;sen, wird nach Textfragmenten mit gleichnamigen FRAG_IDs gesucht. Ein g&#xFC;ltiger Textbausteinbezeichner ist daher z.B. &quot;AbtKopf&quot;, f&#xFC;r den nach dem gleichnamigen Textfragment &quot;AbtKopf&quot; gesucht wird.</p>
<p>Achtung: Die dadurch entstehende FRAG_ID muss den <a href="Format_von_WollMux-Config-Dateien.html#schl&#xFC;ssel">Syntax-Regeln f&#xFC;r Schl&#xFC;ssel und Bezeichner</a> folgen. FRAG_IDs, die nicht diesen Kriterien entsprechen, werden nicht oder nicht zuverl&#xE4;ssig aufgel&#xF6;st.</p>
<h2 id="tastenkuerzel">Tastenkuerzel</h2>
<p>Der Abschnitt Tastenkuerzel erm&#xF6;glicht es eine Tastenkombination f&#xFC;r ein <a href="Schnittstellen_des_WollMux_fuer_Experten.html#die-dispatch-kommandos-des-wollmux">Dispatch Kommandos des WollMux</a> (z.B. wollmux:TextbausteinEinfuegen) festzulegen. Beim Starten des WollMux werden erst alle Tastenkombinationen die einem Dispatch Kommando des WollMux zugeordnet sind, gel&#xF6;scht und dann nach den Angaben im Abschnitt Tastenkuerzel neu gesetzt. Es k&#xF6;nnen mehrere Abschnitte dieser Form in der Konfigurationsdatei wollmux.conf vorkommen, wobei die Festlegungen in sp&#xE4;teren Tastenkuerzel-Abschnitten immer Vorrang haben vor Festlegungen, die in fr&#xFC;heren Tastenkuerzel-Abschnitten getroffen wurden. Es k&#xF6;nnen f&#xFC;r ein Dispatch Kommando des  WollMux mehrere Tastenkuerzel vergeben werden.</p>
<p>Beispiel eines Tastenkuerzel Abschnitts:</p>
<pre><code>Tastenkuerzel(
   (SHORTCUT &quot;&lt;Tastenkombination&gt;&quot; URL &quot;&lt;WollMux_Dispatch_Kommando&gt;&quot;)
   (SHORTCUT &quot;strg+t&quot; URL &quot;wollmux:TextbausteinEinfuegen&quot;)
)
</code></pre><h3 id="shortcut-tastenkombination">SHORTCUT &quot;&lt;Tastenkombination&gt;&quot;</h3>
<p>Eine &lt;Tastenkombination&gt; besteht aus den Namen der gleichzeitig zu dr&#xFC;ckenden Tasten, verbunden mit +. Gro&#xDF;<em> und Kleinschreibung wird nicht beachtet. Bisher vergebene Tastenkombinationen k&#xF6;nnen im OOo-Writer unter Extra &#x2192; Anpassen &#x2192; Reiter Tastatur nachgeschaut werden. Tastenkombinationen die in der Liste nicht aufgef&#xFC;hrt sind, k&#xF6;nnen trotzdem gesetzt werden, diese sind danach in der Liste nicht sichtbar (z.B. alt+umschalt+strg+t oder alt+\</em>).</p>
<p>Folgende Tasten k&#xF6;nnen verwendet werden:</p>
<ul>
<li>Jeweils eine Taste aus<ul>
<li>Ziffern von 0-9 oder</li>
<li>Buchstaben von a-z oder</li>
<li>Funktionstasten von F1-F12 oder</li>
<li>Sonderzeichen: Unten , Oben, Links, Rechts, Pos1, Ende, Bildauf, Bildab, Eingabe, Esc, Tabulator, R&#xFC;ckschritt oder Rueckschritt, Leertaste, Einfg, Entf, Plus,Minus mit &quot;-&quot;, Sternchen mit &quot;*&quot;,Schr&#xE4;gstrich mit &quot;/&quot;, Punkt mit &quot;.&quot;, Komma mit &quot;,&quot;, kleiner als mit &quot;&lt;&quot;, Gr&#xF6;&#xDF;er als mit &quot;&gt;&quot; und gleich mit &quot;=&quot;</li>
</ul>
</li>
<li>optional kombiniert mit einer oder mehreren der folgenden Tasten:<ul>
<li>alt, umschalt oder shift und strg oder ctrl</li>
</ul>
</li>
</ul>
<p>Beispiel:</p>
<p><code>SHORTCUT &quot;a+alt+umschalt&quot;</code></p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Bei Verwendung von Sonderzeichen, die nur durch Dr&#xFC;cken von Umschalt/Shift erreichbar sind (z.B. &quot;/&quot;) mu&#xDF; die Taste &quot;umschalt&quot; bzw. &quot;shift&quot; auch in der Tastenkombination angegeben werden.</p>
</blockquote>
<h3 id="url-dispatchkommando">URL &quot;&lt;Dispatch_Kommando&gt;&quot;</h3>
<p>Die URL beschreibt ein <a href="Schnittstellen_des_WollMux_fuer_Experten.html#die-dispatch-kommandos-des-wollmux">Dispatch Kommando des WollMux</a> z.B. wollmux:TextbausteinEinfuegen</p>
<h2 id="datenquellen">Datenquellen</h2>
<p>Der WollMux kann Informationen aus verschiedenen Datenquellen zusammenf&#xFC;hren und nutzen. Es ist zum Beispiel m&#xF6;glich, Name, Vorname, Orga-Einheit, Telefonnummer und B&#xFC;roanschrift aus einem LDAP-Verzeichnis lesen, die zur B&#xFC;roanschrift passende &#xD6;PNV-Verbindung aus einer Textdatei auf einem Netzlaufwerk erg&#xE4;nzen und mit diesen Informationen automatisch einen Briefkopf bef&#xFC;llen zu lassen.</p>
<h3 id="der-abschnitt-datenquellen">Der Abschnitt <em>Datenquellen</em></h3>
<p>Damit der WollMux eine Datenquelle benutzen kann, muss sie in der <em>wollmux.conf</em> definiert werden. Dies geschieht in <em>Datenquellen</em>-Abschnitten mit folgendem Aufbau:</p>
<pre><code>Datenquellen(

  Registriere(
    NAME &quot;&lt;Name_der_OOo_Datenquelle&gt;&quot;
    URL &quot;&lt;URL_der_odb_Datei&gt;&quot;
    REFRESH &quot;&lt;true_oder_false&gt;&quot;
  )

  ...

  Datenquelle(
    NAME &quot;&lt;Name_der_Datenquelle&gt;&quot;
    TYPE &quot;&lt;Typ&gt;&quot;

    &lt;Datenquellen_Definition&gt;
  )

  ...

)
</code></pre><p>Innerhalb eines <em>Datenquellen</em>-Abschnitts k&#xF6;nnen 2 verschiedene Arten von Unterabschnitten verwendet werden. <em>Registriere</em>-Abschnitte registrieren eine Datenquelle in LibreOffice (jedoch nicht im WollMux). <em>Datenquelle</em>-Abschnitte definieren eine Datenquelle f&#xFC;r die Verwendung durch den WollMux (nicht LibreOffice). Der Abschnitt <em>Datenquellen</em> darf innerhalb der Konfigurationsdatei mehrfach auftreten. In jedem <em>Datenquellen</em>-Abschnitt k&#xF6;nnen Datenquellen registriert/definiert werden. Der WollMux erkennt die Datenquellen, die in der Gesamtheit aller <em>Datenquellen</em>-Abschnitte definiert wurden.</p>
<h3 id="registriere">Registriere</h3>
<p>LibreOffice-Datenquellen haben verschiedene Aufgaben, insbesondere werden sie f&#xFC;r den Seriendruck verwendet. Damit eine Gruppe von Benutzern auf eine zentral gepflegte Datenbasis zugreifen kann ist eine Verteilung entsprechender Datenquellen erforderlich. Da zu jeder Datenbank eine .odb-Datei geh&#xF6;rt, die alle Parameter der Datenbank wie z.B. den Server speichert, ist die Verteilung im Prinzip sehr einfach. Es gen&#xFC;gt, die .odb Datei dem Benutzer zur Verf&#xFC;gung zu stellen. Leider ist es damit noch nicht ganz getan. Bevor eine .odb Datei verwendet werden kann, muss sie in LibreOffice registriert werden. <em>Registriere</em>-Abschnitte bieten eine einfache Methode, dies ohne manuelle Eingriffe an den betroffenen Rechnern zentral administriert durchzuf&#xFC;hren.</p>
<p>Jeder <em>Registriere</em>-Abschnitt kann folgende Attribute enthalten:</p>
<ul>
<li><p><strong>NAME</strong>: Gibt den Namen an, den die Datenquelle in LibreOffice haben soll. Man beachte, dass <em>nicht</em> automatisch eine WollMux-Datenquelle mit diesem Namen eingerichtet wird. Wird eine WollMux-Datenquelle ben&#xF6;tigt, so muss zus&#xE4;tzlich zum <em>Registriere</em>-Abschnitt ein <em>Datenquelle</em>-Abschnitt mit <a href="#type-ooo">TYPE &quot;ooo&quot;</a> angelegt werden.</p>
</li>
<li><p><strong>URL</strong>: Gibt die URL der .odb-Datei an. Relative URLs werden relativ zum <a href="#der-defaultcontext">DEFAULT_CONTEXT</a> aufgel&#xF6;st.</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> ODB-Datenbanken, die ihre Daten direkt in der ODB-Datei speichern, werden derzeit von OOo auf HTTP-Servern nicht richtig unterst&#xFC;tzt. Sie lassen sich zwar registrieren, jedoch sind keine Zugriffe auf die enthaltenen Tabellen m&#xF6;glich. Andere Orte (z.B. Netzlaufwerk) sollten jedoch funktionieren. Schreibrechte des Benutzers auf die Datei sind nicht erforderlich. Andere Datenbanktypen sind von diesem Problem nach derzeitigem Kenntnisstand nicht betroffen.</p>
</blockquote>
</li>
<li><p><strong>REFRESH (optional)</strong>: Ist bereits eine Datenquelle mit dem angegebenen Namen bei LibreOffice registriert, so wird diese Registrierung vom WollMux <em>nicht</em> &#xFC;berschrieben, au&#xDF;er das Attribut REFRESH ist vorhanden und auf &quot;true&quot; gesetzt.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Bei file-URLs wird die Datei bei der Registrierung bereits ge&#xF6;ffnet und falls dies fehlschl&#xE4;gt (z.B. weil die Datei nicht existiert) wird die Registrierung nicht durchgef&#xFC;hrt. Bei HTTP-URLs erfolgt kein derartiger Zugriff. Die Datenbank wird unabh&#xE4;ngig von der Existenz der Datei registriert. Ein Fehler tritt also erst bei einem versuchten Zugriff auf den Inhalt der Datenbank auf.</p>
</blockquote>
</li>
</ul>
<h3 id="datenquellen-referenzen">Datenquellen-Referenzen</h3>
<p>Manche Datenquellen-Typen greifen auf bestehende Datenquellen zur&#xFC;ck. In diesen F&#xE4;llen werden in der Datenquellen-Definition die entsprechenden Datenquellen durch ihren Namen referenziert. Anders als bei <a href="#variablen">Variablen</a> bezieht sich so eine Referenz <em>nicht</em> auf die letzte Datenquelle des entsprechenden Namens in der gesamten <em>wollmux.conf</em>, sondern auf die letzte, die <em>vor</em> der referenzierenden Datenquelle definiert wurde. Auf diese Weise ist es m&#xF6;glich, eine Datenquelle zu definieren, die eine Datenquelle des selben Namens referenziert. Das folgende Beispiel verdeutlicht dies:</p>
<pre><code>Datenquellen(

  # Definition von Datenquelle &quot;Foo&quot;
  Datenquelle(  
    NAME &quot;Foo&quot;
    TYPE &quot;&lt;Typ1&gt;&quot;
    ...
  )

  # Re-Definition von Datenquelle &quot;Foo&quot; unter Bezugnahme auf die oben definierte
  # Datenquelle des gleichen Namens vom Typ &lt;Typ1&gt;.
  Datenquelle(
    NAME &quot;Foo&quot;
    TYPE &quot;&lt;Typ2&gt;&quot;
    SOURCE &quot;Foo&quot;
    ...
  )
)
</code></pre><h3 id="sendersource">SENDER_SOURCE</h3>
<p>Der WollMux muss wissen, aus welcher Datenquelle er die Absenderdaten f&#xFC;r die Briefkopf-Erstellung beziehen soll. Zur Festlegung dieser Datenquelle dient die SENDER_SOURCE Direktive:</p>
<p><code>SENDER_SOURCE &quot;&lt;Name_der_Datenquelle&gt;&quot;</code></p>
<p>Die SENDER_SOURCE kann &#xFC;berall auf oberster Ebene der Konfigurationsdatei au&#xDF;erhalb aller Abschnitte definiert werden. Die SENDER_SOURCE kann an einer sp&#xE4;teren Stelle in der Konfigurationsdatei redefiniert werden. Die letzte Definition bestimmt die Datenquelle, die verwendet wird.</p>
<h3 id="datasourcetimeout">DATASOURCE_TIMEOUT</h3>
<p>Mit DATASOURCE_TIMEOUT kann ein Timeout f&#xFC;r die Suche in Datenquellen gesetzt werden (z.B. &#xFC;ber den Absenderdaten Bearbeiten Dialog). Sp&#xE4;testens nach der angegebenen Zeit wird die Suche abgebrochen, auch wenn keine Ergebnisse vorliegen. Dies verhindert z.B. dass das Programm bei Netzwerkproblemen sehr lange blockiert.</p>
<p><code>DATASOURCE_TIMEOUT &quot;&lt;Zeit in Millisekunden&gt;&quot;</code></p>
<p>Der DATASOURCE_TIMEOUT kann &#xFC;berall auf oberster Ebene der Konfigurationsdatei au&#xDF;erhalb aller Abschnitte definiert werden. Der DATASOURCE_TIMEOUT kann an einer sp&#xE4;teren Stelle in der Konfigurationsdatei redefiniert werden. Die letzte Definition bestimmt den Timeout, der verwendet wird.</p>
<h3 id="overridefragdbspalte">OVERRIDE_FRAG_DB_SPALTE</h3>
<p>Mit dieser Direktive kann der Name einer Spalte der SENDER_SOURCE bestimmt werden, aus deren Inhalt die <em>pers&#xF6;nliche overrideFrag-Liste</em> gelesen wird. Mit dieser wird die Abbildung von FRAG_IDs auf andere FRAG_IDs initialisiert, die auch durch das <a href="Dokumentkommandos_des_WollMux.html#das-kommando-overridefrag">Dokumentkommando &quot;overrideFrag&quot;</a> beeinflusst wird. Der Inhalt der angegebenen Spalte kann leer sein oder aus einem oder mehreren Eintr&#xE4;gen bestehen, die jeweils eine der beiden folgenden Formen haben</p>
<p><code>(FRAG_ID &apos;&lt;alte_fragment_id&gt;&apos; NEW_FRAG_ID &apos;&lt;neue_fragment_id&gt;&apos;)</code></p>
<p><code>(FRAG_ID &apos;&lt;fragment_id&gt;&apos;)</code></p>
<p>Zur Erl&#xE4;uterung der Funktionsweise siehe <a href="Dokumentkommandos_des_WollMux.html#das-kommando-overridefrag">Dokumentkommando &quot;overrideFrag&quot;</a>. Die Festlegungen in der pers&#xF6;nlichen overrideFrag-Liste haben Vorrang vor denen, die durch Dokumentkommandos gesetzt werden.</p>
<p>Die OVERRIDE_FRAG_DB_SPALTE kann &#xFC;berall auf oberster Ebene der Konfigurationsdatei au&#xDF;erhalb aller Abschnitte definiert werden. Die OVERRIDE_FRAG_DB_SPALTE kann an einer sp&#xE4;teren Stelle in der Konfigurationsdatei redefiniert werden. Nur die letzte Definition wird verwendet.</p>
<h3 id="der-abschnitt-absenderdatenspaltenumsetzung">Der Abschnitt <em>AbsenderdatenSpaltenumsetzung</em></h3>
<p>&#xDC;ber den Abschnitt <em>AbsenderdatenSpaltenumsetzung</em> lassen sich Transformationen der Absenderdaten realisieren. Er hat folgenden Aufbau</p>
<pre><code>AbsenderdatenSpaltenumsetzung(
  PseudoSpalte1( &lt;WollMux-Funktion1&gt; )
  PseudoSpalte2( &lt;WollMux-Funktion2&gt; )
  ...
)
</code></pre><ul>
<li><em>AbsenderdatenSpaltenumsetzung</em>-Abschnitte m&#xFC;ssen auf oberster Ebene in der wollmux.conf definiert werden, <em>nicht</em> innerhalb des <em>Datenquellen</em>-Abschnitts.</li>
<li>&#xDC;ber den Abschnitt werden Pseudo-Spalten definiert, die jedem Datensatz der <a href="#sendersource%22">SENDER_SOURCE</a> hinzugef&#xFC;gt werden.</li>
<li>Wird in der Definition einer Pseudo-Spalte die Grundfunktion <code>VALUE &quot;&lt;Spalte&gt;&quot;</code> verwendet, so bezieht sich &lt;Spalte&gt; <em>immer</em> auf eine echte Spalte des Datensatzes, <em>niemals</em> auf eine Pseudospalte. Insbesondere ist es also <em>nicht</em> m&#xF6;glich, Pseudo-Spalten unter Bezugnahme auf andere Pseudo-Spalten zu definieren.</li>
<li>Gibt es mehrere Definitionen f&#xFC;r die selbe Pseudo-Spalte, so gilt nur die letzte. Insbesondere ist es <em>nicht</em> m&#xF6;glich, eine Pseudo-Spalte XYZ unter Bezugnahme auf eine vorherige Definition von XYZ zu definieren. Siehe hierzu auch den vorigen Punkt.</li>
<li>Hat eine Pseudo-Spalte den selben Namen wie eine echte Spalte, so wird die echte Spalte verdeckt.</li>
<li>Alle Funktionsberechnungen finden auf den bereits vom Benutzer im <a href="#absenderdaten-bearbeiten">Absenderdaten Bearbeiten Dialog</a> angepassten Werten statt, unmittelbar bevor ein Spaltenwert z.B. beim Auswerten des <a href="Dokumentkommandos_des_WollMux.html#das-kommando-insertvalue">insertValue-Dokumentkommandos</a> verwendet wird. Eine evtl. auf das insertValue-Kommando gesetzte TRAFO wird erst danach ausgewertet, arbeitet also mit den durch <em>AbsenderdatenSpaltenumsetzung</em> ge&#xE4;nderten Werten.</li>
<li>Gibt es mehrere Abschnitte <em>AbsenderdatenSpaltenumsetzung</em>, so werden diese zu einem einzigen gro&#xDF;en Abschnitt verkettet.</li>
</ul>
<h3 id="unterst&#xFC;tzte-datenquellen-typen">Unterst&#xFC;tzte Datenquellen-Typen</h3>
<p>Die folgenden Abschnitte beschreiben die verschiedenen Arten von Datenquellen, die der WollMux unterst&#xFC;tzt und wie sie in der <em>wollmux.conf</em> definiert werden.</p>
<h4 id="type-ldap">TYPE &quot;ldap&quot;</h4>
<p>Eine Datenquelle des Typs &quot;ldap&quot; greift auf ein LDAP-Verzeichnis zu. Die Struktur der Definition einer LDAP-Datenquelle ist wie folgt:</p>
<pre><code> Datenquelle(
   NAME &quot;`&lt;Name_der_Datenquelle&gt;`&quot;
   TYPE &quot;ldap&quot;
   URL &quot;&lt;url&gt;&quot;
   USER &quot;&lt;user&gt;&quot;
   PASSWORD &quot;&lt;password&gt;&quot;
   BASE_DN &quot;&lt;dn&gt;&quot;
   OBJECT_CLASS &quot;&lt;Klasse&gt;&quot;
   Spalten(
     (DB_SPALTE &quot;&lt;Spaltenname1&gt;&quot; PATH &quot;&lt;Pfad1&gt;&quot;)
     (DB_SPALTE &quot;&lt;Spaltenname2&gt;&quot; PATH &quot;&lt;Pfad2&gt;&quot; OBJECT_CLASS &quot;&lt;Klasse&gt;&quot; LINE_SEPARATOR &quot;&lt;sep&gt;&quot;)
     ...
   )

   Schluessel( &quot;&lt;Name_von_Schluesselspalte1&gt;&quot;, &quot;&lt;Name_von_Schluesselspalte2&gt;&quot; ... )
 )
</code></pre><h5 id="url-url">URL &quot;&lt;url&gt;&quot;</h5>
<p>Die URL unter der der LDAP-Server zu finden ist, z.B.</p>
<p><code>ldap://ldap01.muenchen.de:389</code></p>
<h5 id="basedn-dn">BASE_DN &quot;&lt;dn&gt;&quot;</h5>
<p>Es ist oft sinnvoll oder sogar zwingend erforderlich, nur einen Teilbaum des LDAP-Verzeichnisses als Datenquelle anzusprechen. Der als BASE_DN &#xFC;bergebene Distinguished Name bestimmt den Teilbaum, aus dem die Datens&#xE4;tze der Datenquelle kommen d&#xFC;rfen, z.B.</p>
<p><code>BASE_DN &quot;o=Landeshauptstadt M&#xFC;nchen,c=de&quot;</code></p>
<h5 id="user-user">USER &quot;&lt;user&gt;&quot;</h5>
<p>Mit diesem User wird eine Verbindung zur Datenbank aufgebaut.</p>
<h5 id="password-password">PASSWORD &quot;&lt;password&gt;&quot;</h5>
<p>Das Passwort f&#xFC;r den User um die Verbindung aufzubauen.</p>
<h5 id="objectclass-klasse">OBJECT_CLASS &quot;&lt;Klasse&gt;&quot;</h5>
<p>Ein LDAP-Verzeichnis kann Objekte verschiedener Art enthalten, z.B. Personen und Ressourcen (Beamer,...). Meist soll eine Datenquelle nur Objekte einer bestimmten Klasse zug&#xE4;nglich machen. OBJECT_CLASS auf Ebene der Datenquelle schr&#xE4;nkt die von der Datenquelle als Datens&#xE4;tze betrachteten Objekte auf diejenigen ein, deren objectClass Attribut &quot;&lt;Klasse&gt;&quot; enth&#xE4;lt. Beispiel:</p>
<p><code>OBJECT_CLASS &quot;lhmPerson&quot;</code></p>
<h5 id="spalten-beschreibung">Spalten-Beschreibung</h5>
<p>Da ein LDAP-Verzeichnis eine Baumstruktur besitzt, Datenquellen jedoch immer eine Tabellenstruktur haben, muss in der Definition der Datenquelle festgelegt werden, wie die Baumstruktur des Verzeichnisses auf Tabellenspalten abzubilden ist. Diese Abbildung wird durch den Abschnitt <em>Spalten</em> festgelegt, der folgende Struktur hat.</p>
<pre><code>Spalten(
  (DB_SPALTE &quot;&lt;Spaltenname1&gt;&quot; PATH &quot;&lt;Pfad1&gt;&quot;)
  (DB_SPALTE &quot;&lt;Spaltenname2&gt;&quot; PATH &quot;&lt;Pfad2&gt;&quot;)
  ...
)
</code></pre><p>Es sind mehrere <em>Spalten</em>-Abschnitte erlaubt und auch mehrere Eintr&#xE4;ge mit dem selben Spaltennamen. In diesem Fall gilt immer die letzte Definition der Spalte. Eine Spaltendefinition besteht immer aus 2 Angaben.</p>
<h6 id="dbspalte-spaltenname">DB_SPALTE &quot;&lt;Spaltenname&gt;&quot;</h6>
<p>&lt;Spaltenname&gt; bestimmt den Namen einer Spalte, die die Datenquelle zur Verf&#xFC;gung stellen soll. Der Spaltenname muss der Konvention f&#xFC;r Bezeichner entsprechen, d.h. nur aus Ziffern, Buchstaben und Unterstrich bestehen und nicht mit einer Ziffer beginnen.</p>
<h6 id="path-pfad">PATH &quot;&lt;Pfad&gt;&quot;</h6>
<p>Meist soll die Datenquelle bestimmte Attribute der &#xFC;ber <a href="#objectclass-klasse">OBJECT_CLASS</a> ausgew&#xE4;hlten Objekte in den Spalten zur Verf&#xFC;gung stellen, manchmal jedoch sind die ben&#xF6;tigen Daten nicht direkt im entsprechenden Objekt zu finden, sondern in Vorfahren dieses Objekts. Zum Beispiel sind Daten &#xFC;ber das Referat eines Mitarbeiters meist nicht als Attribute des Mitarbeiter-Objektes verf&#xFC;gbar, sondern nur als Attribute des Vorfahren-Knotens, der das Referat repr&#xE4;sentiert. Um auch damit umgehen zu k&#xF6;nnen wird der Inhalt einer Spalte nicht nur durch einen Attributsnamen gegeben, sondern durch einen Pfad der folgenden Form</p>
<p><code>PATH &quot;&lt;Knoten&gt;:&lt;Attribut&gt;&quot;</code></p>
<p>Dabei bestimmt &lt;Attribut&gt; den Namen des Attributs das den Spaltenwert liefern soll. Es ist einfach der Name des Attributs wie er auch im LDAP selbst Anwendung findet. <knoten> dagegen ist eine ganze Zahl, die angibt von welchem Vorfahren des Objektknotens, der den Datensatz liefert, der Attributswert genommen werden soll. Folgende M&#xF6;glichkeiten gibt es, den Vorfahren festzulegen:</knoten></p>
<ul>
<li><strong>0</strong>: Die 0 bezeichnet den Objektknoten selbst.</li>
<li><strong>positive Zahl</strong>: Die positive Zahl n w&#xE4;hlt den Vorfahren des Objektknotens, der von der Wurzel des LDAP-Verzeichnisses den Abstand n-1 hat. D.h. die 1 bezeichnet immer die Wurzel des LDAP-Verzeichnisses (<em>nicht</em> den Base DN), die 2 bezeichnet das direkte Kind der Wurzel, das ein Vorfahre des Objektknotens ist, etc. Da der LDAP einen Baum darstellt, gibt es zu jedem Abstand von der Wurzel maximal einen Knoten, der Vorfahre des Objektknotens ist. Es ist m&#xF6;glich, dass es zu einem Objektknoten keinen Vorfahren der entsprechenden Ebene <em>n</em> gibt, n&#xE4;mlich dann, wenn der Knoten selbst von der Wurzel einen geringeren Abstand als <em>n</em> hat. In diesem Fall gilt f&#xFC;r den entsprechenden Datensatz der Wert der Spalte als unbelegt.</li>
<li><strong>negative Zahl</strong>: Die negative Zahl -n w&#xE4;hlt den n-ten Vorfahren des Objektknotens, z.B. bezeichnet -1 den unmittelbaren Vaterknoten, -2 den Gro&#xDF;vater, etc.</li>
</ul>
<h6 id="objectclass-klasse">OBJECT_CLASS &quot;&lt;Klasse&gt;&quot;</h6>
<p>Auf Ebene der Spalten dient die OBJECT_CLASS-Angabe der Optimierung bei Suchanfragen. Bei Angabe einer OBJECT_CLASS in einer Spaltenbeschreibung, werden bei Suchanfragen, die die Spalte betreffen nur LDAP-Knoten der entsprechenden Klasse betrachtet.</p>
<h6 id="lineseparator-sep">LINE_SEPARATOR &quot;&lt;sep&gt;&quot;</h6>
<p>Enth&#xE4;lt die Spalte mehrzeilige Daten, so kann als <sep> ein <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/util/regex/Pattern.html" target="_blank">regul&#xE4;rer Ausdruck</a> angegeben werden, der beschreibt, an welchen Stellen sich Zeilenumbr&#xFC;che befinden. Zu beachten ist, dass das &quot;%&quot; Zeichen als &quot;%%&quot; geschrieben werden muss (und ein doppeltes &quot;%&quot;-Zeichen als &quot;%%%%&quot;), entsprechend der <a href="Format_von_WollMux-Config-Dateien.html">Syntax von WollMux-Config-Dateien</a>.</sep></p>
<h5 id="schluessel-definition">Schluessel-Definition</h5>
<p>Der Abschnitt <em>Schluessel</em> enth&#xE4;lt eine Liste von einem oder mehreren Spaltennamen. Diese Spalten bilden in der Gesamtheit einen Schl&#xFC;ssel, der herangezogen wird, um Datens&#xE4;tze zu identifizieren. Dem Schl&#xFC;ssel kommt im Zusammenhang mit den Caching-Mechanismen des WollMux besondere Bedeutung zu. Um auch im Falle eines Netzausfalles den Betrieb sicherzustellen, werden bestimmte Daten, wie z.B. die der Pers&#xF6;nlichen Absenderliste, vom WollMux im Benutzerverzeichnis gecacht. Bei jedem Start versucht der WollMux, die Daten aus den Datenquellen zu aktualisieren. Um die neuen Daten zu finden, dienen ihm dabei die Schl&#xFC;ssel der Datens&#xE4;tze. Daraus ergeben sich folgende Anforderungen an einen guten Schl&#xFC;ssel:</p>
<ul>
<li><strong>Die gew&#xE4;hlten Schl&#xFC;sselspalten sollten jeden Datensatz eindeutig identifizieren</strong>: Falls es mehrere Datens&#xE4;tze mit dem selben Schl&#xFC;ssel gibt (falls z.B. in einer Personendatenbank als Schl&#xFC;ssel nur der Nachname verwendet wird), so wird der WollMux beim Aktualisieren seiner Daten alle passenden Datens&#xE4;tze importieren. Auf die Pers&#xF6;nliche Absenderliste bezogen, w&#xFC;rde dies bedeuten, dass der Anwender pl&#xF6;tzlich zus&#xE4;tzliche Eintr&#xE4;ge in seiner Liste hat, die er nicht haben m&#xF6;chte. Der Anwender k&#xF6;nnte diese Eintr&#xE4;ge zwar aus seiner Liste l&#xF6;schen, sie w&#xFC;rden jedoch mit jedem Neustart des WollMux wieder importiert, solange mindestens ein Eintrag mit dem gleichen Schl&#xFC;ssel in der Liste verbleibt.</li>
<li><strong>Die gew&#xE4;hlten Schl&#xFC;sselspalten sollten keine h&#xE4;ufig ge&#xE4;nderten Werte enthalten</strong>: Falls sich zu einem Datensatz der Wert in einer Schl&#xFC;sselspalte (und damit der Schl&#xFC;ssel) &#xE4;ndert, so kann der WollMux den Datensatz nicht mehr aus der Datenquelle aktualisieren. Bezogen auf die Pers&#xF6;nliche Absenderliste bedeutet dies, dass ein Eintrag dessen Datensatz seinen Schl&#xFC;ssel ge&#xE4;ndert hat, auf dem letzten Stand vor der &#xC4;nderung verbleibt. Eine &#xC4;nderung der Raumnummer im LDAP-Verzeichnis f&#xFC;r die entsprechende Person w&#xFC;rde dann z.B. nicht automatisch &#xFC;bernommen.</li>
<li><strong>Schl&#xFC;sselwerte sollten nicht zu verschiedenen Zeiten auf verschiedene Objekte passen</strong>: Noch ung&#xFC;nstiger als der Fall, dass auf einen Schl&#xFC;ssel mehrere Objekte passen. Das ist der Fall, wenn ein Schl&#xFC;ssel einmal auf Objekt A und zu einem anderen Zeitpunkt auf Objekt B passt, das mit Objekt A nichts zu tun hat. Typischerweise w&#xFC;rde dies so geschehen, dass Objekt A aus der Datenbank entfernt und zu einem sp&#xE4;teren Zeitpunkt Objekt B hinzugef&#xFC;gt wird, und dabei den fr&#xFC;her von Objekt A benutzten Schl&#xFC;ssel bekommt. In diesem Fall w&#xFC;rde der WollMux die gecachten Daten von Objekt A mit denen von Objekt B &#xFC;berschreiben. Bezogen auf die Pers&#xF6;nliche Absenderliste w&#xFC;rde zum Beispiel Wahl der Zimmernummer als einzige Schl&#xFC;sselspalte zu dem Effekt f&#xFC;hren, dass nach einem Umzug in ein anderes B&#xFC;ro die Liste Eintr&#xE4;ge f&#xFC;r die falschen Personen enth&#xE4;lt.</li>
</ul>
<h4 id="type-ooo">TYPE &quot;ooo&quot;</h4>
<p>Eine Datenquelle des Typs &quot;ooo&quot; macht eine beliebige in LibreOffice registrierte Datenquelle als WollMux-Datenquelle verf&#xFC;gbar. Dies erm&#xF6;glicht zum Beispiel auch, den WollMux auf Oracle-Datenbanken zugreifen zu lassen. Die Definition einer OOo-Datenquelle hat folgenden Aufbau:</p>
<pre><code>Datenquelle(
  NAME &quot;&lt;Name_der_WollMux_Datenquelle&gt;&quot;
  TYPE &quot;ooo&quot;
  SOURCE &quot;`&lt;Name_der_in_OOo_registrierten_Datenquelle&gt;&quot;
  TABLE &quot;&lt;Name_der_Tabelle_oder_Sicht&gt;&quot;
  USER &quot;&lt;Benutzername&gt;&quot;
  PASSWORD &quot;&lt;Passwort&gt;&quot;
  SQL_SYNTAX &quot;&lt;Syntaxbezeichner&gt;&quot;
  Schema( &quot;&lt;Name_von_Spalte1&gt;&quot; &quot;&lt;Name_von_Spalte2&gt;&quot; ... )
  Schluessel( &quot;&lt;Name_von_Schluesselspalte1&gt;&quot;, &quot;&lt;Name_von_Schluesselspalte2&gt;&quot; ... )
  # Wenn ein Schema()-Abschnitt angegeben ist, muss auch ein Schluessel-Abschnitt angegeben werden.
)
</code></pre><h5 id="source-datenquellenname">SOURCE &quot;&lt;Datenquellenname&gt;&quot;</h5>
<p>Mit SOURCE wird der Name der bei LibreOffice registrierten Datenquelle angegeben, auf die zugegriffen werden soll.</p>
<h5 id="table-tabelleodersicht">TABLE &quot;&lt;TabelleOderSicht&gt;&quot;</h5>
<p>Mit TABLE wird der Name der Tabelle oder Sicht innerhalb der Datenquelle angegeben.</p>
<h5 id="user-benutzername-und-password-passwort">USER &quot;&lt;Benutzername&gt;&quot; und PASSWORD &quot;&lt;Passwort&gt;&quot;</h5>
<p>Falls die Datenbank einen Login erfordert, werden mit diesen Feldern der entsprechende Benutzername und das zugeh&#xF6;rige Passwort festgelegt. Da die Zugangsdaten von jedem Benutzer, der auf die WollMux-Konfiguration zugreifen kann, eingesehen werden k&#xF6;nnen, versteht es sich von selbst, dass hier keine geheimen Daten verwendet werden d&#xFC;rfen und der entsprechende Benutzeraccount nur Leserechte auf die Datenbank haben darf.</p>
<h5 id="sqlsyntax-syntaxbezeichner">SQL_SYNTAX &quot;&lt;Syntaxbezeichner&gt;&quot;</h5>
<p>Verschiedenen Datenbanken arbeiten mit verschiedenen SQL-Dialekten. Mit dieser Angabe kann ausgew&#xE4;hlt werden, in welchem Dialekt der WollMux seinen Anfragen stellen soll. Als &lt;Syntaxbezeichner&gt; werden unterst&#xFC;tzt:</p>
<p><em>ansi</em>, <em>oracle</em>, <em>mysql</em>, <em>pervasivesql</em></p>
<p>Die Angabe SQL_SYNTAX ist optional. Wird sie weggelassen, so wird <em>ansi</em> angenommen.</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Bei der Verwendung von Calc-Dateien als Datenquelle muss
als Syntax <em>pervasivesql</em> angegeben werden.</p>
</blockquote>
<h5 id="schema-angabe">Schema-Angabe</h5>
<p>Im Schema-Abschnitt werden die Namen aller Spalten der Tabelle angegeben, auf die der Zugriff erm&#xF6;glicht werden soll. Werden hier Spalten angegeben, die nicht in der Tabelle vorhanden sind, so werden diese als nicht belegt angenommen. Werden hier Spalten nicht angegeben, die jedoch in der Tabelle vorhanden sind, so ist der Zugriff auf diese Spalten nicht m&#xF6;glich. Der Schema-Abschnitt kann weggelassen werden. In diesem Fall bezieht der WollMux das Schema direkt aus der Datenbank. Hiervon ist jedoch abzuraten, da diese Datenbankzugriffe bei jedem Start von LibreOffice Verz&#xF6;gerungen verursachen. Insbesondere im Falle eines Netzausfalls m&#xFC;ssten die Benutzer unn&#xF6;tig lange warten bis LibreOffice startet, da erst der Timeout f&#xFC;r den Datenbankzugriff ablaufen muss.</p>
<h5 id="schluessel-definition">Schluessel-Definition</h5>
<p>Der <em>Schluessel</em>-Abschnitt ist vollkommen analog zum <a href="#schluessel-definition">Schluessel-Abschnitt bei LDAP-Datenquellen</a>.</p>
<p>Wird der Schema-Abschnitt weggelassen (was jedoch nicht empfehlenswert ist), so wird versucht, den Schl&#xFC;ssel ebenfalls aus der Datenbank auszulesen. Es h&#xE4;ngt von der Datenbank und der Art der Tabelle ab, ob dies funktioniert oder nicht und sollte daher vermieden werden.</p>
<h4 id="type-conf">TYPE &quot;conf&quot;</h4>
<p>Eine Datenquelle des Typs &quot;conf&quot; bezieht ihre Daten aus einer Textdatei im <a href="Format_von_WollMux-Config-Dateien.html">Format von WollMux-Config-Dateien</a>. Die genaue Struktur des Inhalts wird weiter unten beschrieben. Die Definition einer Conf-Datenquelle hat folgenden Aufbau:</p>
<pre><code> Datenquelle(
   NAME &quot;&lt;Name_der_Datenquelle&gt;&quot;
   TYPE &quot;conf&quot;
   URL &quot;&lt;url&gt;&quot;
   Schluessel( &quot;&lt;Name_von_Schluesselspalte1&gt;&quot;, &quot;&lt;Name_von_Schluesselspalte2&gt;&quot; ... )
 )
</code></pre><h5 id="schluessel-definition">Schluessel-Definition</h5>
<p>Der <em>Schluessel</em>-Abschnitt ist vollkommen analog zum <a href="Konfigurationsdatei_wollmux.conf#Schluessel-Definition">Schluessel-Abschnitt bei LDAP-Datenquellen</a>.</p>
<h5 id="url-url">URL &quot;&lt;url&gt;&quot;</h5>
<p>Die &lt;url&gt; gibt die Datei an, in der die Daten der Datenquelle stehen. Sie ist in <a href="Format_von_WollMux-Config-Dateien.html#urls">URL-Notation</a>. Relative URLs werden relativ zum <a href="#der_defaultcontext">DEFAULT_CONTEXT</a> interpretiert. Der Aufbau der Datendatei wird im folgenden Abschnitt beschrieben.</p>
<h5 id="aufbau-der-datendatei">Aufbau der Datendatei</h5>
<p>Zu jeder Conf-Datenquelle geh&#xF6;rt eine Datendatei. Die Syntax dieser Datei entspricht der <a href="Format_von_WollMux-Config-Dateien.html">Syntax der wollmux.conf</a> und ihre Struktur ist folgende:</p>
<pre><code>Schema(
  &quot;&lt;Spaltenname1&gt;&quot;, &quot;&lt;Spaltenname2&gt;&quot; ...
)

Daten(
  (&lt;Datensatz1&gt;)
  (&lt;Datensatz2&gt;)
  ...
)
</code></pre><p>Die Abschnitte <em>Schema</em> und <em>Daten</em> sind im Folgenden beschrieben.</p>
<h6 id="schema">Schema</h6>
<p>Der <em>Schema</em>-Abschnitt enth&#xE4;lt eine Liste von Spaltennamen. Diese Liste bestimmt, welche Spalten die Tabelle enth&#xE4;lt. Bei geordneten Datens&#xE4;tzen (siehe unten) bestimmt die Liste ausserdem die Zuordnung der Werte des Datensatzes zu den entsprechenden Spalten. Die Namen der Spalten m&#xFC;ssen der Konvention f&#xFC;r Bezeichner entsprechen, d.h. nur aus Ziffern, Buchstaben und Unterstrich bestehen und nicht mit einer Ziffer beginnen.</p>
<h6 id="daten">Daten</h6>
<p>Der <em>Daten</em>-Abschnitt enth&#xE4;lt die eigentlichen Datens&#xE4;tze. Ein leerer <em>Daten</em>-Abschnitt ist erlaubt. Jeder Datensatz kann in einem von 2 Formaten beschrieben sein: <em>geordnet</em> oder <em>ungeordnet</em>.</p>
<p>Ein <em>geordneter Datensatz</em> hat folgendes Format:</p>
<p><code>(&quot;&lt;Spaltenwert1&gt;&quot;, &quot;&lt;Spaltenwert2&gt;&quot; ...)</code></p>
<p>Die Werte werden den Spalten in der Reihenfolge zugeordnet, in der sie im <em>Schema</em>-Abschnitt aufgef&#xFC;hrt sind. Es ist erlaubt, weniger Spaltenwerte anzugeben als es Spalten gibt. Die fehlenden Spaltenwerte bleiben f&#xFC;r den Datensatz unbelegt. Mehr Spaltenwerte anzugeben als das Schema Spalten definiert, ist hingegen ein Fehler.</p>
<p>Ein <em>ungeordneter Datensatz</em> hat folgendes Format:</p>
<p><code>(Spaltenname1 &quot;&lt;Spaltenwert1&gt;&quot;  Spaltenname2 &quot;&lt;Spaltenwert2&gt;&quot; ...)</code></p>
<p>Bei dieser Form werden also die Daten als Schl&#xFC;ssel-Wert-Paare mit dem Spaltennamen als Schl&#xFC;ssel und dem Spaltenwert als Wert angegeben. Die Reihenfolge ist bei dieser Form unwichtig. Die ungeordnete Form hat ausserdem den Vorteil, dass es m&#xF6;glich ist, beliebige Spaltenwerte unbelegt zu lassen, wogegen die geordnete Form prinzipbedingt nur das Weglassen von Spalten am Ende des Schemas erlaubt.</p>
<h4 id="type-union">TYPE &quot;union&quot;</h4>
<p>Eine Datenquelle des Typs &quot;union&quot; stellt die Vereinigung der Menge aller Datens&#xE4;tze aus 2 Datenquellen zur Verf&#xFC;gung. Sie wird wie folgt definiert</p>
<pre><code>Datenquelle(
  NAME &quot;&lt;Name_der_Datenquelle&gt;&quot;
  TYPE &quot;union&quot;
  SOURCE1 &quot;&lt;Name_Datenquelle1&gt;&quot;
  SOURCE2 &quot;&lt;Name_Datenquelle2&gt;&quot;
)
</code></pre><p>SOURCE1 und SOURCE2 geben die Datenquellen an, die vereinigt werden sollen.</p>
<p>Anmerkungen:</p>
<ul>
<li>Wenn in SOURCE1 und SOURCE2 Datens&#xE4;tze mit dem selben Schl&#xFC;sselwert sind, so kann dies unerw&#xFC;nschte Folgen haben. Im Briefkopfsystem zum Beispiel w&#xFC;rde das Hinzuf&#xFC;gen eines der Datens&#xE4;tze zur pers&#xF6;nlichen Absenderliste beim n&#xE4;chsten Neustart dazu f&#xFC;hren, dass alle Datens&#xE4;tze aus beiden Datenquellen mit dem entsprechenden Schl&#xFC;ssel auf der Absenderliste sind.</li>
<li>Die Schemata beider Datenquellen m&#xFC;ssen identisch sein.</li>
</ul>
<h4 id="type-prefer">TYPE &quot;prefer&quot;</h4>
<p>Eine Datenquelle des Typs &quot;prefer&quot; erlaubt es, Datens&#xE4;tze einer Datenquelle A durch Datens&#xE4;tze einer anderen (bevorzugten) Datenquelle B verdecken zu lassen. Technisch sieht das so aus: Es werden Anfragen an beide Datenquellen gestellt und die Ergebnisse vereinigt. Dann werden alle Ergebnisdatens&#xE4;tze aus Datenquelle A, die auch in Datenquelle B vorhanden sind, aus der Ergebnismenge entfernt. Die Identifikation der Datens&#xE4;tze l&#xE4;uft dabei &#xFC;ber die Schl&#xFC;sselwerte. Der typische Anwendungsfall einer &quot;prefer&quot;-Datenquelle ist, einzelne fehlerhafte Datens&#xE4;tze anhand einer Korrekturdatei durch korrekte zu ersetzen. Eine &quot;prefer&quot;-Datenquelle wird wie folgt definiert</p>
<pre><code>Datenquelle(
  NAME &quot;&lt;Name_der_Datenquelle&gt;&quot;
  TYPE &quot;prefer&quot;
  SOURCE &quot;&lt;Name_Datenquelle1&gt;&quot;
  OVER &quot;&lt;Name_Datenquelle2&gt;&quot;
)
</code></pre><p>SOURCE gibt die bevorzugte Datenquelle an und OVER die Datenquelle, die die Anfragen beantworten soll. Die Schemata beider Datenquellen m&#xFC;ssen identisch sein.</p>
<h4 id="type-schema">TYPE &quot;schema&quot;</h4>
<p>Eine Datenquelle des Typs &quot;schema&quot; stellt die Datens&#xE4;tze einer anderen Datenquelle mit ge&#xE4;ndertem Schema zur Verf&#xFC;gung. Sie erlaubt es, Spalten umzubenennen, hinzuzuf&#xFC;gen und zu entfernen. Sie wird wie folgt definiert</p>
<pre><code>Datenquelle(
  NAME &quot;&lt;Name_der_Datenquelle&gt;&quot;
  TYPE &quot;schema&quot;
  SOURCE &quot;&lt;Name_der_Originaldatenquelle&gt;&quot;
  RENAME(&quot;&lt;Urspr&#xFC;nglicherSpaltenname1&gt;&quot; &quot;&lt;NeuerSpaltenname1&gt;&quot;)
  RENAME(&quot;&lt;Urspr&#xFC;nglicherSpaltenname2&gt;&quot; &quot;&lt;NeuerSpaltenname2&gt;&quot;)
  ...
  DROP(&quot;&lt;Urspr&#xFC;nglicherSpaltenname3&gt;&quot; ...)
  ...
  ADD(&quot;&lt;NeuerSpaltenname3&gt;&quot; ...)
  ...
)
</code></pre><p>Die RENAMEs spezifizieren Umbenennungen von Spalten. In jedem RENAME-Block steht ein paar aus einem alten und dem neuen Spaltennamen.</p>
<p>Die DROP-Abschnitte enthalten Namen von Spalten, die in der neuen Datenquelle nicht mehr verf&#xFC;gbar sein sollen.</p>
<p>Die ADD-Abschnitte f&#xFC;gen dem Schema neue Spalten hinzu.</p>
<p>Anmerkungen:</p>
<ul>
<li>Wird eine Spalte &quot;A&quot; umbenannt in &quot;B&quot;, so ist eine evtl. vorher existierende Spalte &quot;B&quot; damit unerreichbar geworden (sofern sie nicht ebenfalls umbenannt wird).</li>
<li>Die Schl&#xFC;ssel der Datens&#xE4;tze &#xE4;ndern sich auch bei Umbenennung von Schl&#xFC;sselspalten nicht.</li>
<li>Gibt es mehrere RENAMEs mit dem selben &lt;NeuerSpaltennameX&gt;, so gilt der letzte RENAME.</li>
<li>Gibt es mehrere RENAMEs mit dem selben &lt;Urspr&#xFC;nglicherSpaltennameX&gt;, so haben alle Bestand und es entstehen mehrere Alias-Namen f&#xFC;r die selbe Spalte.</li>
<li><p>&lt;Urspr&#xFC;nglicherSpaltennameX&gt; bezieht sich immer auf die Originalspalten. Vorhergehende RENAMEs haben darauf keinen Einfluss. Deshalb ist es m&#xF6;glich 2 Spalten wie folgt zu vertauschen:</p>
<p><code>RENAME(&quot;A&quot; &quot;B&quot;)</code></p>
<p><code>RENAME(&quot;B&quot; &quot;A&quot;)</code></p>
</li>
<li><p>Die Spaltennamen in DROP-Abschnitten beziehen sich immer auf die SOURCE-Datenquelle, nicht auf durch RENAME definierte neue Namen.</p>
</li>
<li>Unabh&#xE4;ngig von der Reihenfolge in der RENAME und DROP in der Config-Datei stehen, hat RENAME immer Vorrang vor DROP, d.h. spezifiziert ein RENAME als &lt;NeuerSpaltennameX&gt; einen Namen, der auch in einem DROP-Abschnitt vorkommt, so wird die neue Datenquelle die Spalte &lt;NeuerSpaltennameX&gt; anbieten, trotz des DROPs.</li>
<li>Falls eine Spalte, die in einem ADD-Abschnitt angegeben wird, bereits in der Datenquelle existiert oder durch RENAME hinzugef&#xFC;gt wird, so hat das ADD keine Auswirkungen.</li>
<li>Falls eine Spalte, die in einem ADD-Abschnitt angegeben wird auch als <ursprünglicherspaltennamex> in einem RENAME auftaucht, so ist das Ergebnis, dass beide Spaltennamen Aliase f&#xFC;r die selbe Spalte sind. Insbesondere f&#xFC;gt ADD in diesem Fall keine unbelegte Spalte hinzu.</ursprünglicherspaltennamex></li>
<li>ADD hat Vorrang vor DROP, d.h. spezifiziert ein ADD als &lt;NeuerSpaltennameX&gt; einen Namen, der auch in einem DROP-Abschnitt vorkommt, so wird die neue Datenquelle die Spalte &lt;NeuerSpaltennameX&gt; anbieten, trotz des DROPs.</li>
</ul>
<h4 id="type-funky">TYPE &quot;funky&quot;</h4>
<p>Eine Datenquelle des Typs &quot;funky&quot; f&#xFC;gt einer anderen Datenquelle Spalten hinzu, deren Werte durch beliebige <a href="#funktionen">WollMux-Funktionen</a> aus den Ursprungsdaten berechnet werden. Sie wird wie folgt definiert</p>
<pre><code>Datenquelle(
  NAME &quot;&lt;Name_der_Datenquelle&gt;&quot;
  TYPE &quot;funky&quot;
  SOURCE &quot;&lt;Name_der_Originaldatenquelle&gt;&quot;

  Spaltenumsetzung(
    NeueSpalte1( &lt;WollMux-Funktion1&gt; )
    NeueSpalte2( &lt;WollMux-Funktion2&gt; )
    ...
  )
)
</code></pre><p>Mit SOURCE wird die Datenquelle angegeben, die die Originaldaten zur Verf&#xFC;gung stellt.</p>
<p>NeueSpalteX ist jeweils der Name der zu definierenden Spalte und WollMux-FunktionX die WollMux-Funktion, mit der der Wert der Spalte berechnet wird.</p>
<p>Das Schema der funky-Datenquelle enth&#xE4;lt alle Spalten der Originaldatenquelle und zus&#xE4;tzlich die als NeueSpalteX definierten.</p>
<p>Die Schl&#xFC;ssel der Datens&#xE4;tze sind die selben wie in der Originaldatenquelle.</p>
<p>Anmerkungen:</p>
<ul>
<li>Wird in der Definition einer NeueSpalteX die Grundfunktion <code>VALUE &quot;&lt;Spalte&gt;&quot;</code> verwendet, so bezieht sich <spalte> <em>immer</em> auf eine Spalte der Originaldaten, <em>niemals</em> auf eine NeueSpalteX. Insbesondere ist es also <em>nicht</em> m&#xF6;glich, neue Spalten unter Bezugnahme auf andere neue Spalten zu definieren.</spalte></li>
<li>Gibt es mehrere Definitionen f&#xFC;r die selbe NeueSpalteX, so gilt nur die letzte. Insbesondere ist es <em>nicht</em> m&#xF6;glich, eine NeueSpalteX unter Bezugnahme auf eine vorherige Definition von NeueSpalteX zu definieren. Siehe hierzu auch den vorigen Punkt.</li>
<li>Hat eine NeueSpalteX den selben Namen wie eine SpalteX der Originaldaten, so wird die Original-Spalte verdeckt. <code>VALUE &quot;SpalteX&quot;</code> bezieht sich jedoch innerhalb der Definition der funky-Datenquelle weiterhin auf die Original-Spalte (siehe vorherige Punkte). Die Schl&#xFC;ssel der Datens&#xE4;tze bleiben jedoch auch dann unver&#xE4;ndert, wenn Schl&#xFC;sselspalten der Originaldatenquelle verdeckt werden.</li>
</ul>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Die funky-Datenquelle hat nur unvollst&#xE4;ndige Unterst&#xFC;tzung f&#xFC;r Suchanfragen auf transformierten Spalten. Wenn sie die inverse Transformation nicht berechnen kann, reicht sie die Suchanfrage einfach unver&#xE4;ndert an die Originaldatenquelle weiter. Die bei einer Suche gelieferten Ergebnisse werden jedoch um die entsprechenden berechneten Spalten erg&#xE4;nzt. Wird aufgrund von Namensgleichheit eine SpalteX durch eine NeueSpalteX verdeckt, kann dies zu Diskrepanzen f&#xFC;hren, wenn eine Suche sich auf SpalteX bezieht. Beispiel:</p>
</blockquote>
<pre><code>Datenquelle(
  NAME &quot;personal&quot;
  TYPE &quot;funky&quot;
  SOURCE &quot;personal&quot;

  Spaltenumsetzung(
    Nachname( &quot;Anonymus&quot; )
  )
)
</code></pre><p>Wird auf dieser Datenquelle &quot;personal&quot; nach Personen mit Nachname &quot;Maier&quot; gesucht, und enth&#xE4;lt die Originaldatenquelle einen &quot;Hans Maier&quot; und einen &quot;Peter Maier&quot;, so werden als Ergebnisse &quot;Hans Anonymus&quot; und &quot;Peter Anonymus&quot; zur&#xFC;ckgeliefert. Wird dagegen auf dieser Datenquelle nach Personen mit Nachname &quot;Anonymus&quot; gesucht, so gibt es keine Ergebnisse (au&#xDF;er die Originaldatenquelle enth&#xE4;lt tats&#xE4;chlich eine Person dieses Namens).</p>
<p>Da dieses Verhalten normalerweise unintuitiv und unerw&#xFC;nscht ist, sollte eine funky-Datenquelle nie dazu verwendet werden, Spalten umzudefinieren, die potentiell in Suchanfragen vorkommen.</p>
<h4 id="type-attach">TYPE &quot;attach&quot;</h4>
<p>Eine Datenquelle des Typs &quot;attach&quot; wird verwendet, um Datens&#xE4;tze aus einer Datenquelle um Spalten aus einer anderen Datenquelle zu erg&#xE4;nzen. Eine &quot;attach&quot; Datenquelle ist sehr &#xE4;hnlich zu einer &quot;overlay&quot; Datenquelle. Im Einzelfall muss gepr&#xFC;ft werden, welcher Type f&#xFC;r das entsprechende Problem besser passt. Eine &quot;attach&quot; Datenquelle wird wie folgt definiert:</p>
<pre><code>Datenquelle(
  NAME &quot;&lt;Name_der_Datenquelle&gt;&quot;
  TYPE &quot;attach&quot;
  SOURCE &quot;&lt;Name_Datenquelle1&gt;&quot;
  ATTACH &quot;&lt;Name_Datenquelle2&gt;&quot;
  MATCH(&quot;&lt;Spalte_aus_Datenquelle1&gt;&quot; &quot;&lt;Spalte_aus_Datenquelle2&gt;&quot;)
  MATCH(&quot;&lt;Spalte_aus_Datenquelle1&gt;&quot; &quot;&lt;Spalte_aus_Datenquelle2&gt;&quot;)
  ...
)
</code></pre><p>SOURCE gibt die Datenquelle an, die die Datens&#xE4;tze bestimmen soll, ATTACH die Datenquelle, die die Erg&#xE4;nzungsspalten liefern soll. Die MATCH-Bl&#xF6;cke enthalten jeweils einen Namen einer Spalte in Datenquelle SOURCE und einen Namen einer Spalte in Datenquelle ATTACH. F&#xFC;r jeden Datensatz aus SOURCE wird gesucht, ob es in Datenquelle ATTACH einen Datensatz gibt, bei dem die Werte in den Spalten &lt;Spalte_aus_Datenquelle2&gt; mit den Werten aus den Spalten &lt;Spalte_aus_Datenquelle1&gt; des SOURCE-Datensatzes &#xFC;bereinstimmen. Falls ja, so werden die Spalten des ATTACH-Datensatzes benutzt um den SOURCE-Datensatz zu erg&#xE4;nzen.</p>
<p>Anmerkungen:</p>
<ul>
<li>In der Ergebnisdatenquelle sind alle Spalten von SOURCE unter ihrem urspr&#xFC;nglichen Namen, alle Spalten von ATTACH unter <code>&quot;&lt;Name_Datenquelle2&gt;&quot;</code> konkateniert mit &quot;__&quot; (Doppel-Unterstrich) konkateniert mit dem urspr&#xFC;nglichen ATTACH-Spaltennamen zu finden. Falls ein so generierter Name mit einem Spaltennamen aus SOURCE kollidiert gibt dies einen Fehler. Dies erfordert einen weiteren Datenquellen-Typ vom type schema um diese Ungleichheit aufzul&#xF6;sen.</li>
<li>Falls es zu einem SOURCE-Datensatz keinen passenden ATTACH-Datensatz gibt, so werden f&#xFC;r diesen Datensatz die &quot;<name_datenquelle2>__&quot;-Spalten als unbelegt behandelt. Insbesondere f&#xFC;hrt diese also nicht dazu, dass ein SOURCE-Datensatz verschwindet (wie es bei einem normalen Datenbank-Join der Fall w&#xE4;re).</name_datenquelle2></li>
<li>Falls es zu einem SOURCE-Datensatz mehrere ATTACH-Datens&#xE4;tze gibt, so wird einer davon (auf unspezifizierte Weise) ausgew&#xE4;hlt. Insbesondere f&#xFC;hrt es <em>nicht</em> dazu, dass aus einem SOURCE-Datensatz mehrere Datens&#xE4;tze entstehen (wie es bei einem normalen Datenbank-Join der Fall w&#xE4;re).</li>
<li>Die Schl&#xFC;ssel der Ergebnisdatens&#xE4;tze bleiben die Schl&#xFC;ssel aus SOURCE und werden nicht kombiniert aus SOURCE und ATTACH.</li>
</ul>
<h4 id="type-overlay">TYPE &quot;overlay&quot;</h4>
<p>Eine Datenquelle des Typs &quot;overlay&quot; wird verwendet, um Datens&#xE4;tze aus einer Datenquelle um Spalten aus einer anderen Datenquelle zu erg&#xE4;nzen oder um Spaltenwerte einer Datenquelle durch Werte einer gleichnamigen Spalte einer anderen Datenquelle zu ersetzen. Eine &quot;overlay&quot; Datenquelle ist sehr &#xE4;hnlich zu einer &quot;attach&quot; Datenquelle. Im Einzelfall muss gepr&#xFC;ft werden, welcher Type f&#xFC;r das entsprechende Problem besser passt. Eine &quot;overlay&quot; Datenquelle wird wie folgt definiert:</p>
<pre><code>Datenquelle(
  NAME &quot;&lt;Name_der_Datenquelle&gt;&quot;
  TYPE &quot;overlay&quot;
  SOURCE &quot;&lt;Name_Datenquelle1&gt;&quot;
  OVERLAY &quot;&lt;Name_Datenquelle2&gt;&quot;
  MODE &quot;&lt;Modus&gt;&quot;   # so, os, So, oS, sO, Os, SO, OS
  MATCH(&quot;&lt;Spalte_aus_Datenquelle1&gt;&quot; &quot;&lt;Spalte_aus_Datenquelle2&gt;&quot;)
  MATCH(&quot;&lt;Spalte_aus_Datenquelle1&gt;&quot; &quot;&lt;Spalte_aus_Datenquelle2&gt;&quot;)
  ...
)
</code></pre><p>SOURCE gibt die Datenquelle an, die die Datens&#xE4;tze bestimmen soll, OVERLAY die Datenquelle, die die Erg&#xE4;nzungs* und Ersetzungsspalten liefern soll. Die MATCH-Bl&#xF6;cke enthalten jeweils einen Namen einer Spalte in Datenquelle SOURCE und einen Namen einer Spalte in Datenquelle OVERLAY. F&#xFC;r jeden Datensatz aus SOURCE wird gesucht, ob es in Datenquelle OVERLAY einen Datensatz gibt, bei dem die Werte in den Spalten <spalte_aus_datenquelle2> mit den Werten aus den Spalten <spalte_aus_datenquelle1> des SOURCE-Datensatzes &#xFC;bereinstimmen. Falls ja, so werden die Spalten des OVERLAY-Datensatzes benutzt um den SOURCE-Datensatz zu ver&#xE4;ndern.</spalte_aus_datenquelle1></spalte_aus_datenquelle2></p>
<p>Die Ergebnisdatenquelle besitzt alle Spalten von SOURCE und alle Spalten von OVERLAY. Anders als bei einer Datenquelle des Typs &quot;attach&quot; sind alle Spalten unter ihrem urspr&#xFC;nglichen Namen verf&#xFC;gbar ohne irgendein Pr&#xE4;fix. Enthalten SOURCE und OVERLAY Spalten mit den gleichen Namen, so bestimmt die MODE-Angabe, welche Spalte in einem Ergebnisdatensatz sichtbar ist. <modus> kann folgende Werte haben</modus></p>
<ul>
<li><strong>so</strong>: Der OVERLAY-Wert wird verwendet, au&#xDF;er es ist der leere String oder unbelegt. In letzteren F&#xE4;llen wird der SOURCE-Wert verwendet.</li>
<li><strong>sO</strong>: Der OVERLAY-Wert wird verwendet, au&#xDF;er er ist unbelegt. In letzterem Fall wird der SOURCE-Wert verwendet. Man beachte, dass ein leerer String <em>nicht</em> als &quot;unbelegt&quot; z&#xE4;hlt.</li>
<li><strong>So</strong>: gleich wie &quot;so&quot;</li>
<li><strong>SO</strong>: gleich wie &quot;sO&quot;</li>
<li><strong>os</strong>: Der SOURCE-Wert wird verwendet, au&#xDF;er es ist der leere String oder unbelegt. In letzteren F&#xE4;llen wird der OVERLAY-Wert verwendet.</li>
<li><strong>oS</strong>: Der SOURCE-Wert wird verwendet, au&#xDF;er er ist unbelegt. In letzterem Fall wird der OVERLAY-Wert verwendet. Man beachte, dass ein leerer String <em>nicht</em> als &quot;unbelegt&quot; z&#xE4;hlt.</li>
<li><strong>Os</strong>: gleich wie &quot;os&quot;</li>
<li><strong>OS</strong>: gleich wie &quot;oS&quot;</li>
</ul>
<p>Man kann sich das Ganze vorstellen als transparente Folien, die in der Reihenfolge der Buchstaben im &lt;Modus&gt; &#xFC;bereinandergelegt werden. Dabei steht &quot;S&quot; f&#xFC;r SOURCE und &quot;O&quot; f&#xFC;r OVERLAY. Ein Kleinbuchstabe gibt jeweils an, dass leere Strings &quot;durchsichtig&quot; sind. Ein Gro&#xDF;buchstabe gibt an, dass leere Strings &quot;undurchsichtig&quot; sind (&quot;wei&#xDF;e Fl&#xE4;che&quot;).</p>
<p>Anmerkungen:</p>
<ul>
<li>Falls es zu einem SOURCE-Datensatz keinen passenden OVERLAY-Datensatz gibt, so werden f&#xFC;r diesen Datensatz die OVERLAY-Spalten als unbelegt behandelt. Insbesondere f&#xFC;hrt diese also <em>nicht</em> dazu, dass ein SOURCE-Datensatz verschwindet (wie es bei einem normalen Datenbank-Join der Fall w&#xE4;re).</li>
<li>Falls es zu einem SOURCE-Datensatz mehrere OVERLAY-Datens&#xE4;tze gibt, so wird einer davon (auf unspezifizierte Weise) ausgew&#xE4;hlt. Insbesondere f&#xFC;hrt es <em>nicht</em> dazu, dass aus einem SOURCE-Datensatz mehrere Datens&#xE4;tze entstehen (wie es bei einem normalen Datenbank-Join der Fall w&#xE4;re).</li>
<li>Die Schl&#xFC;ssel der Ergebnisdatens&#xE4;tze bleiben die Schl&#xFC;ssel aus SOURCE und werden <em>nicht</em> kombiniert aus SOURCE und OVERLAY.</li>
</ul>
<h2 id="initialisierung-der-pers&#xF6;nlichen-absenderliste">Initialisierung der pers&#xF6;nlichen Absenderliste</h2>
<p>Die &quot;pers&#xF6;nliche Absenderliste&quot; enth&#xE4;lt eine Liste aller Personen die als Absender verwendet werden k&#xF6;nnen. Ist diese Liste leer (z.B. beim ersten Starten des WollMux in einem Benutzerprofil), so wird eine Initialisierungsroutine gestartet, die versucht, die persoenliche Absenderliste mit mindestens einem Wert zu belegen.</p>
<h3 id="der-abschnitt-persoenlicheabsenderlisteinitialisierungsuchstrategie">Der Abschnitt PersoenlicheAbsenderlisteInitialisierung/Suchstrategie</h3>
<p>Der Konfigurationsabschnitt &quot;PersoenlicheAbsenderlisteInitialisierung/Suchstrategie&quot; dient dazu, die Reihenfolge zu beschreiben, nach der bei der Initialisierung in der durch SENDER_SOURCE definierten Datenquelle gesucht werden soll.</p>
<p>Folgendes Beispiel zeigt einen vollst&#xE4;ndigen Abschnitt PersoenlicheAbsenderlisteInitialisierung/Suchstrategie:</p>
<pre><code>PersoenlicheAbsenderlisteInitialisierung(
  Suchstrategie(

   # Benutzernamen haben auf dem Basisclient analog zu den Mailadressen
   # der LHM in der Regel die Form vorname.nachname. Wird also an den
   # Benutzernamen der Zusatz &quot;@muenchen.de&quot; angeh&#xE4;ngt, so kann der Name
   # als Mailadresse interpretiert werden. Die Suche nutzt genau diese
   # M&#xF6;glichkeit aus.
   BY_JAVA_PROPERTY(Mail &quot;${user.name}@muenchen.de&quot;)

   # Unter Extras-&gt;Optionen-&gt;LibreOffice-&gt;Benutzerdaten k&#xF6;nnen in
   # LibreOffice Benutzerdaten hinterlegt werden. In dieser Regel wird
   # nach der Kombination Vorname/Nachname gesucht, wobei die entsprechenden
   # Felder im OOo_USER_PROFILE &quot;givenname&quot; und &quot;sn&quot; heissen.
   BY_OOO_USER_PROFILE(Vorname &quot;${givenname}&quot; Nachname &quot;${sn}&quot;)

  )
)
</code></pre><p>Ist in der Konfigurationsdatei keine Suchstrategie definiert, so wird automatisch folgende Standardsuchstrategie verwendet:</p>
<pre><code>PersoenlicheAbsenderlisteInitialisierung(
  Suchstrategie(
   BY_OOO_USER_PROFILE(Vorname &quot;${givenname}&quot; Nachname &quot;${sn}&quot;)
  )
)
</code></pre><p>Der Abschnitt hat folgenden Aufbau:</p>
<pre><code>PersoenlicheAbsenderlisteInitialisierung(
  Suchstrategie(

   &lt;Suchanfrage1&gt;
   &lt;Suchanfrage2&gt;
   ...
   &lt;SuchanfrageN&gt;

  )
)
</code></pre><p><suchanfrage>:</suchanfrage></p>
<p><suchanfrage> beschreibt eine Suchanfrage, die an die durch SENDER_SOURCE definierte Datenquelle abgeschickt wird. Jede Suchanfrage kann gefundene Datens&#xE4;tze zur&#xFC;ckliefern, muss aber nicht. Wird bei einer Suchanfrage kein Datensatz gefunden, so wird mit der n&#xE4;chsten Suchanfrage fortgefahren. Werden &#xFC;ber eine Suchanfrage Datens&#xE4;tze gefunden, so werden diese Datens&#xE4;tze in die Pers&#xF6;nliche Absenderliste &#xFC;bertragen und die Suche beendet.</suchanfrage></p>
<p>Eine Suchanfrage <suchanfrage> ist dabei wie folgt aufgebaut:</suchanfrage></p>
<p><code>&lt;BY_QUELLE&gt;(&lt;Spaltenname&gt; &apos;&lt;Wert&gt;&apos;)</code></p>
<p>bzw.</p>
<p><code>&lt;BY_QUELLE&gt;(&lt;Spaltenname1&gt; &apos;&lt;Wert1&gt;&apos; &lt;Spaltenname2&gt; &apos;&lt;Wert2&gt;&apos;)</code></p>
<ul>
<li><strong>&lt;Spaltenname&gt;</strong>: Beschreibt den Name der Spalte in der durch SENDER_SOURCE beschriebenen Datenquelle, in der nach dem Wert <wert> gesucht werden soll. Pro Sucheintrag k&#xF6;nnen zwei Spaltennamen angegeben werden, die bei der Suche mit UND verkn&#xFC;pft werden.</wert></li>
<li><strong>&lt;Wert&gt;</strong>: Beschreibt den Wert nach dem in der Spalte &lt;Spaltenname&gt; gesucht werden soll. Der Wert darf Variablen in der Form &quot;${variablenname}&quot; enthalten (z.B. &quot;${user.name}@muenchen.de&quot;). Vor der Suche wird die Variable aus einer anderen, durch &lt;BY_QUELLE&gt; beschriebenen Datenquelle ausgelesen.</li>
<li><strong>&lt;BY_QUELLE&gt;</strong>: Beschreibt die Datenquelle die f&#xFC;r die Aufl&#xF6;sung der Variablen aus &lt;Wert&gt; herangezogen werden sollen.</li>
</ul>
<p>Folgende Quellen stehen dabei zur Verf&#xFC;gung:</p>
<h4 id="die-quelle-byjavaproperty">Die Quelle BY_JAVA_PROPERTY</h4>
<p>Die Quelle BY_JAVA_PROPERTY verwendet f&#xFC;r die Aufl&#xF6;sung der in &lt;Wert&gt; enthaltenen Variablen die Java-Methode System.getProperty(key).</p>
<p>Beispiel: Die Variable &quot;${user.name}&quot; enth&#xE4;lt den Benutzernamen des aktuell angemeldeten Benutzers (z.B. &quot;christoph.lutz&quot; auf dem Linux Basisclient oder &quot;lut&quot; unter Windows).</p>
<p>Unter <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#getProperties" target="_blank">http://java.sun.com/j2se/1.5.0/docs/api/java/lang/System.html#getProperties()</a> befindet sich eine Liste aller Java-Properties, die standardm&#xE4;&#xDF;ig in Java verf&#xFC;gbar sind. Systemadministratoren k&#xF6;nnen zus&#xE4;tzlich auch eigene Properties definieren.</p>
<h4 id="die-quelle-byooouserprofile">Die Quelle BY_OOO_USER_PROFILE</h4>
<p>Die Quelle BY_OOO_USER_PROFILE verwendet f&#xFC;r die Aufl&#xF6;sung der in <wert> enthaltenen Variablen die Werte, die in LibreOffice &#xFC;ber Extras&#x2192;Optionen&#x2192;LibreOffice&#x2192;Benutzerdaten eingegeben werden k&#xF6;nnen.</wert></p>
<p>Beispiel: Die Variable &quot;${givenname}&quot; enth&#xE4;lt den Vornamen der im Feld &quot;Vorname&quot; eingetragen wurde (z.B. &quot;Christoph&quot;).</p>
<p>Folgende Variablen stehen dabei zur Verf&#xFC;gung:</p>
<pre><code>c: &lt;Land/Region&gt;
facsimiletelephonenumber: &lt;Fax&gt;
givenname: &lt;Vorname&gt;
homephone: &lt;Tel. (Privat)&gt;
initials: &lt;kuerzel&gt;
l: &lt;Ort&gt;
mail: &lt;E-Mail&gt;
o: &lt;Firma&gt;
position: &lt;Position&gt;
postalcode: &lt;PLZ&gt;
sn: &lt;Nachname&gt;
street: &lt;Stra&#xDF;e&gt;
telephonenumber: &lt;Tel. (Gesch&#xE4;ftlich)&gt;
title: &lt;Titel&gt;
</code></pre><h2 id="menues-und-symbolleisten">Menues und Symbolleisten</h2>
<p>Mit den Optionen in diesem Abschnitt k&#xF6;nnen Sie die <strong>WollMux-Sidebar &quot;Vorlagen und Formulare&quot; konfigurieren</strong>. Sie k&#xF6;nnen eigene Men&#xFC;strukturen und die Inhalte der Symbolleiste festlegen.</p>
<h3 id="der-abschnitt-menueleiste">Der Abschnitt Menueleiste</h3>
<p>Der Abschnitt Menueleiste beschreibt alle Menues, die in der WollMux-Leiste angezeigt werden sollen. Ein typischer Menueleiste-Abschnitt sieht wie folgt aus:</p>
<pre><code>Menueleiste(
     (LABEL &quot;Standard&quot; TYPE &quot;menu&quot; MENU &quot;am_1_Standard&quot; HOTKEY &quot;S&quot;)
     (LABEL &quot;Extras&quot; TYPE &quot;menu&quot; MENU &quot;am_4_eXtras&quot; HOTKEY &quot;X&quot;)
)
</code></pre><p>Der Abschnitt Menueleiste darf in der Konfigurationsdatei mehrfach auftreten. Die WollMux-Leiste verwendet jedoch nur den zuletzt definierten Abschnitt. Mit diesem Mechanismus kann der Abschnitt leicht redefiniert werden. Sie k&#xF6;nnen den Mechanismus verwenden, um das standardm&#xE4;ssig eingestellten Men&#xFC;s &quot;Standard&quot; und &quot;Extras&quot; zu l&#xF6;schen, umzubenennen oder ein weitere Men&#xFC; hinzuzuf&#xFC;gen.</p>
<p>Der Menueleiste-Abschnitt darf mehrere Eintr&#xE4;ge enthalten, die in der gegebenen Reihenfolge im Men&#xFC; angezeigt werden. Jeder Eintrag richtet sich nach dem unter <a href="#menue-elemente">Menue-Elemente</a> beschriebenen Schema. Dort sind auch die Attribute <strong>LABEL</strong>, <strong>HOTKEY</strong>, <strong>TYPE</strong> und <strong>MENUE</strong> beschrieben.</p>
<h3 id="der-abschnitt-symbolleisten-bzw-briefkopfleiste">Der Abschnitt Symbolleisten bzw. Briefkopfleiste</h3>
<p>Der Abschnitt Symbolleisten beschreibt den Inhalt der in der WollMux-Sidebar dargestellten Symbolleiste. Hier ist eine Beispiel f&#xFC;r eine Symbolleisten-Definition:</p>
<pre><code>Symbolleisten(
  Briefkopfleiste(
      (LABEL &quot;Absender ausw&#xE4;hlen&quot; TYPE &quot;senderbox&quot;)
      (LABEL &quot;Externer Briefkopf&quot; FRAG_ID &quot;externerBriefkopf&quot; HOTKEY &quot;X&quot; ACTION &quot;openTemplate&quot; TYPE &quot;button&quot; )
      (TYPE &quot;separator&quot;)
      (LABEL &quot;Interner Briefkopf&quot; FRAG_ID &quot;internerBriefkopf&quot; HOTKEY &quot;I&quot; ACTION &quot;openTemplate&quot; TYPE &quot;button&quot; )
      (TYPE &quot;separator&quot;)
      (LABEL &quot;Kurzmitteilung&quot;  FRAG_ID &quot;kurzmitteilung&quot; HOTKEY &quot;K&quot; ACTION &quot;openTemplate&quot; TYPE &quot;button&quot; )
      (TYPE &quot;separator&quot;)
      (LABEL &quot;Fax-Vorlage&quot;        FRAG_ID &quot;faxVorlage&quot; HOTKEY &quot;F&quot; ACTION &quot;openTemplate&quot; TYPE &quot;button&quot; )
  )
)
</code></pre><p>Der Abschnitt Symbolleisten/Briefkopfleiste darf &#xF6;fters in der Konfigurationsdatei vorkommen. Auch hier gilt die Regel: Der zuletzt definierte Eintrag gewinnt. So k&#xF6;nnen Sie den vorgegebenen Symbolleisten/Briefkopfleiste-Abschnitt redefinieren und eigene Schaltfl&#xE4;chen hinzuf&#xFC;gen oder bestehende Schaltfl&#xE4;chen entfernen. Bei der Redefinition wird stets der gesamte Abschnitt Symbolleisten durch den neuen Abschnitt ersetzt.</p>
<p>Die Menue-Elemente innerhalb der Symbolleistendefinition richten sich nach dem unter <a href="#menue-elemente">Menue-Elemente</a> beschriebenen Schema. Dort sind auch die Attribute <strong>LABEL</strong>, <strong>HOTKEY</strong>, <strong>TYPE</strong> und <strong>MENU</strong> beschrieben.</p>
<h3 id="der-abschnitt-menues">Der Abschnitt Menues</h3>
<p>Der Abschnitt Menues beschreibt alle Untermenues, die der WollMux-Sidebar bekannt sein sollen. Eine Beispieldefinition sieht wie folgt aus:</p>
<pre><code>Menues(
  LHMVorlagen(
    Elemente(
       (LABEL &quot;Briefk&#xF6;pfe&quot; TYPE &quot;menu&quot; MENU &quot;Briefkoepfe&quot; HOTKEY &quot;B&quot; CONF_ID &quot;bk&quot;)
       (LABEL &quot;Favoriten&quot; TYPE &quot;menu&quot; MENU &quot;favoriten&quot; FAVO &quot;1&quot;)
       (TYPE &quot;separator&quot;)
       (LABEL &quot;Absenderdaten&quot; TYPE &quot;button&quot; HOTKEY &quot;A&quot; ACTION &quot;absenderAuswaehlen&quot;)
    )
  )

  Briefkoepfe(
    Elemente(
       (LABEL &quot;Externer Briefkopf&quot;  FRAG_ID &quot;externerBriefkopf&quot; HOTKEY &quot;X&quot; ACTION &quot;openTemplate&quot; TYPE &quot;button&quot; )
       (LABEL &quot;Interner Briefkopf&quot;  FRAG_ID &quot;internerBriefkopf&quot; HOTKEY &quot;I&quot; ACTION &quot;openTemplate&quot; TYPE &quot;button&quot; )
       (LABEL &quot;Kurzmitteilung&quot;  FRAG_ID &quot;kurzmitteilung&quot; HOTKEY &quot;K&quot; ACTION &quot;openTemplate&quot; TYPE &quot;button&quot; )
       (LABEL &quot;Fax-Vorlage&quot;             FRAG_ID &quot;faxVorlage&quot; HOTKEY &quot;F&quot; ACTION &quot;openTemplate&quot; TYPE &quot;button&quot; )
    )
  )  
)
</code></pre><p>Der Abschnitt Menues darf innerhalb der Konfigurationsdatei mehrmals auftauchen. In jedem Abschnitt ist es m&#xF6;glich <strong>einzelne</strong> Menues hinzuzuf&#xFC;gen oder zu redefinieren. Auch hier gilt die Regel: Die letzte Definition gewinnt.</p>
<p>Der Menues-Abschnitt darf mehrere Eintr&#xE4;ge enthalten. Jeder Eintrag repr&#xE4;sentiert ein Untermen&#xFC; und die darin enthaltenen Elemente. Der Name des Untermenues (im Beispiel &quot;LHMVorlagen&quot; und &quot;Briefkoefpe&quot;) ist ein Bezeichner mit dem f&#xFC;r Bezeichner &#xFC;blichen eingeschr&#xE4;nkten Zeichensatz. Jedes von Ihnen definierte Untermenue muss einen anderen Namen besitzen.</p>
<p>Die Menue-Elemente innerhalb einer Untermenue-Definition richten sich nach dem unter <a href="#menue-elemente">Menue-Elemente</a> beschriebenen Schema. Dort sind auch die Attribute <strong>LABEL</strong>, <strong>HOTKEY</strong>, <strong>TYPE</strong> und <strong>MENU</strong> beschrieben.</p>
<h4 id="menue-elemente">Menue-Elemente</h4>
<p>Ein Menue-Element beschreibt die Eigenschaften und das Verhalten eines Elements innerhalb eines Menueleiste-, Symbolleiste* und Menues-Abschnitts. Menue-Elemente besitzen folgende Eigenschaften:</p>
<h5 id="das-attribut-type">Das Attribut TYPE</h5>
<p>Das Attribut TYPE ist das wichtigste Attribut eines Menue-Elements. Es <strong>muss</strong> in jedem Menue-Element vorkommen. Anhand des Attributwerts entscheidet der WollMux, welche weiteren Attribute auszuwerten sind.</p>
<p>Folgende Typen sind m&#xF6;glich:</p>
<ul>
<li><strong>button</strong>: Beschreibt ein einfaches Menue-Element, das eine Aktion hervorruft, wenn darauf geklickt wird.</li>
<li><strong>menu</strong>: Beschreibt ein Untermenue, das beim Klicken auf das Menue-Element aufgeklappt werden soll.</li>
<li><strong>separator</strong>: Beschreibt einen Trennstrich innerhalb eines Menues oder einer Symbolleiste.</li>
<li><strong>glue</strong>: Ist ein unsichtbares Element, das dazu dient, Leerraum einzuf&#xFC;gen (und dadurch Links* bzw. Rechtsb&#xFC;ndigkeit zu erreichen).</li>
<li><strong>senderbox</strong>: Beschreibt die ComboBox &quot;Absender-Ausw&#xE4;hlen&quot;, die die Liste aller in der pers&#xF6;nlichen Absenderliste enthaltenen
  Absender zeigt.</li>
<li><strong>searchbox</strong>: Beschreibt ein Such-Eingabefeld, mit dem die Elemente in der WollMux-Sidebar dursucht werden k&#xF6;nnen.</li>
</ul>
<h5 id="das-attribut-label">Das Attribut LABEL</h5>
<p>Das Attribut LABEL enth&#xE4;lt die in der WollMux-Sidebar dargestellte Bezeichnung des Menue-Elements. Jedes Menue-Element mit dem Typ &quot;button&quot; oder &quot;menue&quot; <strong>muss</strong> ein LABEL-Attribut besitzen.</p>
<h5 id="das-attribut-hotkey">Das Attribut HOTKEY</h5>
<p>Das Attribut HOTKEY beschreibt die Taste, die als <em>shortcut</em> zum Aufrufen der Funktion des Menue-Elements angeboten werden soll. Die HOTKEY&apos;s werden unter Windows nur dargestellt, wenn die ALT-Taste gedr&#xFC;ckt wird, da jeder Hotkey an die ALT-Taste gebunden ist. Jedes Menue-Element mit dem Typ &quot;button&quot; oder &quot;menue&quot; kann ein HOTKEY-Attribut besitzen.</p>
<h5 id="das-attribut-menu">Das Attribut MENU</h5>
<p>Das Attribut MENU enth&#xE4;lt den Bezeichner des im Abschnitt Menues definierten Untermenues, das beim Klick auf dieses Menue-Element aufgeklappt werden soll. Jedes Menue-Element mit dem Typ &quot;menu&quot; <strong>muss</strong> ein MENU-Attribut besitzen.</p>
<h5 id="das-attribut-action">Das Attribut ACTION</h5>
<p>Das Attribut ACTION beschreibt die Aktion, die beim Klick auf ein einfaches Menue-Element (mit dem Typ &quot;button&quot;) ausgef&#xFC;hrt werden soll.</p>
<p>Derzeit sind folgende Aktionen m&#xF6;glich:</p>
<ul>
<li><em>openTemplate</em>: &#xD6;ffnet ein definiertes Textfragment als neue Dokumentvorlage. Erfordert die Angabe des Attributs FRAG_ID.</li>
<li><em>openDocument</em>: &#xD6;ffnet ein definiertes Textfragment als Dokument, d.h. die Datei wird direkt zum Bearbeiten ge&#xF6;ffnet, ohne dass ein neues Dokument &quot;UnbenanntX&quot; angelegt wird. Erfordert die Angabe des Attributs FRAG_ID.</li>
<li><em>open</em>:<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Diese Aktion wird nicht l&#xE4;nger unterst&#xFC;tzt.</p>
</blockquote>
</li>
<li><p><em>openExt</em>: &#xD6;ffnet eine Datei oder URL mit einer externen Anwendung. Erfordert die Angabe des Attributs EXT, das die externe Anwendung identifiziert (typischerweise die Dateierweiterung) sowie des Attributs URL, das die zu &#xF6;ffnende URL angibt. Zur korrekten Funktionsweise ist ein Eintrag f&#xFC;r die externe Anwendung im Abschnitt <a href="#externeanwendungen">ExterneAnwendungen</a> erforderlich.</p>
<p>  In der URL kann die Variable <code>${user.home}</code> verwendet werden. Diese wird ersetzt durch die mit &quot;file:&quot; beginnende URL des Home-Verzeichnisses (unter Windows <code>C:\Dokumente und Einstellungen\&lt;Benutzer&gt;</code>, unter Linux <code>/home/&lt;Benutzer&gt;</code>).</p>
</li>
<li><em>absenderAuswaehlen</em>: &#xD6;ffnet das Dialogfenster &quot;Absender Ausw&#xE4;hlen&quot;.</li>
<li><em>dumpInfo</em>: erzeugt eine Datei <code>$HOME/.wollmux/dump&lt;DatumUndZeit&gt;</code>, die wichtige Informationen f&#xFC;r die Fehlersuche im Zusammenhang mit dem WollMux enth&#xE4;lt. DumpInfo ist vor allem f&#xFC;r WollMux-Administratoren geeignet, die bei der Installation und Einrichtung des WollMux auf Fehler sto&#xDF;en, f&#xFC;r deren L&#xF6;sung Unterst&#xFC;tzung durch D-III-ITD 5.1 notwendig wird. In diesem Fall ist die &#xFC;ber dumpInfo erzeugte dump-Datei an ein entsprechendes Vorfallticket anzuh&#xE4;ngen.</li>
<li><p><em>kill</em>: Beendet LibreOffice OHNE(!) jede Sicherheitsabfragen. Ein entsprechender Kill-Button sollte niemals f&#xFC;r Endanwenderinnen und Endanwender sichtbar sein, sondern ausschlie&#xDF;lich zur Unterst&#xFC;tzung der Einrichtung und des Tests des WollMux von Systemadministratoren verwendet werden.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Trotz des martialischen Namens kann dieser Befehl keine h&#xE4;ngenden LibreOffice Prozesse beenden.</p>
</blockquote>
</li>
<li><p><em>about</em>: Zeigt einen Dialog, der wichtige Versionsinformationen zum aktuell installierten WollMux, zur WollMux-Sidebar und zur verwendeten Konfiguration enth&#xE4;lt.</p>
</li>
</ul>
<h5 id="das-attribut-ext">Das Attribut EXT</h5>
<p>Das Attribut EXT muss in Verbindung mit der Aktion &quot;<strong>openExt</strong>&quot; angegeben werden. Es identifiziert den Eintrag im Abschnitt <a href="#externeanwendungen">ExterneAnwendungen</a>, der zum &#xD6;ffnen der URL herangezogen werden soll.</p>
<h5 id="das-attribut-url">Das Attribut URL</h5>
<p>Das Attribut URL muss in Verbindung mit der Aktion &quot;<strong>openExt</strong>&quot; angegeben werden. Es gibt an, welche URL der externen Anwendung als Argument &#xFC;bergeben werden soll, bzw. von welcher URL Daten in eine tempor&#xE4;re Datei heruntergeladen werden sollen, deren Pfad dann an die externe Anwendung &#xFC;bergeben wird. N&#xE4;here Informationen finden sich bei der Beschreibung des Abschnitts <a href="#externeanwendungen">ExterneAnwendungen</a>.</p>
<h5 id="das-attribut-fragid">Das Attribut FRAG_ID</h5>
<p>Das Attribut FRAG_ID muss in Verbindung mit den Aktionen &quot;<strong>openTemplate</strong>&quot; und &quot;<strong>openDocument</strong>&quot; angegeben werden. FRAG_ID enth&#xE4;lt dabei die ID des Textfragments, welches im <a href="#textfragmente">Textfragmente-Abschnitt</a> der Konfigurationsdatei definiert sein muss.</p>
<h6 id="liste-mit-fragid-attributen">Liste mit FRAG_ID-Attributen</h6>
<p>Manchmal ist es w&#xFC;nschenswert, die Inhalte zweier Textfragmente zusammen zu mischen. Um das zu erreichen, k&#xF6;nnen Sie in einer Element-Beschreibung mehrere FRAG_ID-Attribute angeben. Dies sieht z.B. wie folgt aus:</p>
<pre><code>(LABEL &quot;Baugenehmigung (Auf Basis des externen Briefkopfs)&quot; HOTKEY &quot;F&quot; ACTION &quot;openTemplate&quot; TYPE &quot;button&quot;
  FRAG_ID &quot;externerBriefkopf&quot; FRAG_ID &quot;Baugenehmigung&quot; FRAG_ID &quot;...noch_mehr_fragmente...&quot;)
</code></pre><p>Beim Klick auf den so definierten Button wird zun&#xE4;chst das erste Fragment der FRAG_ID-Liste (im Beispiel &quot;externerBriefkopf&quot;) als Vorlage ge&#xF6;ffnet. Anschlie&#xDF;end f&#xFC;hrt der WollMux alle in der Vorlage enthaltenen <a href="Dokumentkommandos_des_WollMux.html">Dokumentkommandos</a> aus. Enth&#xE4;lt die Vorlage das Dokumentkommando <a href="Dokumentkommandos_des_WollMux.html#das-kommando-insertcontent">insertContent</a>, so wird das n&#xE4;chste Textfragment aus der FRAG_ID-Liste (im Beispiel &quot;Baugenehmigung&quot;) an dieser Stelle eingef&#xFC;gt und dessen Dokumentkommandos ausgef&#xFC;hrt, usw... Jedes Textfragment darf dabei genau ein <em>insertContent</em> Kommando besitzen. Ist das Ende der FRAG_ID-Liste erreicht und der WollMux st&#xF6;&#xDF;t im letzten eingef&#xFC;gten Textfragment (trotzdem) auf ein weiteres <em>insertContent</em>-Kommando, so wird dieses Dokumentkommando ignoriert.</p>
<h2 id="fenster">Fenster</h2>
<p>Mit dem Abschnitt <em>Fenster</em> k&#xF6;nnen Sie Position, Gr&#xF6;&#xDF;e und Eigenschaften verschiedener im Rahmen des WollMux auftretender Fenster festlegen.</p>
<h3 id="writer-fenster-der-abschnitt-textdokument">Writer-Fenster (Der Abschnitt Textdokument)</h3>
<p>Die Eigenschaften von Writer-Fenstern lassen sich &#xFC;ber den Abschnitt <em>Textdokument</em> festlegen. Enth&#xE4;lt die Konfigurationsdatei diesen Abschnitt nicht, so wird die Fensterverwaltung wie gewohnt LibreOffice &#xFC;berlassen.</p>
<pre><code>Fenster(
  Textdokument(
    X &quot;0&quot;
    Y &quot;40&quot;
    ZOOM &quot;PageWidthExact&quot;
  )
)
</code></pre><p>Im Abschnitt Textdokument sind folgende Attribute m&#xF6;glich, dabei sind alle Attribute optional:</p>
<h4 id="x-y">X, Y</h4>
<p>Die Position der linken oberen Ecke des Fensters auf dem Bildschirm. Es m&#xFC;ssen stets beide Attribute X und Y angegeben sein, damit die Werte gesetzt werden.</p>
<h4 id="width-height">WIDTH, HEIGHT</h4>
<p>Die Gr&#xF6;&#xDF;e des Fensters auf dem Bildschirm. Es m&#xFC;ssen stets beide Attribute WIDTH und HEIGHT angegeben sein, damit die Werte gesetzt werden.</p>
<h4 id="zoom-zoomwert">ZOOM &apos;&lt;zoomwert&gt;&apos;</h4>
<p>&#xDC;ber die ZOOM-Angabe kann der Ma&#xDF;stab festgelegt werden, mit dem Writer-Fenster standardm&#xE4;&#xDF;ig dargestellt werden. F&#xFC;r den <em>&lt;zoomwert&gt;</em> sind folgende Werte m&#xF6;glich, die sich genauso verhalten wie die entsprechenden Einstellungen, die unter &quot;Ansicht&#x2192;Ma&#xDF;stab&quot; gesetzt werden k&#xF6;nnen:</p>
<ul>
<li><strong>Eine Prozentangabe</strong>: &#xDC;ber die Angabe einer ganzzahligen Prozentzahl (ohne Prozentzeichen) wird ein fester Zoomfaktor vorgeben.</li>
<li><strong>PageWidth</strong>: Mit dem Zoomwert &quot;PageWidth&quot; wird die Seite so im Fenster ausgerichtet, dass sie zwischen dem linken und dem rechten Seitenrand der Breite nach vollst&#xE4;ndig dargestellt werden kann. &#xDC;ber einen zus&#xE4;tzlichen sichtbaren Freiraum zwischen dem Fenster und den Seitenr&#xE4;ndern wird die Seite zus&#xE4;tzlich optisch hervorgehoben. Im Regelfall ist mit dieser Einstellung die Seite der L&#xE4;nge nach nicht vollst&#xE4;ndig sichtbar.</li>
<li><strong>PageWidthExact</strong>: Der Zoomwert &quot;PageWidthExact&quot; verh&#xE4;lt sich wie &quot;PageWidth&quot;, nur dass hier der Freiraum zur optischen Hervorhebung der Seite verschwindet und die Seite zwischen dem linken und dem rechten Seitenrand exakt im Fenster dargestellt wird.</li>
<li><strong>Optimal</strong>: Der Zoomwert &quot;Optimal&quot; verh&#xE4;lt sich wie &quot;PageWidth&quot;, allerdings orientiert sich die Ausrichtung an Stelle des linken und rechten Seitenrands am linken und rechten Rand des sichtbaren Textbereiches. Der sichtbare Textbereich wird damit in der maximalen m&#xF6;glichen Gr&#xF6;&#xDF;e im Fenster dargestellt, so dass alle wichtigen Elemente des Dokuments angezeigt werden k&#xF6;nnen ohne nach links oder rechts scrollen zu m&#xFC;ssen.</li>
<li><strong>EntirePage</strong>: Die Seite wird vollst&#xE4;ndig im entsprechenden Fenster angezeigt. Allerdings leidet in diesem Zustand auch die Lesbarkeit der Schrift.</li>
</ul>
<h3 id="formular-fenster-der-abschnitt-formular">Formular-Fenster (Der Abschnitt Formular)</h3>
<p>Die Eigenschaften von WollMux-Formularfenstern lassen sich &#xFC;ber den Abschnitt <em>Formular</em> festlegen.</p>
<pre><code>Fenster(
  Formular(
    ZOOM &quot;55&quot;
    Y &quot;96&quot;
    WIDTH &quot;400&quot;
    HEIGHT &quot;600&quot;
  )
)
</code></pre><h4 id="zoom">ZOOM</h4>
<p>Die ZOOM Angabe spezifiziert den Zoom-Faktor des neben der Formularmaske dargestellten Writer-Fensters. Das Attribut verh&#xE4;lt sich wie das <a href="#zoom-zoomwert">gleichnamige Attribut des &quot;Textdokumente&quot;-Abschnitts</a>.</p>
<h4 id="x-y">X, Y</h4>
<p>Bestimmt die Positionierung der Eingabemaske. Erlaubt sind folgende Angaben:</p>
<ul>
<li><em>&lt;Zahlenwert&gt;</em>: gibt die genaue Position in Pixeln an, gemessen von der oberen linken Ecke (0,0) des Bildschirms.</li>
<li><em>center</em>: Die Eingabemaske wird so positioniert, dass ihre Mitte mit der Mitte der X bzw. Y-Achse zusammenf&#xE4;llt.</li>
<li><em>min</em>: Fenster wird ganz oben bzw. ganz links positioniert.</li>
<li><em>max</em>: Fenster wird ganz unten bzw. ganz rechts positioniert.</li>
<li><em>auto</em>: Koordinate automatisch bestimmen. Dies ist das Standardverhalten, wenn &#xFC;berhaupt keine X bzw. Y Angabe vorhanden ist.</li>
</ul>
<h4 id="width-height">WIDTH, HEIGHT</h4>
<p>Gibt die Dimensionen der Eingabemaske an. Folgende Angaben sind zul&#xE4;ssig:</p>
<ul>
<li><em>&lt;Zahlenwert&gt;</em>: Gibt die Breite/H&#xF6;he in Pixeln an.</li>
<li><em>max</em>: Die Breite/H&#xF6;he wird so gro&#xDF; wie m&#xF6;glich.</li>
<li><em>auto</em>: Dimension automatisch bestimmen. Dies ist das Standardverhalten, wenn &#xFC;berhaupt keine WIDTH bzw. HEIGHT Angabe vorhanden ist.</li>
</ul>
<h2 id="funktionen">Funktionen</h2>
<p>Der WollMux verwendet an verschiedenen Stellen Funktionen, z.B. als Plausibilit&#xE4;tspr&#xFC;fungen f&#xFC;r Formularfelder. Funktionen, die in der wollmux.conf im Abschnitt <em>Funktionen</em> definiert werden sind global verf&#xFC;gbar.</p>
<pre><code>Funktionen(
  AnredeText(EXTERN(URL &quot;vnd.sun.star.script:WollMux.Trafo.MannOderFrau?language=Basic&amp;location=application&quot;
       PARAMS(&quot;Anrede&quot;, &quot;SuffixWeibl&quot;, &quot;SuffixMaennl&quot;)))

  AnredeText(EXTERN(URL &quot;java:de.muenchen.allg.itd51.wollmux.func.Standard.zahlenBereich&quot;
       PARAMS(&quot;wert&quot;, &quot;min&quot;, &quot;max&quot;)))

  IstZahl(MATCH(VALUE(&apos;Argument&apos;), &quot;[0-9]+&quot;))
`)
</code></pre><p><strong>Bemerkungen:</strong></p>
<ul>
<li>Jeder Eintrag des Abschnitts besteht aus einem Funktionsbezeichner gefolgt von der eigentlichen Funktionsdefinition eingeschlossen in Klammern</li>
<li>Funktionen k&#xF6;nnen redefiniert werden.</li>
<li>Innerhalb der Definition einer Funktion <em>func</em> gilt noch eine evtl. vorhandene vorhergehende Funktionsdefinition f&#xFC;r <em>func</em>, d.h. Rekursion ist nicht m&#xF6;glich, jedoch das Redefinieren einer Funktion unter Bezugnahme auf die vorherige Definition.</li>
<li>Gibt es mehrere <em>Funktionen</em>-Abschnitte in der wollmux.conf, so werden diese alle in der Reihenfolge ihres Auftretens ber&#xFC;cksichtigt.</li>
<li>Funktionen liefern grunds&#xE4;tzlich immer Strings zur&#xFC;ck. Falls in einem Kontext ein Wahrheitswert erforderlich ist, so wird der String &quot;true&quot; als wahr, jeder andere String als falsch betrachtet. Funktionen, die ihrer Natur nach einen Wahrheitswert zur&#xFC;ckliefern (wie z.B. AND) liefern die Strings &quot;true&quot; und &quot;false&quot; zur&#xFC;ck.</li>
<li><p>Falls bei der Abarbeitung einer Funktion ein Fehler auftritt, liefert die Funktion einen Fehlerstring. Dies dient dazu, den Anwender auf das Problem aufmerksam zu machen, damit er die Systembetreuung einschaltet. So wird verhindert, dass z.B. stillschweigend falsche Daten in ein Formular eingef&#xFC;gt werden.</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Der Fehlerstring kann sich jederzeit &#xE4;ndern (und dies ist auch bereits schon geschehen). Es d&#xFC;rfen also keine direkten Vergleiche gegen diesen String durchgef&#xFC;hrt werden. Zum Testen, ob eine Funktion einen Fehler geliefert hat stehen die Funktionen ISERROR und ISERRORSTRING zur Verf&#xFC;gung. Um im Fehlerfall ein spezielles Ergebnis anstatt des Fehlerstrings zur&#xFC;ckzuliefern kann SELECT verwendet werden.</p>
</blockquote>
</li>
</ul>
<h3 id="grundfunktionen">Grundfunktionen</h3>
<p>Jede Funktion setzt sich aus einer oder mehrerer Grundfunktionen zusammen. Jede Grundfunktion besteht aus einem Bezeichner in Gro&#xDF;buchstaben, gefolgt von ihren Parametern (in Klammern, falls es mehr als einer ist). Im allgemeinen kann f&#xFC;r jeden Parameter wieder eine beliebige Funktionsdefinition eingesetzt werden. Manche Parameter haben hier jedoch Einschr&#xE4;nkungen. Im folgenden sind die verf&#xFC;gbaren Grundfunktionen beschrieben.</p>
<p><strong><a href="#stringverarbeitung">Stringverarbeitung</a></strong></p>
<ul>
<li><a href="#string">String</a> - ein String-Literal ist die einfachste Grundfunktion.</li>
<li><a href="#length-argument1--argumentn">LENGTH</a> - liefert die L&#xE4;nge (in Zeichen) eines Strings.</li>
<li><a href="#match-argument-regex">MATCH</a> - testet, ob ein String einem durch einen regul&#xE4;ren Ausdruck gegebenen Muster entspricht.</li>
<li><a href="#replace-argument-regex-repstr">REPLACE</a> - ersetzt Teile eines Strings mit Hilfe von regul&#xE4;ren Ausdr&#xFC;cken.</li>
<li><a href="#split-argument-regex-index">SPLIT</a> - Teile Strings mit Hilfe von regul&#xE4;ren Ausdr&#xFC;cken auf in mehrere Teile und liefere einen dieser Teile zur&#xFC;ck.</li>
<li><a href="#cat-argument1--argumentn">CAT</a> - verkettet mehrere Strings zu einem langen String.</li>
<li><a href="#formatargument-min-minstellen-max-maxstellen">FORMAT</a> - formatiert Zahlenwerte auf eine minimale und/oder maximale Anzahl von Nachkommastellen.</li>
</ul>
<p><strong><a href="#arithmetik">Arithmetik</a></strong></p>
<ul>
<li><a href="sum-argument1--argumentn">SUM</a> - bildet die Summe aus einer Reihe von Zahlenwerten.</li>
<li><a href="#diff-argument1--argumentn">DIFF</a> - subtrahiert von einem Zahlenwert einen oder mehrere andere Zahlenwerte.</li>
<li><a href="#product-argument1--argumentn">PRODUCT</a> - bildet das Produkt aus einer Reihe von Zahlenwerten.</li>
<li><a href="#dividedividend-bydivisor-min-minstellen-max-maxstellen">DIVIDE</a> - berechnet den Quotienten aus 2 Zahlenwerten mit beliebig vorgebbarer Genauigkeit.</li>
<li><a href="#abs-argument1--argumentn">ABS</a> - berechnet den absoluten Betrag eines Zahlenwerts.</li>
<li><a href="#sign-argument1--argumentn">SIGN</a> - liefert -1, 0, +1 je nachdem, ob das Argument negativ, 0 oder positiv ist.</li>
</ul>
<p><strong><a href="#vergleiche">Vergleiche</a></strong></p>
<ul>
<li><a href="#iserror-funktion">ISERROR</a> - testet, ob eine Funktion einen Fehler zur&#xFC;ckliefert.</li>
<li><a href="#iserrorstring-funktion">ISERRORSTRING</a> - vergleicht einen String mit dem speziellen Fehler-String.</li>
<li><a href="#strcmp-argument1--argumentn">STRCMP</a> - vergleicht 2 oder mehr Strings.</li>
<li><a href="#numcmp-argument1--argumentn-margin-maxabweichung-">NUMCMP</a> - vergleicht 2 oder mehr Zahlenwerte.</li>
<li><a href="#lt-argument1--argumentn-margin-maxabweichung-">LT</a> - pr&#xFC;ft, ob zwischen der ersten Zahl und den folgenden Zahlen die &lt; Beziehung besteht.</li>
<li><a href="#le-argument1--argumentn-margin-maxabweichung-">LE</a> - pr&#xFC;ft, ob zwischen der ersten Zahl und den folgenden Zahlen die &lt;= Beziehung besteht.</li>
<li><a href="#gt-argument1--argumentn-margin-maxabweichung-">GT</a> - pr&#xFC;ft, ob zwischen der ersten Zahl und den folgenden Zahlen die &gt; Beziehung besteht.</li>
<li><a href="#ge-argument1--argumentn-margin-maxabweichung-">GE</a> - pr&#xFC;ft, ob zwischen der ersten Zahl und den folgenden Zahlen die &gt;= Beziehung besteht.</li>
</ul>
<p><strong><a href="#logische-verkn&#xFC;pfungen">Logische Verkn&#xFC;pfungen</a></strong></p>
<ul>
<li><a href="#and-funktion1--funktionn">AND</a> - liefert &quot;true&quot; gdw. alle enthaltenen Funktionen &quot;true&quot; liefern.</li>
<li><a href="#or-funktion1--funktionn">OR</a> - liefert &quot;true&quot; gdw. mindestens eine der enthaltenen Funktionen &quot;true&quot; liefert.</li>
<li><a href="#not-funktion1--funktionn">NOT</a> - liefert &quot;true&quot; gdw. keine der enthaltenen Funktionen &quot;true&quot; liefert.</li>
</ul>
<p><strong><a href="#ablaufsteuerungkontrollfluss">Ablaufsteuerung/Kontrollfluss</a></strong></p>
<ul>
<li><a href="#if-bedingung-then-dann-else-sonst-">IF</a> - testet eine Bedingung und liefert bei &quot;true&quot; den THEN-Teil, bei &quot;false&quot; den ELSE-Teil als Ergebnis.</li>
<li><a href="#select-funktion1--funktionn">SELECT</a> - w&#xE4;hlt aus einer Reihe von Funktionen einen Wert aus, typischerweise abh&#xE4;ngig von Bedingungen.</li>
</ul>
<p><strong><a href="#funktionen-f&#xFC;r-formulare">Funktionen f&#xFC;r Formulare</a></strong></p>
<ul>
<li><a href="#value-argument">VALUE</a> - liefert den Wert eines Formularfeldes.</li>
<li><a href="#dialog-dialogname-feldname">DIALOG</a> - liefert einen &#xFC;ber einen Funktionsdialog ausgew&#xE4;hlten Wert.</li>
</ul>
<p><strong><a href="#zugriff-auf-externe-funktionen">Zugriff auf externe Funktionen</a></strong></p>
<ul>
<li><a href="#extern-url-url-paramsparam1--paramn">EXTERN</a> - erm&#xF6;glicht den Zugriff auf externe Java oder Basic-Funktionen.</li>
<li><a href="#bind-function-funktionsname-setparamname1-wert1--setparamnamen-wertn">BIND (mit Funktionsname)</a> - ruft eine global im Funktionen-Abschnitt definierte externe Funktion mit Parametern auf.</li>
<li><a href="#bind-functionfunktion-setparamname1-wert1--setparamnamen-wertn">BIND (mit Funktion)</a> - ruft eine inline deklarierte (externe) Funktion mit Parametern auf.</li>
</ul>
<h3 id="stringverarbeitung">Stringverarbeitung</h3>
<h4 id="string">String</h4>
<p>Die einfachste Grundfunktion ist ein einfacher String. Jedes Element, das keine Unterelemente hat, wird als String betrachtet.</p>
<pre><code>Funktionen(
   SimplerText1(&quot;Dies ist ein einfacher Text&quot;)
   SimplerText2 &quot;Die Klammern k&#xF6;nnen wegfallen, weil SimplerText2 nur ein Unterelement hat&quot;
   SimplerText3( AND()  )    #Dies ist das selbe wie SimplerText3( &quot;AND&quot; )
)
</code></pre><p>Beachten Sie insbesondere das Beispiel SimplerText3. Auch wenn es so aussieht, als w&#xFC;rde hier die Grundfunktion AND verwendet, ist dies nicht der Fall. Die Grundfunktion AND erwartet mindestens einen Parameter. Alles was keinen Parameter hat wird als einfacher String betrachtet (auch wenn es nicht in G&#xE4;nsef&#xFC;&#xDF;chen steht). Dementsprechend liefert die Funktion SimplerText3 den String &quot;AND&quot; zur&#xFC;ck. Achtung! Technisch gesehen handelt es sich bei dem AND im letzten Beispiel um einen Schl&#xFC;ssel und es gelten die Einschr&#xE4;nkungen f&#xFC;r Schl&#xFC;ssel (z.B. keineUmlaute). Es ist davon abzuraten, diese Schreibweise zu verwenden.</p>
<h4 id="length-argument1--argumentn">LENGTH (&lt;Argument1&gt; ... &lt;ArgumentN&gt;)</h4>
<p>Die Funktion LENGTH erwartet ein oder mehrere Argumente. Diese werden alle ausgewertet und zu einem langen String verkettet. Die L&#xE4;nge dieses Strings (in Zeichen) wird zur&#xFC;ckgeliefert. Alle Argumente k&#xF6;nnen beliebige Funktionen sein. Falls eine der Funktionen einen Fehler liefert liefert LENGTH einen Fehler.</p>
<h4 id="match-argument-regex">MATCH (&lt;Argument&gt;, &lt;RegEx&gt;)</h4>
<p>Die Funktion MATCH liefert &quot;true&quot;, wenn &lt;Argument&gt; als Ganzes auf den regul&#xE4;ren Ausdruck &lt;RegEx&gt; passt. Die Syntax von &lt;RegEx&gt; folgt der eines <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html#sum" target="_blank">Java-Patterns</a>. Falls die Funktion &lt;Argument&gt; einen Fehler liefert, liefert MATCH einen Fehler. F&#xFC;r &lt;Argument&gt; kann eine beliebige Funktion verwendet werden. F&#xFC;r &lt;RegEx&gt; darf nur eine Funktion verwendet werden, die zum Zeitpunkt der Funktionsdefinition bereits auswertbar ist, d.h. eine Funktion die keine Parameter aus dem Kontext (z.B. Werte von Formularfeldern) ben&#xF6;tigt. Normalerweise sollten f&#xFC;r &lt;RegEx&gt; nur einfache Strings verwendet werden.</p>
<pre><code>Funktionen(
  IstZahl(MATCH(VALUE(&apos;Argument&apos;), &quot;[0-9]+&quot;))
  IstHerr(MATCH(VALUE(&apos;Anrede&apos;), &quot;Herrn?&quot;))
)
</code></pre><blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> F&#xFC;r den einfachen Vergleich zweier Strings auf Gleichheit sollte die MATCH-Funktion nicht verwendet werden, da es hier leicht zu Fehlern kommen kann, wenn im zweiten Argument Zeichen verwendet werden, die in regul&#xE4;ren Ausdr&#xFC;cken eine besondere Bedeutung haben. F&#xFC;r den einfachen Vergleich zweier Strings steht die Funktion STRCMP zur Verf&#xFC;gung.</p>
</blockquote>
<h4 id="replace-argument-regex-repstr">REPLACE (&lt;Argument&gt;, &lt;RegEx&gt;, &lt;RepStr&gt;)</h4>
<p>Die Funktion REPLACE ersetzt alle Vorkommen von &lt;RegEx&gt; in &lt;Argument&gt; durch &lt;RepStr&gt;. Die Syntax von &lt;RegEx&gt; folgt der eines <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html#sum" target="_blank">Java-Patterns</a>. Die Syntax von &lt;RepStr&gt; entspricht der <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Matcher.html#replaceAll(java.lang.String" target="_blank">Java-Funktion replaceAll()</a>).</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Die Zeichen $ und \ haben in &lt;RepStr&gt; spezielle Bedeutung!</p>
</blockquote>
<p>Falls die Funktion &lt;Argument&gt; oder die Funktion &lt;RepStr&gt; einen Fehler liefert, liefert REPLACE einen Fehler. F&#xFC;r &lt;Argument&gt; kann  eine beliebige Funktion verwendet werden. F&#xFC;r &lt;RegEx&gt; darf nur eine Funktion verwendet werden, die zum Zeitpunkt der Funktionsdefinition bereits auswertbar ist, d.h. eine Funktion die keine Parameter aus dem Kontext (z.B. Werte von Formularfeldern) ben&#xF6;tigt. Normalerweise sollten f&#xFC;r &lt;RegEx&gt; nur einfache Strings verwendet werden.</p>
<pre><code>Funktionen(
  WhitespaceToSpace(REPLACE(VALUE(&apos;Argument&apos;), &quot;\p{Space}&quot;, &quot; &quot;))
)
</code></pre><h4 id="split-argument-regex-index">SPLIT (&lt;Argument&gt;, &lt;RegEx&gt;, &lt;Index&gt;)</h4>
<p>Die Funktion SPLIT sucht im String &lt;Argument&gt; nach Vorkommen von &lt;RegEx&gt;, teilt den String an diesen Stellen in durchnummerierte Einzelteile auf (die den durch &lt;RegEx&gt; gefundenen Ausdruck nicht enthalten) und liefert den Einzelteil mit der Nummer &lt;Index&gt; zur&#xFC;ck.  die Syntax von &lt;RegEx&gt; folgt der eines <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html#sum" target="_blank">Java-Patterns</a>. Der Index &lt;Index&gt; muss eine nicht negative ganze Zahl sein und startet ab dem Wert &quot;0&quot; f&#xFC;r das erste ermittelte Einzelteil. Ist der Index gr&#xF6;&#xDF;er als die Anzahl der ermittelten Einzelteile, so gibt die Funktion den Leerstring zur&#xFC;ck.</p>
<p>Falls die Funktion &lt;Argument&gt; einen Fehler liefert, liefert SPLIT einen Fehler. F&#xFC;r &lt;Argument&gt; kann eine beliebige Funktion verwendet werden. F&#xFC;r &lt;RegEx&gt; darf nur eine Funktion verwendet werden, die zum Zeitpunkt der Funktionsdefinition bereits auswertbar ist, d.h. eine Funktion die keine Parameter aus dem Kontext (z.B. Werte von Formularfeldern) ben&#xF6;tigt. Normalerweise sollten f&#xFC;r &lt;RegEx&gt; nur einfache Strings verwendet werden.</p>
<p>SPLIT l&#xE4;sst sich beispielsweise verwenden, um Leerzeilen aus der Anschrift im Empf&#xE4;ngerfeld zu entfernen (man beachte die doppelten Zeilenvorsch&#xFC;be &apos;%n&apos; nach &quot;M&#xFC;ller&quot;):</p>
<p><code>SPLIT(&quot;Herr M&#xFC;ller%n%nPostweg 32%n80331 M&#xFC;nchen&quot;, &quot;\n+&quot;, &quot;0&quot;) --&gt; &quot;Herr M&#xFC;ller&quot;</code></p>
<p><code>SPLIT(&quot;Herr M&#xFC;ller%n%nPostweg 32%n80331 M&#xFC;nchen&quot;, &quot;\n+&quot;, &quot;1&quot;) --&gt; &quot;Postweg 32&quot;</code></p>
<p><code>SPLIT(&quot;Herr M&#xFC;ller%n%nPostweg 32%n80331 M&#xFC;nchen&quot;, &quot;\n+&quot;, &quot;2&quot;) --&gt; &quot;80331 M&#xFC;nchen&quot;</code></p>
<p><code>SPLIT(&quot;Herr M&#xFC;ller%n%nPostweg 32%n80331 M&#xFC;nchen&quot;, &quot;\n+&quot;, &quot;3&quot;) --&gt; &quot;&quot;</code></p>
<h4 id="cat-argument1--argumentn">CAT (&lt;Argument1&gt; ... &lt;ArgumentN&gt;)</h4>
<p>Die Funktion CAT erwartet ein oder mehrere Argumente. Diese werden alle
ausgewertet und zu einem langen String verkettet. Alle Argumente k&#xF6;nnen
beliebige Funktionen sein. Falls eine der Funktionen einen Fehler
liefert liefert CAT einen Fehler.</p>
<p>Tip: CAT l&#xE4;sst sich gut mit IF kombinieren.</p>
<pre><code>CAT(
  &quot;Sehr geehrte&quot;
  IF(MATCH(VALUE(&quot;Anrede&quot;), &quot;Herr&quot;) THEN &quot;r&quot; )
  VALUE(&quot;Anrede&quot;)
  IF(NOT(MATCH(VALUE(&quot;Anrede&quot;), &quot;Damen und Herren&quot;)) THEN(VALUE(&quot;Nachname&quot;)) )
)
</code></pre><h4 id="formatargument-min-minstellen-max-maxstellen">FORMAT(&lt;Argument&gt; MIN &quot;&lt;MinStellen&gt;&quot; MAX &quot;&lt;MaxStellen&gt;&quot;)</h4>
<p>Die Funktion FORMAT wertet &lt;Argument&gt; aus und interpretiert den R&#xFC;ckgabewert als Zahl. Falls diese Zahl mehr als &lt;MaxStellen&gt; Nachkommastellen hat, so wird sie auf diese Zahl von Nachkommastellen gerundet. Falls die Zahl weniger als &lt;MinStellen&gt; Nachkommastellen hat, so wird sie mit 0ern auf die entsprechende Zahl von Nachkommastellen aufgef&#xFC;llt.</p>
<p>&lt;Argument&gt; kann eine beliebige Funktion sein. F&#xFC;r &lt;MinStellen&gt; und &lt;MaxStellen&gt; sind nur String-Literale zul&#xE4;ssig. &lt;MinStellen&gt; und &lt;MaxStellen&gt; sind beide optional. Default-Wert f&#xFC;r &lt;MinStellen&gt; ist 0, f&#xFC;r &lt;MaxStellen&gt; 1024.</p>
<p>Falls bei der Auswertung ein Fehler auftritt oder &lt;Argument&gt; keine legale Zahl zur&#xFC;ckliefert, dann liefert FORMAT einen Fehler.</p>
<blockquote class="clearfix alert alert-success"><strong class="fa fa-2x fa-lightbulb-o"></strong>
<p> Als Dezimaltrennzeichen wird nur das zu den aktuellen Spracheinstellungen passende akzeptiert. Ist LibreOffice auf &quot;Deutsch&quot; eingestellt, so ist dies das Komma, im Falle von Englisch der Punkt.</p>
</blockquote>
<!-- -->
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Die Funktion FORMAT verh&#xE4;lt sich identisch zu DIVIDE und erlaubt im Prinzip auch die Angabe eines Divisors mit BY. Im Sinne der Klarheit sollte sie jedoch nicht so verwendet werden.</p>
</blockquote>
<h3 id="arithmetik">Arithmetik</h3>
<ul>
<li>F&#xFC;r alle arithmetischen Funktionen gilt, dass als Dezimaltrennzeichen nur das zu den aktuellen Spracheinstellungen passende akzeptiert wird. Ist LibreOffice auf &quot;Deutsch&quot; eingestellt, so ist dies das Komma, im Falle von &quot;Englisch&quot; der Punkt. Die Ausgabe der arithmetischen Funktionen erfolgt ebenfalls immer mit dem entsprechenden Dezimaltrennzeichen.</li>
<li>Der Zahlenbereich der Funktionen ist nicht beschr&#xE4;nkt. Sie k&#xF6;nnen beliebig gro&#xDF;e und beliebig kleine Zahlen verarbeiten.</li>
<li>Mit Ausnahme der Funktion DIVIDE liefern alle arithmetischen Funktionen immer ein exaktes Ergebnis ohne Rundungsfehler. Bei DIVIDE muss zwingend angegeben werden, auf wieviele Stellen genau das Ergebnis berechnet werden soll.</li>
<li>Das Ergebnis der arithmetischen Funktionen wird immer mit der minimal erforderlichen Anzahl an Nachkommastellen zur&#xFC;ckgeliefert (z.B. SUM(&quot;1.00&quot;, &quot;1.0000&quot;) = &quot;2&quot;). Ausnahme ist die Funktion DIVIDE, bei der man optional eine minimale Anzahl an Nachkommastellen angeben kann. F&#xFC;r alle anderen Funktionen l&#xE4;sst sich die Darstellung mit der Funktion FORMAT anpassen.</li>
</ul>
<h4 id="sum-argument1--argumentn">SUM (&lt;Argument1&gt; ... &lt;ArgumentN&gt;)</h4>
<p>Die Funktion SUM wertet alle Argumente aus, interpretiert die Ergebnisse als Zahlen, bildet daraus die Summe und liefert diese zur&#xFC;ck. Als Argumente sind beliebige Funktionen zul&#xE4;ssig. Falls eine der Funktionen einen Fehler oder keine legale Zahl liefert, so liefert SUM einen Fehler.</p>
<h4 id="minus-argument1--argumentn">MINUS (&lt;Argument1&gt; ... &lt;ArgumentN&gt;)</h4>
<p>Die Funktion MINUS wertet alle Argumente aus, interpretiert die Ergebnisse als Zahlen, bildet daraus die Summe und liefert diese <em>mit umgekehrtem Vorzeichen</em> zur&#xFC;ck (Beispiel: MINUS(&quot;1&quot;, &quot;3&quot;) = &quot;-4&quot;). Als Argumente sind beliebige Funktionen zul&#xE4;ssig. Falls eine der Funktionen einen Fehler oder keine legale Zahl liefert, so liefert MINUS einen Fehler.</p>
<h4 id="diff-argument1--argumentn">DIFF (&lt;Argument1&gt; ... &lt;ArgumentN&gt;)</h4>
<p>Die Funktion DIFF wertet alle Argumente aus und interpretiert die Ergebnisse als Zahlen. Zur Berechnung des Ergebnisses wird das erste Argument genommen und davon werden alle weiteren Argumente subtrahiert. Falls nur 2 Argumente angegeben sind, entspricht das Ergebnis also der Differenz der beiden. Es m&#xFC;ssen mindestens 2 Argumente angegeben werden. Als Argumente sind beliebige Funktionen zul&#xE4;ssig. Falls eine der Funktionen einen Fehler oder keine legale Zahl liefert, so liefert DIFF einen Fehler.</p>
<h4 id="product-argument1--argumentn">PRODUCT (&lt;Argument1&gt; ... &lt;ArgumentN&gt;)</h4>
<p>Die Funktion PRODUCT wertet alle Argumente aus, interpretiert die Ergebnisse als Zahlen, bildet daraus das Produkt und liefert dieses zur&#xFC;ck. Als Argumente sind beliebige Funktionen zul&#xE4;ssig. Falls eine der Funktionen einen Fehler oder keine legale Zahl liefert, so liefert PRODUCT einen Fehler.</p>
<h4 id="dividedividend-bydivisor-min-minstellen-max-maxstellen">DIVIDE(&lt;Dividend&gt; BY(&lt;Divisor&gt;) MIN &quot;&lt;MinStellen&gt;&quot; MAX &quot;&lt;MaxStellen&gt;&quot;)</h4>
<p>Die Funktion DIVIDE wertet &lt;Dividend&gt; und &lt;Divisor&gt; aus und interpretiert die R&#xFC;ckgabewerte als Zahlen. Dann berechnet sie den Quotient Dividend/Divisor und liefert diesen zur&#xFC;ck. Da bei einer Division unendliche Dezimalbr&#xFC;che m&#xF6;glich sind, ist die Angabe &lt;MaxStellen&gt; zwingend erforderlich, um die maximale Anzahl an Nachkommastellen anzugeben, auf die das Ergebnis gerundet werden soll. Optional ist auch die Angabe &lt;MinStellen&gt; m&#xF6;glich und falls der Quotient weniger als &lt;MinStellen&gt; Nachkommastellen hat, so wird er mit 0ern auf die entsprechende Zahl von Nachkommastellen aufgef&#xFC;llt.\ &lt;Dividend&gt; und &lt;Divisor&gt; k&#xF6;nnen beliebige Funktionen sein, jedoch darf der Divisor nicht 0 ergeben. F&#xFC;r &lt;MinStellen&gt; und &lt;MaxStellen&gt; sind nur String-Literale zul&#xE4;ssig. Wird &lt;MinStellen&gt; weggelassen, so wird 0 angenommen.</p>
<p>Falls bei der Auswertung von &lt;Dividend&gt; oder &lt;Divisor&gt; ein Fehler auftritt oder der Divisor 0 ist, dann liefert DIVIDE einen Fehler.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Die Funktion DIVIDE verh&#xE4;lt sich identisch zu FORMAT. Im Prinzip kann auch die Angabe des Divisors weggelassen werden. Es wird dann 1 angenommen und die Angabe MAX ist dann optional. Im Sinne der Klarheit ist davon jedoch abzuraten.</p>
</blockquote>
<h4 id="abs-argument1--argumentn">ABS (&lt;Argument1&gt; ... &lt;ArgumentN&gt;)</h4>
<p>Die Funktion ABS wertet alle Argumente aus, interpretiert die Ergebnisse als Zahlen, bildet daraus die Summe und liefert den absoluten Betrag derselben zur&#xFC;ck. Als Argumente sind beliebige Funktionen zul&#xE4;ssig. Falls eine der Funktionen einen Fehler oder keine legale Zahl liefert, so liefert ABS einen Fehler.</p>
<h4 id="sign-argument1--argumentn">SIGN (&lt;Argument1&gt; ... &lt;ArgumentN&gt;)</h4>
<p>Die Funktion SIGN wertet alle Argumente aus, interpretiert die Ergebnisse als Zahlen, bildet daraus die Summe und liefert -1, 0 oder +1 zur&#xFC;ck, je nachdem ob die Summe negativ, 0 oder positiv ist. Als Argumente sind beliebige Funktionen zul&#xE4;ssig. Falls eine der Funktionen einen Fehler oder keine legale Zahl liefert, so liefert SIGN einen Fehler.</p>
<h3 id="vergleiche">Vergleiche</h3>
<h4 id="iserror-funktion">ISERROR (&lt;Funktion&gt;)</h4>
<p>Die Funktion ISERROR wertet &lt;Funktion&gt; aus und liefert &quot;true&quot; genau dann, wenn &lt;Funktion&gt; einen Fehler zur&#xFC;ckliefert. Ansonsten liefert ISERROR &quot;false&quot; zur&#xFC;ck. Zu beachten ist, dass ISERROR <em>nicht</em> einfach nur mit dem speziellen Fehlerstring vergleicht, den Funktionen im Fehlerfall zur&#xFC;ckliefern (Zum Zeitpunkt der Erstellung dieser Dokumentation ist dies der String &quot;!&#xA4;&#xA3;!FEHLERHAFTE DATEN!&#xA4;&#xA3;!&quot;). ISERROR wertet stattdessen den internen Fehlerzustand von &lt;Funktion&gt; aus und kann so unterscheiden zwischen einem wirklichen Fehler und dem absichtlichen Zur&#xFC;ckliefern des Fehlerstrings.</p>
<p>ISERROR(&quot;!&#xA4;&#xA3;!FEHLERHAFTE DATEN!&#xA4;&#xA3;!&quot;) liefert also &quot;false&quot; zur&#xFC;ck, ISERROR(SUM(&quot;keineZahl&quot;)) dagegen &quot;true&quot;, obwohl der von SUM(&quot;keineZahl&quot;) zur&#xFC;ckgelieferte String identisch zu &quot;!&#xA4;&#xA3;!FEHLERHAFTE DATEN!&#xA4;&#xA3;!&quot; ist.</p>
<p>Im Gegensatz zu ISERROR steht die Funktion ISERRORSTRING (siehe n&#xE4;chster Abschnitt), die nur den Vergleich mit dem Fehlerstring durchf&#xFC;hrt. Wannimmer m&#xF6;glich sollte ISERROR anstatt ISERRORSTRING verwendet werden. Wenn der zu testende Wert jedoch indirekt, z.B. aus einem durch eine andere Funktion berechneten Formularfeld stammt, dann kann ISERROR nicht verwendet werden. Z.B. liefert der Test ISERROR(VALUE &quot;formularfeld&quot;) in den meisten F&#xE4;llen nicht das gew&#xFC;nschte Ergebnis. Er pr&#xFC;ft n&#xE4;mlich nicht, ob im Formularfeld ein (durch eine andere Funktion berechneter) Fehlerwert steht. Stattdessen liefert dieser Aufruf nur dann &quot;true&quot;, wenn das Formularfeld mit der ID &quot;formularfeld&quot; gar nicht existiert, weil nur dann die VALUE-Funktion einen Fehler liefert.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Wenn es darum geht, im Fehlerfall einen besonderen Wert zur&#xFC;ckzuliefern, ist SELECT mit einem ONERROR-Zweig meist g&#xFC;nstiger als direkte Tests mit ISERROR oder ISERRORSTRING.</p>
</blockquote>
<h4 id="iserrorstring-funktion">ISERRORSTRING (&lt;Funktion&gt;)</h4>
<p>ISERRORSTRING wertet &lt;Funktion&gt; aus und vergleicht den R&#xFC;ckgabewert mit dem speziellen Fehlerstring, den Funktionen im Fehlerfall zur&#xFC;ckgeben. Dieser ist zum Zeitpunkt der Erstellung dieser Dokumentation &quot;!&#xA4;&#xA3;!FEHLERHAFTE DATEN!&#xA4;&#xA3;!&quot;. Er kann sich jedoch jederzeit &#xE4;ndern (und hat sich in der Vergangenheit auch bereits ge&#xE4;ndert). Deswegen darf er nicht direkt f&#xFC;r Vergleiche mit MATCH oder STRCMP herangezogen werden, sondern Gleichheit mit dem Fehlerstring darf nur &#xFC;ber ISERRORSTRING gepr&#xFC;ft werden.</p>
<p>Der Fehlerstring ist so gew&#xE4;hlt, dass er im normalen Betrieb nicht auftreten kann, allerdings k&#xF6;nnen Spa&#xDF;v&#xF6;gel unter den Benutzern den String direkt eingeben. Um einen echten Fehler von einem eingegebenen Fehlerstring unterscheiden zu k&#xF6;nnen existiert die Funktion ISERROR, die direkt den Fehlerzustand von &lt;Funktion&gt; auswertet. Wenn m&#xF6;glich sollte diese Funktion verwendet werden.</p>
<blockquote class="clearfix alert alert-success"><strong class="fa fa-2x fa-lightbulb-o"></strong>
<p> Wenn es darum geht, im Fehlerfall einen besonderen Wert zur&#xFC;ckzuliefern, ist SELECT mit einem ONERROR-Zweig meist g&#xFC;nstiger als direkte Tests mit ISERROR oder ISERRORSTRING.</p>
</blockquote>
<h4 id="strcmp-argument1--argumentn">STRCMP (&lt;Argument1&gt; ... &lt;ArgumentN&gt;)</h4>
<p>Es m&#xFC;ssen mindestens 2 Argumente angegeben werden. Als Argumente sind beliebige Funktionen zul&#xE4;ssig. Die Funktion STRCMP wertet ihre Argumente der Reihe nach aus und f&#xFC;hrt f&#xFC;r die Argumente 2 bis N einen Vergleich mit dem ersten Argument durch. Bei jedem Vergleich kann eines der folgenden 3 Ergebnisse herauskommen: &quot;Die Strings sind identisch&quot;, &quot;Der erste String kommt in einer alphabetischen Sortierung vor dem zweiten&quot;, &quot;Der zweite String kommt alphabetisch vor dem ersten&quot;. Der Vergleich basiert auf der Reihenfolge der Zeichen im Unicode-Zeichensatz, d.h. insbes. werden Kleinbuchstaben und Gro&#xDF;buchstaben als unterschiedliche Zeichen aufgefasst. Die Funktion STRCMP kann folgende 5 Ergebnisse zur&#xFC;ckliefern, wobei in einem booleschen Kontext, wie in einer IF-Bedingung, alle nicht-true Ergebnisse false entsprechen:</p>
<p> &quot;true&quot;: Alle Strings sind identisch. Beispiel: <code>STRCMP(&quot;a&quot; &quot;a&quot; &quot;a&quot;)</code></p>
<ul>
<li><p>&quot;-1&quot;: Mindestens eines der Argumente 2 bis N ist verschieden von Argument1 und kommt alphabetisch <em>nach</em> Argument1. Alle anderen Argumente kommen entweder auch alphabetisch <em>nach</em> Argument1 oder sie sind identisch zu Argument1.</p>
<p>Beispiel: <code>STRCMP(&quot;a&quot; &quot;a&quot; &quot;z&quot;)</code></p>
</li>
<li><p>&quot;1&quot;: Mindestens eines der Argumente 2 bis N ist verschieden von Argument1 und kommt alphabetisch <em>vor</em> Argument1. Alle anderen Argumente kommen entweder auch alphabetisch <em>vor</em> Argument1 oder sie sind identisch zu Argument1.</p>
<p>Beispiel: <code>STRCMP(&quot;z&quot; &quot;a&quot; &quot;z&quot;)</code></p>
</li>
<li><p>&quot;0&quot;: Mindestens zwei der Argumente 2 bis N sind verschieden von Argument1 und eines davon kommt alphabetisch <em>nach</em> Argument1 w&#xE4;hrend das andere alphabetisch <em>vor</em> Argument1 kommt.</p>
<p>Beispiel: <code>STRCMP(&quot;m&quot; &quot;a&quot; &quot;z&quot;)</code></p>
</li>
<li><p>Fehler: Falls eine der ausgewerteten Funktionen einen Fehler liefert, so liefert STRCMP einen Fehler. &apos;&apos;&apos;Achtung: &apos;&apos;&apos; STRCMP wendet das Kurzschlussverfahren an, d.h. es wertet nur soviele Argumente aus wie notwendig. Wenn z.B. Argument2 alphabetisch vor Argument1 kommt und Argument3 alphabetisch danach, dann kann das Ergebnis nur &quot;0&quot; lauten und die Argumente 3 bis N werden gar nicht mehr ausgewertet. Eventuelle Fehler, die bei der Auswertung dieser Argumente auftreten w&#xFC;rden, werden nicht erkannt.</p>
<p>Beispiel: <code>STRCMP(&quot;m&quot;,&quot;a&quot;,SUM(&quot;keineZahl&quot;),&quot;z&quot;) = Fehler!</code>, aber <code>STRCMP(&quot;m&quot; &quot;a&quot; &quot;z&quot; SUM(&quot;keineZahl&quot;)) = &quot;0&quot;</code></p>
</li>
</ul>
<h4 id="numcmp-argument1--argumentn-margin-maxabweichung-">NUMCMP (&lt;Argument1&gt; ... &lt;ArgumentN&gt; MARGIN &quot;&lt;MaxAbweichung&gt;&quot; )</h4>
<p>Es m&#xFC;ssen mindestens 2 Argumente angegeben werden. Die Angabe einer MARGIN ist optional. Als Argumente und MARGIN sind beliebige Funktionen zul&#xE4;ssig. Die Funktion NUMCMP wertet zuerst (falls angegeben) die MARGIN-Funktion aus und interpretiert den R&#xFC;ckgabewert als Zahl und nimmt davon den Absolutbetrag. Danach werden die Argumente der Reihe nach ausgewertet und die R&#xFC;ckgabewerte als Zahlen interpretiert. F&#xFC;r die Argumente 2 bis N f&#xFC;hrt NUMCMP einen Vergleich mit dem ersten Argument durch. Falls MARGIN angegeben ist, so werden die Zahlen als numerisch gleich behandelt, wenn ihre Differenz kleiner oder gleich &lt;MaxAbweichung&gt; ist. Die Funktion NUMCMP kann folgende 5 Ergebnisse zur&#xFC;ckliefern, wobei in einem booleschen Kontext, wie in einer IF-Bedingung, alle nicht-true Ergebnisse false entsprechen:</p>
<ul>
<li><p>&quot;true&quot;: Alle Werte sind numerisch gleich.</p>
<p>Beispiel 1: <code>NUMCMP(&quot;1&quot; &quot;1,0&quot; &quot;1,000&quot;)</code></p>
<p>Beispiel 2: <code>NUMCMP(&quot;1&quot; &quot;1,1&quot; &quot;0,9&quot; MARGIN &quot;0,1&quot;)</code></p>
</li>
<li><p>&quot;-1&quot;: Mindestens eines der Argumente 2 bis N ist numerisch echt gr&#xF6;&#xDF;er als Argument1. Alle anderen Argumente sind gr&#xF6;&#xDF;er oder gleich Argument1.</p>
<p>Beispiel 1: <code>NUMCMP(&quot;1&quot; &quot;1,0&quot; &quot;2&quot;)</code></p>
<p>Beispiel 2: <code>NUMCMP(&quot;1&quot; &quot;0,9&quot; &quot;2&quot; MARGIN &quot;0,1&quot;)</code></p>
</li>
<li><p>&quot;1&quot;: Mindestens eines der Argumente 2 bis N ist numerisch echt kleiner als Argument1. Alle anderen Argumente sind kleiner oder gleich Argument1.</p>
<p>Beispiel: <code>NUMCMP(&quot;2,0&quot; &quot;1&quot; &quot;2&quot;)</code></p>
</li>
<li><p>&quot;0&quot;: Mindestens eines der Argumente 2 bis N ist numerisch echt gr&#xF6;&#xDF;er als Argument1 und mindestens eines der Argumente ist numerisch echt kleiner als Argument1.</p>
<p>Beispiel: <code>NUMCMP(&quot;2&quot; &quot;1&quot; &quot;3&quot;)</code></p>
</li>
<li><p>Fehler: Falls eine der ausgewerteten Funktionen einen Fehler liefert oder das Ergebnis keine legale Zahl darstellt, so liefert NUMCMP einen Fehler.</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> NUMCMP wendet das Kurzschlussverfahren an, d.h. es wertet nur soviele Argumente aus wie notwendig. Wenn z.B. Argument2 echt kleiner als Argument1 ist und Argument3 echt gr&#xF6;&#xDF;er, dann kann das Ergebnis nur &quot;0&quot; lauten und die Argumente 4 bis N werden gar nicht mehr ausgewertet. Eventuelle Fehler, die bei der Auswertung dieser Argumente auftreten w&#xFC;rden, werden nicht erkannt.</p>
</blockquote>
<p>Beispiel: <code>NUMCMP(&quot;2&quot;,&quot;1&quot;,SUM(&quot;keineZahl&quot;),&quot;3&quot;) = Fehler!</code>, aber <code>NUMCMP(&quot;2&quot; &quot;1&quot; &quot;3&quot; SUM(&quot;keineZahl&quot;)) = &quot;0&quot;</code></p>
</li>
</ul>
<h4 id="lt-argument1--argumentn-margin-maxabweichung-">LT (&lt;Argument1&gt; ... &lt;ArgumentN&gt; MARGIN &quot;&lt;MaxAbweichung&gt;&quot; )</h4>
<p>Es m&#xFC;ssen mindestens 2 Argumente angegeben werden. Die Angabe einer MARGIN ist optional. Als Argumente und MARGIN sind beliebige Funktionen zul&#xE4;ssig. Die Funktion LT wertet zuerst (falls angegeben) die MARGIN-Funktion aus und interpretiert den R&#xFC;ckgabewert als Zahl und nimmt davon den Absolutbetrag. Danach werden die Argumente der Reihe nach ausgewertet und die R&#xFC;ckgabewerte als Zahlen interpretiert. F&#xFC;r die Argumente 2 bis N f&#xFC;hrt LT einen Vergleich mit dem ersten Argument durch. LT liefert &quot;true&quot;, wenn Argument1 numerisch echt kleiner ist als die Argumente 2 bis N, ansonsten &quot;false&quot;. Falls MARGIN angegeben ist, so werden die Zahlen als numerisch gleich behandelt, wenn ihre Differenz kleiner oder gleich &lt;MaxAbweichung&gt; ist.</p>
<p>Beispiel 1: <code>LT(&quot;1&quot; &quot;2&quot; &quot;3&quot;) = &quot;true&quot;</code></p>
<p>Beispiel 2: <code>LT(&quot;1&quot; &quot;2&quot; &quot;3&quot; MARGIN &quot;1&quot;) = &quot;false&quot;</code></p>
<ul>
<li><p>Fehler: Falls eine der ausgewerteten Funktionen einen Fehler liefert oder das Ergebnis keine legale Zahl darstellt, so liefert LT einen Fehler.</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> LT wendet das Kurzschlussverfahren an, d.h. es wertet nur soviele Argumente aus wie notwendig. Wenn z.B. Argument2 kleiner Argument1 ist, dann kann das Ergebnis nur &quot;false&quot; lauten und und die Argumente 3 bis N werden gar nicht mehr ausgewertet. Eventuelle Fehler, die bei der Auswertung dieser Argumente auftreten w&#xFC;rden, werden nicht erkannt.</p>
</blockquote>
<p>Beispiel: <code>LT(&quot;2&quot;,SUM(&quot;keineZahl&quot;),&quot;1&quot;) = Fehler!</code>, aber <code>LT(&quot;2&quot; &quot;1&quot; SUM(&quot;keineZahl&quot;)) = &quot;false&quot;</code></p>
</li>
</ul>
<h4 id="le-argument1--argumentn-margin-maxabweichung-">LE (&lt;Argument1&gt; ... &lt;ArgumentN&gt; MARGIN &quot;&lt;MaxAbweichung&gt;&quot; )</h4>
<p>Wie LT, aber es wird &quot;true&quot; geliefert, wenn Argument1 numerisch kleiner oder gleich Argument2 bis ArgumentN ist.</p>
<h4 id="gt-argument1--argumentn-margin-maxabweichung-">GT (&lt;Argument1&gt; ... &lt;ArgumentN&gt; MARGIN &quot;&lt;MaxAbweichung&gt;&quot; )</h4>
<p>Wie LT, aber es wird &quot;true&quot; geliefert, wenn Argument1 numerisch echt gr&#xF6;&#xDF;er Argument2 bis ArgumentN ist.</p>
<h4 id="ge-argument1--argumentn-margin-maxabweichung-">GE (&lt;Argument1&gt; ... &lt;ArgumentN&gt; MARGIN &quot;&lt;MaxAbweichung&gt;&quot; )</h4>
<p>Wie LT, aber es wird &quot;true&quot; geliefert, wenn Argument1 numerisch gr&#xF6;&#xDF;er oder gleich Argument2 bis ArgumentN ist.</p>
<h3 id="logische-verkn&#xFC;pfungen">Logische Verkn&#xFC;pfungen</h3>
<h4 id="and-funktion1--funktionn">AND (&lt;Funktion1&gt; ... &lt;FunktionN&gt;)</h4>
<p>Die Funktion AND wertet &lt;Funktion1&gt; bis &lt;FunktionN&gt; der Reihe nach aus und liefert &quot;true&quot;, falls alle Funktionen &quot;true&quot; liefern, ansonsten &quot;false&quot;. Die Auswertung erfolgt nach dem Kurzschlussverfahren, d.h. wenn eine der Funktionen nicht &quot;true&quot; liefert, werden die folgenden Funktionen nicht mehr ausgewertet. Liefert eine der ausgewerteten Funktionen einen Fehler, so liefert AND einen Fehler und die folgenden Funktionen werden nicht mehr ausgewertet.</p>
<h4 id="or-funktion1--funktionn">OR (&lt;Funktion1&gt; ... &lt;FunktionN&gt;)</h4>
<p>Die Funktion OR wertet &lt;Funktion1&gt; bis &lt;FunktionN&gt; der Reihe nach aus und liefert &quot;true&quot;, falls eine der Funktionen &quot;true&quot; liefert, ansonsten &quot;false&quot;. Die Auswertung erfolgt nach dem Kurzschlussverfahren, d.h. wenn eine der Funktionen &quot;true&quot; liefert, werden die folgenden Funktionen nicht mehr ausgewertet. Liefert eine der ausgewerteten Funktionen einen Fehler, so liefert OR einen Fehler und die folgenden Funktionen werden nicht mehr ausgewertet.</p>
<h4 id="not-funktion1--funktionn">NOT (&lt;Funktion1&gt; ... &lt;FunktionN&gt;)</h4>
<p>Die Funktion NOT wertet &lt;Funktion1&gt; bis &lt;FunktionN&gt; der Reihe nach aus und liefert &quot;true&quot;, falls eine der Funktionen <em>nicht</em> &quot;true&quot; liefert, ansonsten &quot;false&quot;. Die Auswertung erfolgt nach dem Kurzschlussverfahren, d.h. wenn eine der Funktionen nicht &quot;true&quot; liefert, werden die folgenden Funktionen nicht mehr ausgewertet. Anders ausgedr&#xFC;ckt: NOT (&lt;Funktion1&gt; ... &lt;FunktionN&gt;) liefert dann &quot;true&quot;, wenn AND (&lt;Funktion1&gt; ... &lt;FunktionN&gt;) &quot;false&quot; liefern w&#xFC;rde. Liefert eine der ausgewerteten Funktionen einen Fehler, so liefert NOT einen Fehler und die folgenden Funktionen werden nicht mehr ausgewertet.</p>
<h3 id="ablaufsteuerungkontrollfluss">Ablaufsteuerung/Kontrollfluss</h3>
<h4 id="if-bedingung-then-dann-else-sonst-">IF (&lt;Bedingung&gt; THEN &lt;Dann&gt; ELSE &lt;Sonst&gt; )</h4>
<p>Die Funktion IF wertet die &lt;Bedingung&gt; aus. Falls diese &quot;true&quot; ist, so wird der Wert der Funktion &lt;Dann&gt; zur&#xFC;ckgeliefert, ansonsten der Wert der Funktion &lt;Sonst&gt;. Sowohl der &quot;THEN &lt;Dann&gt;&quot; als auch der &quot;ELSE &lt;Sonst&gt;&quot; Teil sind optional. Falls ein Teil fehlt, so wird der leere String daf&#xFC;r angenommen. &lt;Bedingung&gt;, &lt;Dann&gt; und &lt;Sonst&gt; k&#xF6;nnen beliebige Funktionen sein. Falls &lt;Bedingung&gt; einen Fehler liefert, so liefert IF einen Fehler, ohne &lt;Dann&gt; oder &lt;Sonst&gt; auszuf&#xFC;hren.</p>
<h4 id="then-argument">THEN &quot;&lt;Argument&gt;&quot;</h4>
<p>Die Funktion THEN verh&#xE4;lt sich genau wie die Funktion CAT. Sie sollte jedoch um Verwirrung zu vermeiden nur zusammen mit IF verwendet werden.</p>
<h4 id="else-argument">ELSE &quot;&lt;Argument&gt;&quot;</h4>
<p>Die Funktion ELSE verh&#xE4;lt sich genau wie die Funktion CAT. Sie sollte jedoch um Verwirrung zu vermeiden nur zusammen mit IF oder SELECT verwendet werden (und innerhalb von SELECT nur als letzte Funktion).</p>
<h4 id="select-funktion1--funktionn">SELECT (&lt;Funktion1&gt; ... &lt;FunktionN&gt;)</h4>
<p>Die Funktion SELECT wertet &lt;Funktion1&gt; bis &lt;FunktionN&gt; der Reihe nach aus. Liefert eine Funktion den leeren String, so wird die Auswertung mit der n&#xE4;chsten Funktion fortgesetzt. Sobald eine der Funktionen einen nicht-leeren Nicht-Fehler-String liefert, wird die Auswertung abgebrochen und dieser wird das Ergebnis von SELECT. Typischerweise wird SELECT zusammen mit IF verwendet und erh&#xE4;lt als letzte Funktion eine ELSE Funktion und/oder eine ONERROR Funktion.</p>
<pre><code>SELECT(
  IF( &lt;Bedingung1&gt;
    THEN &lt;Ergebnis1&gt;
  )
  IF( &lt;Bedingung2&gt;
    THEN &lt;Ergebnis2&gt;
  )
  ...
  ELSE &lt;SonstWert&gt;

  ONERROR &lt;Fehlermeldung&gt;
)
</code></pre><p>Die Reaktion von SELECT auf Fehler h&#xE4;ngt davon ab, ob eine ONERROR-Funktion angegeben ist oder nicht. Gibt es ein ONERROR, so bricht SELECT beim ersten Fehler ab und liefert das Ergebnis der ONERROR-Funktion. Gibt es kein ONERROR, so wird bei Auftreten eines Fehlers mit der n&#xE4;chsten Funktion fortgefahren. Gibt es kein ONERROR und liefern <em>alle</em> Funktionen einen Fehler, liefert SELECT einen Fehler zur&#xFC;ck. Gibt es kein ONERROR und liefert mindestens eine Funktion einen leeren String und alle anderen einen Fehler, so liefert SELECT den leeren String zur&#xFC;ck. D.h. wenn man als letzte Funktion eine ELSE Funktion mit einem festen String verwendet (z.B. dem leeren String), so wird SELECT nie einen Fehler zur&#xFC;ckliefern. Die ONERROR-Funktion verh&#xE4;lt sich genau wie CAT, d.h. wenn ihr mehrere Parameter &#xFC;bergeben werden, so werden diese aneinandergeh&#xE4;ngt.</p>
<h3 id="funktionen-f&#xFC;r-formulare">Funktionen f&#xFC;r Formulare</h3>
<h4 id="value-argument">VALUE &quot;&lt;Argument&gt;&quot;</h4>
<p>Die Funktion VALUE erwartet als Argument einen Identifikator und liefert den diesem Identifikator zugewiesenen Wert zur&#xFC;ck. Welcher das ist h&#xE4;ngt vom Kontext ab. In einem Formular w&#xFC;rde die Id typischerweise ein Formularfeld bezeichnen, dessen Wert die Funktion dann zur&#xFC;ckliefern w&#xFC;rde. Als Argument kann im Prinzip eine beliebige Funktion &#xFC;bergeben werden, deren Ergebnis dann als Identifikator genommen wird. Wegen der Undurchsichtigkeit einer solchen Definition sollte davon jedoch Abstand genommen werden. Es ist normalerweise v&#xF6;llig ausreichend als &lt;Argument&gt; einen einfachen String zu verwenden. Ist f&#xFC;r die angegebene Id im entsprechenden Kontext kein Wert definiert (z.B. weil es kein Formularelement mit dieser Id gibt), so liefert VALUE einen Fehler.</p>
<pre><code>Funktionen(
  WertVonCheckbox(VALUE(&quot;CheckboxId&quot;))
)
</code></pre><h4 id="dialog-dialogname-feldname">DIALOG (&quot;&lt;Dialogname&gt;&quot;, &quot;&lt;Feldname&gt;&quot;)</h4>
<p>Die Funktion DIALOG erlaubt Zugriff auf Werte, die der Benutzer in einem speziellen Dialog ausgew&#xE4;hlt hat. Das wichtigste Beispiel hierf&#xFC;r ist der Dialog zur Auswahl des Empf&#xE4;ngers bei Formularen und Briefk&#xF6;pfen. Der Benutzer klickt hierzu den entsprechenden Button an, der den Empf&#xE4;ngerauswahl-Dialog aufruft und w&#xE4;hlt im Dialog den Empf&#xE4;nger aus.</p>
<p>Die DIALOG-Funktion liefert das durch &lt;Feldname&gt; bezeichnete Feld, das der Benutzer im Dialog &lt;Dialogname&gt; ausgew&#xE4;hlt hat. Hat der Benutzer den Dialog noch nicht aufgerufen, so wird ein Standardwert (typischerweise der leere String) geliefert. Sobald der Benutzer den Dialog einmal aufgerufen hat, wird der korrekte Wert geliefert. &lt;Dialogname&gt; muss einen Dialog bezeichnen, der im Abschnitt <a href="#funktionsdialoge">Funktionsdialoge</a> definiert wurde.</p>
<p><code>DIALOG(&apos;Empfaengerauswahl&apos;, &apos;Anrede&apos;)</code></p>
<h3 id="zugriff-auf-externe-funktionen">Zugriff auf externe Funktionen</h3>
<h4 id="extern-url-url-paramsparam1--paramn">EXTERN (URL &lt;url&gt; PARAMS(&lt;param1&gt; ... &lt;paramN&gt;))</h4>
<p>Die EXTERN-Funktion stellt eine Verbindung zu einer externen (d.h. nicht als WollMux-Funktionsdefinition vorliegenden) Funktion her. Diese kann sowohl als Methode einer Java-Klasse als auch als Basic-Makro vorliegen. Die &lt;url&gt; identifiziert die externe Funktion. Der Aufbau ist aus den folgenden Beispielen ersichtlich. Der PARAMS-Block ist optional und legt Bezeichner f&#xFC;r die Parameter der Funktion fest in der Reihenfolge in der sie &#xFC;bergeben werden m&#xFC;ssen. Die Basic- oder Java-Funktion muss ihre Parameter als Strings erwarten und entweder einen String oder einen Wahrheitswert zur&#xFC;ckliefern. Insbesondere muss es sich im Basic-Fall um eine Function handeln.</p>
<pre><code>EXTERN(URL &quot;vnd.sun.star.script:Bibliothek.Modul.NameDerFunction?language=Basic&amp;location=application&quot;
       PARAMS(&quot;Param1&quot;, &quot;Param2&quot;, &quot;Param3&quot;))

EXTERN(URL &quot;java:de.muenchen.allg.itd51.wollmux.func.Standard.zahlenBereich&quot;
       PARAMS(&quot;wert&quot;, &quot;min&quot;, &quot;max&quot;))
</code></pre><h5 id="demuenchenallgitd51wollmuxfuncstandard">de.muenchen.allg.itd51.wollmux.func.Standard</h5>
<p>Dieses Java-Modul enth&#xE4;lt einige vorgefertigte Standard-Funktionen:</p>
<ul>
<li><em>immerWahr</em>: liefert immer den Wert &quot;true&quot;</li>
<li><em>zahlenBereich(low, hi, zahl)</em>: Liefert true genau dann wenn low, hi und zahl Integer-Zahlen sind und low&lt;=zahl&lt;=hi.</li>
<li>(veraltet)<em>herrFrauText(anrede, frauText, herrText)</em>: Liefert den String herrText zur&#xFC;ck, falls lowcase(anrede) == &quot;herr&quot;, ansonsten wird frauText geliefert.</li>
<li><em>gender(herrText, frauText, sonstText, anrede)</em>: Liefert den String herrText zur&#xFC;ck, falls lowcase(anrede) == &quot;herr&quot; oder &quot;herrn&quot;. Liefert den String frauText zur&#xFC;ck falls lowcase(anrede) == &quot;frau&quot;. Ansonsten wird sonstText zur&#xFC;ckgeliefert (typischerweise verwendet f&#xFC;r den Mehrzahl-Fall &quot;Damen und Herren&quot;).</li>
<li><em>korrektesDatum(datum)</em>: Versucht, zu erkennen, ob datum ein korrektes Datum der Form Tag.Monat.Jahr ist (wobei Jahr immer 4-stellig sein muss). Liefert &quot;true&quot;, falls dies so ist.</li>
<li><em>formatiereTelefonnummerDIN5008(nummer)</em>: Formatiert die <em>stadtinterne</em> Telefonnummer nummer entsprechend der DIN 5008 und versieht sie mit der Vorwahl 089, um eine Nummer zu erhalten, die extern g&#xFC;ltig ist. Diese Funktion wurde f&#xFC;r die Verarbeitung der Telefonnummerndaten aus dem st&#xE4;dtischen LDAP konzipiert und arbeitet nicht zwangsweise mit Telefonnummern aus anderen Quellen.</li>
<li><em>formatiereTelefonnummerDIN5008Intern(nummer)</em>: Formatiert die <em>stadtinterne</em> Telefonnummer nummer entsprechend der DIN 5008 und versieht sie mit der Vorwahl 0, um eine Nummer zu erhalten, die auf jedem internen Telefon funktioniert. Diese Funktion wurde f&#xFC;r die Verarbeitung der Telefonnummerndaten aus dem st&#xE4;dtischen LDAP konzipiert und arbeitet nicht zwangsweise mit Telefonnummern aus anderen Quellen.</li>
<li><em>regex(regulaererAusdruck, eingabe)</em>: Liefert genau dann true, wenn <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/Pattern.html#sum" target="_blank">regulaererAusdruck</a> den String eingabe vollst&#xE4;ndig matcht.</li>
<li><em>datumNichtInVergangenheit(datum)</em>: Liefert genau dann true, wenn datum ein korrektes Datum der Form Monat.Tag.Jahr ist (wobei Jahr immer 4-stellig sein muss) und das Datum nicht in der Vergangenheit liegt.</li>
</ul>
<h5 id="demuenchenallgd101-plugin-der-wollmux-standard-config">de.muenchen.allg.d101 (Plugin der WollMux-Standard-Config)</h5>
<p>Im Verzeichnis plugins/de/muenchen/allg/d101 der wollmux-standard-config werden dar&#xFC;ber hinaus folgende n&#xFC;tzliche Funktionen zu Demonstrationszwecken bereitgestellt:</p>
<ul>
<li><em>ZahlInWorten(zahl)</em>: Wandelt eine Zahl(&quot;200&quot;) in nat&#xFC;rliche Sprache(&quot;zweihundert&quot;) um.</li>
</ul>
<h4 id="bind-function-funktionsname-setparamname1-wert1--setparamnamen-wertn">BIND (FUNCTION &quot;&lt;Funktionsname&gt;&quot; SET(&quot;&lt;ParamName1&gt;&quot; &lt;Wert1&gt;) ... SET(&quot;&lt;ParamNameN&gt;&quot; &lt;WertN&gt;))</h4>
<p>Die BIND-Funktion dient dazu, mehrere Funktionen zusammenzusetzen. &lt;Funktionsname&gt; identifiziert eine benannte Funktion aus dem <em>Funktionen</em>-Abschnitt. Diese Funktion bildet den Ausgangspunkt f&#xFC;r die zusammengesetzte Funktion. Dazu kommen beliebig viele (auch keine sind m&#xF6;glich) SET-Anweisungen, die Parameter der Basisfunktion mit beliebigen anderen Funktionen belegen. &lt;ParamName1&gt; bis &lt;ParamNameN&gt; sind dabei Namen von Parametern, die die Basis-Funktion erwartet. Dies ist nicht zwingend, aber Parameter zu belegen, die die Basis-Funktion nicht erwartet, hat keinen Effekt. &lt;Wert1&gt; bis &lt;WertN&gt; k&#xF6;nnen beliebige Funktionen sein. Die Arbeitsweise von BIND wird klarer, wenn man typische Anwendungsf&#xE4;lle betrachtet.</p>
<p><strong>Anwendungsfall 1</strong>: Verwenden einer externen Funktion als Plausibilit&#xE4;tspr&#xFC;fung f&#xFC;r ein Formularfeld</p>
<pre><code>Funktionen(
    # Diese Funktion liefert &quot;true&quot; wenn  min &lt;= wert &lt;= max
  ZahlenBereich(EXTERN(URL &quot;java:de.muenchen.allg.itd51.wollmux.Standard.zahlenBereich&quot;
       PARAMS(&quot;min&quot;, &quot;max&quot;, &quot;wert&quot;)))
)
</code></pre><p>Im <em>Funktionen</em>-Abschnitt ist die Funktion <em>ZahlenBereich</em> definiert, die auf eine Java-Funktion im WollMux-Modul <code>de.muenchen.allg.itd51.wollmux.Standard</code> verweist. Dieses Modul enth&#xE4;lt einige vorgefertigte Standard-Funktionen. Diese Funktion soll nun in einer Formularbeschreibung eingesetzt werden, um zu &#xFC;berpr&#xFC;fen, dass das der im Textfeld <em>DarlehensBetrag</em> eingegebene Wert zwischen 1000 und 50000 liegt. Um dies zu Realisieren m&#xFC;ssen 3 Dinge erreicht werden:</p>
<ul>
<li>Als Parameter <em>min</em> wird 1000 &#xFC;bergeben</li>
<li>Als Parameter <em>max</em> wird 50000 &#xFC;bergeben</li>
<li>Der Parameter <em>wert</em> wird an den Inhalt des Textfelds <em>DarlehensBetrag</em> gebunden.</li>
</ul>
<p>F&#xFC;r jede dieser 3 Anforderungen wird ein SET-Ausdruck einer BIND-Funktion verwendet:</p>
<p><code>BIND(FUNCTION &quot;ZahlenBereich&quot; SET(&quot;min&quot; &quot;1000&quot;) SET(&quot;max&quot; &quot;50000&quot;) SET(&quot;wert&quot; VALUE(&quot;DarlehensBetrag&quot;)))</code></p>
<p><strong>Anwendungsfall 2</strong>: Einf&#xFC;gen von &quot;der&quot; oder &quot;die&quot; abh&#xE4;ngig vom Anrede-Feld eines Formulars</p>
<pre><code>Funktionen(
  # Diese Funktion liefert TextMaennl wenn Anrede==&quot;Herr&quot;, ansonsten TextWeibl
  GenderText(EXTERN(URL &apos;java:de.muenchen.allg.itd51.wollmux.func.Standard.herrFrauText&apos; PARAMS(&apos;Anrede&apos;, &apos;TextWeibl&apos;, &apos;TextMaennl&apos;)))
)
</code></pre><p>Wie im ersten Anwendungsfall wird im <em>Funktionen</em>-Abschnitt eine Funktion definiert, die Zugriff auf eine der vordefinierten Standard-Funktionen erlaubt. In diesem Fall ist es eine Funktion die abh&#xE4;ngig vom Wert des Parameters Anrede einen Wert aus 2 Alternativen ausw&#xE4;hlt. Um nun in einem Formular &quot;der&quot; oder &quot;die&quot; einf&#xFC;gen zu lassen abh&#xE4;ngig vom Formularfeld Anrede, verwenden wir das TRAFO-Attribut der Funktion <em>insertFormValue</em>. Eine TRAFO-Funktion muss genau ein Argument erwarten (den zu transformierenden String), deshalb kann die Funktion GenderText nicht direkt als TRAFO verwendet werden. 2 der Argumente m&#xFC;ssen erst abgebunden werden, n&#xE4;mlich die beiden, die in unserem Anwendungsfall fest vorgegeben sind: die Texte &quot;der&quot; und &quot;die&quot;. Das Ergebnis sieht wie folgt aus:</p>
<pre><code>Funktionen(
  derDie(BIND(FUNCTION &apos;GenderText&apos; SET(&apos;TextWeibl&apos;,&apos;die&apos;) SET(&apos;TextMaennl&apos;,&apos;der&apos;)))
)
</code></pre><p>Und das zugeh&#xF6;rige <a href="#trafo-funktionsbezeichner">WollMux-Dokumentkommando</a></p>
<p><code>WM(CMD &apos;insertFormValue&apos; ID &apos;Anrede&apos; TRAFO &apos;derDie&apos;)</code></p>
<h4 id="bind-functionfunktion-setparamname1-wert1--setparamnamen-wertn">BIND (FUNCTION(&lt;Funktion&gt;) SET(&quot;&lt;ParamName1&gt;&quot; &lt;Wert1&gt;) ... SET(&quot;&lt;ParamNameN&gt;&quot; &lt;WertN&gt;))</h4>
<p>Wie <a href="#bind-function-funktionsname-setparamname1-wert1--setparamnamen-wertn">BIND mit Angabe eines Funktionsnames hinter FUNCTION</a>, jedoch wird hier als &lt;Funktion&gt; eine komplette WollMux-Funktion direkt angegeben, typischerweise eine <a href="#extern-url-url-paramsparam1--paramn">EXTERN-Funktion</a>.</p>
<h2 id="funktionsdialoge">Funktionsdialoge</h2>
<p>Mit der Grundfunktion DIALOG k&#xF6;nnen durch Dialoge abgefragte Werte in Funktionen verwendet werden. Typischer Anwendungsfall sind Dialoge zum Ausw&#xE4;hlen des Empf&#xE4;ngers bei der Formularbearbeitung. Hierzu wird eine Funktion des Typs DIALOG als AUTOFILL verwendet und dazu ein Button mit ACTION &quot;funcDialog&quot; angelegt. Der Button ruft den Dialog auf, in dem der Benutzer die gew&#xFC;nschten Daten ausw&#xE4;hlen kann. Sobald der Dialog beendet wurde, liefert die DIALOG Grundfunktion die entsprechenden Werte zur&#xFC;ck. Durch den AUTOFILL gelangen diese ins Formular. Zur Zeit gibt es nur eine Art von Funktionsdialog, den Typ &quot;dbSelect&quot;, der die Auswahl eines Datensatzes aus einer Datenquelle erlaubt.</p>
<p>Bevor ein Funktionsdialog in einer Funktion verwendet werden kann, muss er definiert werden. Dies geschieht im Abschnitt <em>Funktionsdialoge</em>. Im Folgenden ist sein Aufbau schematisch dargestellt:</p>
<pre><code>Funktionsdialoge(
  Funktionsdialog1(
    TYPE &quot;dbSelect&quot;
    TITLE &quot;&lt;Titel des Dialogfensters&gt;&quot;

    Fenster(
      Tab1(
        TITLE &quot;&lt;Titel des 1.Tabs&gt;&quot;
        CLOSEACTION &quot;back&quot;
        TIP &quot;&lt;Tooltip f&#xFC;r den 1.Tab&gt;&quot;

        Intro(
          &lt;Label, Glue oder Separator&gt;
          ...
        )#Intro

        Suche(
          (TYPE &quot;textfield&quot; ID &quot;suchanfrage&quot; ACTION &quot;search&quot;)  #optional Attribut &quot;AUTOFILL&quot; m&#xF6;glich
          (LABEL &quot;Suchen&quot;  TYPE &quot;button&quot; HOTKEY &quot;S&quot;  ACTION &quot;search&quot;)
        )#Suche

        Suchstrategie(
          &lt;Suchanfrage mit Platzhaltern&gt;
          ...
        )#Suchstrategie

        Spaltenumsetzung(
          &lt;Funktionsdefinition&gt;
          ...
        )

        Suchergebnis(
          &lt;Label, Glue oder Separator&gt;
          ...
          (TYPE &quot;listbox&quot; ID &quot;suchergebnis&quot; LINES &quot;10&quot; ACTION &quot;select&quot;
            DISPLAY &quot;&lt;Muster f&#xFC;r Anzeige der Suchergebnisse&gt;&quot;)
        )#Suchergebnis

        Vorschau(
          &lt;Anzeigeelement&gt;
          ...
        )#Vorschau

        Fussbereich(
          &lt;Button, Label, Separator oder Glue&gt;
          ...
        )#Fussbereich
      )#Tab1

      Tab2(
        ...
      )#Tab2

      ...  # weitere Tabs

    )#Fenster
  )#Funktionsdialog1

  ... # weitere Funktionsdialoge

)#Funktionsdialoge
</code></pre><p><strong>Bemerkungen:</strong></p>
<ul>
<li>Gibt es mehrere <em>Funktionsdialoge</em>-Abschnitte in der wollmux.conf, so werden diese alle in der Reihenfolge ihres Auftretens ber&#xFC;cksichtig, wobei die jeweils letzte Definition eines Dialogs G&#xFC;ltigkeit hat.</li>
<li>Innerhalb des selben <em>Funktionsdialoge</em>-Abschnitts darf jeder Dialog nur einmal definiert werden.</li>
</ul>
<p>Die Syntax f&#xFC;r die Beschreibung der Elemente in diesem Abschnitt entspricht der <a href="#beschreibung-eingabefeld-1">bereits weiter oben beschriebenen</a>. Die folgenden Abschnitte beschreiben nur die Aspekte, die noch nicht bereits beschrieben wurden.</p>
<h3 id="intro">Intro</h3>
<p>Der Unterabschnitt &quot;Intro&quot; beschreibt den oberen Teil eines Tabs. Hier wird dem Benutzer normalerweise eine Kurzerkl&#xE4;rung zum Tab geliefert, z.B. wonach er im Suchfeld suchen kann. In diesem Abschnitt werden normalerweise nur Elemente vom TYPE &quot;label&quot;, &quot;glue&quot; oder &quot;separator&quot; verwendet.</p>
<h3 id="suche">Suche</h3>
<p>In diesem Abschnitt werden die Bedienelemente f&#xFC;r das Absetzen einer Suchanfrage beschrieben. Besondere Erw&#xE4;hnung verdient hier das Eingabefeld mit der speziellen ID &quot;suchanfrage&quot;. Dieses Eingabefeld wird ausgewertet, wenn ein Button mit der ACTION &quot;search&quot; aktiviert wird. Hat das Eingabefeld ein Attribut AUTOFILL, so hat dies 2 Konsequenzen:</p>
<ul>
<li>das Feld wird mit dem AUTOFILL-Wert vorbelegt</li>
<li>die Suche wird gleich beim Aufrufen des Dialogs mit diesem Wert durchgef&#xFC;hrt, so dass der Benutzer gleich eine Ergebnisliste angezeigt bekommt.</li>
</ul>
<p>Der AUTOFILL-Wert &quot;&quot; (leerer String), oder das gleichbedeutende &quot;*&quot; k&#xF6;nnen zusammen mit einem Suchmuster ohne Spalten im Suchstrategie-Abschnitt verwendet werden, um zu erreichen dass der Benutzer gleich den kompletten Inhalt einer Datenquelle angezeigt bekommt, ohne erst eine Suche starten zu m&#xFC;ssen.</p>
<h3 id="suchstrategie">Suchstrategie</h3>
<p>Der Abschnitt legt fest, wie die vom Benutzer im mit der ID &quot;suchanfrage&quot; ausgezeichneten Textfeld eingegebenen Suchworte in Datenquellen-Abfragen umgesetzt werden. Der Abschnitt besteht aus einer beliebigen Anzahl von Suchanfragen nach folgendem Schema:</p>
<p><code>datenquellenname(Spaltenname1 &quot;&lt;Suchmuster1&gt;&quot; Spaltenname2 &quot;&lt;Suchmuster2&gt;&quot; ... )</code></p>
<p>Im Folgenden einige Praxisbeispiele:</p>
<p><code>personal(Mail &quot;${suchanfrage1}&quot;)</code></p>
<p><code>personal(Mail &quot;${suchanfrage1}@muenchen.de&quot;)</code></p>
<p><code>personal(Nachname &quot;${suchanfrage1}*&quot;)</code></p>
<p><code>personal(Vorname &quot;${suchanfrage1}&quot; Nachname &quot;${suchanfrage2}&quot;)</code></p>
<p><code>personal(OrgaKurz &quot;${suchanfrage1}-${suchanfrage2}&quot;)</code></p>
<p>Bemerkungen:</p>
<ul>
<li>Als Platzhalter sind ${suchanfrage1} bis ${suchanfrage2} erlaubt und werden durch entsprechende W&#xF6;rter der vom Benutzer eingegebenen Suchanfrage ersetzt.</li>
<li>Sternchen sind als Jokerzeichen erlaubt und stehen f&#xFC;r einen beliebigen Teilstring</li>
<li>Die Suchmuster f&#xFC;r die eingegebene Anzahl von W&#xF6;rtern werden in der Reihenfolge ihres Auftretens versucht und die Ergebnisse der ersten Anfrage zur&#xFC;ckgeliefert, die mindestens ein Ergebnis liefert.</li>
<li>Suchmuster, die mehr W&#xF6;rter erfordern als der Benutzer eingegeben hat, werden ignoriert.</li>
<li>Gibt es f&#xFC;r die Anzahl vom Benutzer eingegebener W&#xF6;rter keine Regel, so wird die Eingabe so lange von hinten beginnend gek&#xFC;rzt bis sie entweder leer ist oder eine Wortzahl erreicht wurde, f&#xFC;r die es eine Regel gibt.</li>
<li><p>Die Angabe eines Suchmusters ohne Spalten (d.h. nur der Datenquellenname) ist m&#xF6;glich und bedeutet, dass leere Suchanfragen und die Suchanfrage &quot;*&quot; erlaubt sind und alle Datens&#xE4;tze der Datenquelle zur&#xFC;ckliefern sollen.</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Dieses Feature wird derzeit nicht von allen Datenquellentypen unterst&#xFC;tzt und nur nach Bedarf weiterentwickelt.</p>
</blockquote>
</li>
</ul>
<h3 id="spaltenumsetzung">Spaltenumsetzung</h3>
<p>Die von der Datenquelle gelieferten Datens&#xE4;tze haben meist nicht genau das Schema, das man ben&#xF6;tigt. Der <em>Spaltenumsetzung</em>-Abschnitt erlaubt es mittels beliebiger <a href="#funktionen">Funktionen</a> aus den in der Datenquelle existierenden Spalten neue Spalten zu generieren. Der Aufbau des Abschnitts <em>Spaltenumsetzung</em> ist genau wie der des <em>Funktionen</em>-Abschnitts. Das folgende Beispiel demonstriert dies:</p>
<pre><code>Spaltenumsetzung(
  EmpfaengerZeile1(CAT(VALUE(&quot;Vorname&quot;) &quot; &quot; VALUE(&quot;Nachname&quot;)))
  EmpfaengerZeile2(VALUE(&quot;Postanschrift&quot;))
  EmpfaengerZeile3(CAT(VALUE(&quot;PostPLZ&quot;) &quot; &quot; VALUE(&quot;PostOrt&quot;)))
  Vorname(VALUE(&quot;Vorname&quot;))   # 1:1  Umsetzung
)
</code></pre><blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Der <em>Spaltenumsetzung</em>-Abschnitt legt die Spalten sowohl f&#xFC;r die DIALOG-Grundfunktion als auch f&#xFC;r den <em>Vorschau</em>-Abschnitt und die DISPLAY-Angabe im <em>Suchergebnis</em>-Abschnitt fest. Spalten, die nicht im <em>Spaltenumsetzung</em>-Abschnitt definiert sind, k&#xF6;nnen an keiner der vorgenannten Stellen verwendet werden. Insbesondere ist zum unver&#xE4;nderten Weiterverwenden einer Spalte des Suchergebnisses eine 1:1 Spaltenumsetzung erforderlich.</p>
</blockquote>
<h3 id="suchergebnisdisplay-attribut">Suchergebnis/DISPLAY-Attribut</h3>
<p>Im Suchergebnis-Abschnitt ist neben den Elementen vom TYPE &quot;label&quot;, &quot;glue&quot; und &quot;separator&quot;, die wie &#xFC;blich f&#xFC;r die Anzeige statischer Informationen und die optische Auflockerung verwendet werden, das einzige bemerkenswerte Element eine &quot;listbox&quot;, die mit der ID &quot;suchergebnis&quot; ausgezeichnet wird. In dieser Listbox werden die Ergebnisse der Suchanfrage dargestellt. Wie die Darstellung der Eintr&#xE4;ge erfolgen soll regelt das DISPLAY-Attribut. Neben statischen Textteilen kann das Anzeigemuster Platzhalter der Form <code>${Spaltenname}</code> enthalten, die f&#xFC;r den jeweiligen Datensatz durch den entsprechenden Spaltenwert ersetzt werden.</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Die Spaltennamen im DISPLAY-Attribut sind grunds&#xE4;tzlich durch den <em>Spaltenumsetzung</em>-Abschnitt definierte Spalten. Soll eine Spalte des Datensatzes unver&#xE4;ndert angezeigt werden, so muss eine entsprechende 1:1 Umsetzung im <em>Spaltenumsetzung</em>-Abschnitt erfolgen.</p>
</blockquote>
<h3 id="vorschau">Vorschau</h3>
<p>Der <em>Vorschau</em>-Abschnitt enth&#xE4;lt neben den &#xFC;blichen statischen Elementen vom Typ &quot;glue&quot;, &quot;label&quot; oder &quot;separator&quot; eine Reihe von auf READONLY &quot;true&quot; gesetzten Textfeldern, die mit DB_SPALTE-Attributen versehen sind. Die entsprechenden Zeilen des in der Vorschau-Liste angew&#xE4;hlten Datensatzes werden hier dargestellt. Jede DB_SPALTE kann derzeit maximal einmal im Vorschau-Abschnitt verwendet werden. Bei mehrfachen Eintr&#xE4;gen mit der selben DB_SPALTE wird nur im letzten Textfeld die Spalte angezeigt.</p>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Die Spaltennamen im DB_SPALTE-Attribut sind grunds&#xE4;tzlich durch den <em>Spaltenumsetzung</em>-Abschnitt definierte Spalten. Soll eine Spalte des Datensatzes unver&#xE4;ndert angezeigt werden, so muss eine entsprechende 1:1 Umsetzung im <em>Spaltenumsetzung</em>-Abschnitt erfolgen.</p>
</blockquote>
<h3 id="fussbereich">Fussbereich</h3>
<p>In diesem Abschnitt werden Eingabeelemente definiert, die am unteren Rand des Tabs angezeigt werden sollen, typischerweise Buttons.</p>
<h3 id="actions-in-dbselect-funktionsdialogen">ACTIONs in &quot;dbSelect&quot; Funktionsdialogen</h3>
<p>Funktionsdialoge des Typs dbSelect unterst&#xFC;tzen die folgenden ACTIONs:</p>
<ul>
<li><strong>back:</strong> Kehrt zum aufrufenden Dialog zur&#xFC;ck. Es wird kein Datensatz ausgew&#xE4;hlt. Im Kontext des Formularsystems normalerweise kein Unterschied zu abort.</li>
<li><strong>abort:</strong> Schlie&#xDF;t den Dialog. Es wird kein Datensatz ausgew&#xE4;hlt.</li>
<li><strong>select:</strong> W&#xE4;hlt den momentan in der Ergebnisliste markierten Datensatz aus. DIALOG-Funktionen, die sich auf diesen Funktionsdialog beziehen liefern ab diesem Zeitpunkt die Werte des ausgew&#xE4;hlten Datensatzes.</li>
<li><strong>search:</strong> F&#xFC;hrt die Suche gem&#xE4;&#xDF; der vom Benutzer eingegebenen Suchw&#xF6;rter durch und aktualisiert die Ergebnisliste entsprechend.</li>
</ul>
<h2 id="druckfunktionen">Druckfunktionen</h2>
<p>Zur Automatisierung des Drucks mehrerer leicht verschiedener Ausfertigungen eines Dokuments k&#xF6;nnen sog. Druckfunktionen definiert werden. Dazu dient der Abschnitt &quot;Druckfunktionen&quot;. Alle Druckfunktionen die in diesem Abschnitt definiert werden sind global verf&#xFC;gbar:</p>
<pre><code>Druckfunktionen(

  SachleitendeVerfuegung(EXTERN(URL &quot;java:de.muenchen.allg.itd51.wollmux.func.StandardPrint.sachleitendeVerfuegung&quot;) ORDER &quot;10&quot;)
  SachleitendeVerfuegungOutput(EXTERN(URL &quot;java:de.muenchen.allg.itd51.wollmux.func.StandardPrint.sachleitendeVerfuegungOutput&quot;) ORDER &quot;150&quot;)

  AlleKrankenkassen(EXTERN(URL &quot;vnd.sun.star.script:WollMux.Tools.AlleKrankenkassen) ORDER &quot;20&quot;)
)
</code></pre><p><strong>Anmerkungen</strong>:</p>
<ul>
<li>Da Druckfunktionen nur als externe Funktionen implementiert werden, darf dem Funktionsbezeichner ausschlie&#xDF;lich der Schl&#xFC;ssel &quot;EXTERN(...)&quot; mit einer g&#xFC;ltigen URL folgen, die den physikalischen Ort der externen Druckfunktion beschreibt.</li>
<li>Einzelne Druckfunktionen k&#xF6;nnen in einem sp&#xE4;teren Abschnitt &quot;Druckfunktionen&quot; redefiniert werden.</li>
<li>Im Unterschied zu normalen Funktionen werden Druckfunktionen immer asynchron in einem eigenen Thread gestartet. Der WollMux &#xFC;berwacht nicht, ob die Druckfunktion zur&#xFC;ckkehrt und ob dabei Fehler auftraten.</li>
</ul>
<p>Das Attribut ORDER: Verschiedene Druckfunktionen k&#xF6;nnen beliebig kombiniert und hintereinander ausgef&#xFC;hrt werden. Ein praktischer Anwendungszweck ist z.B. die M&#xF6;glichkeit, den Komfortdruck f&#xFC;r Sachleitende Verf&#xFC;gungen mit dem Komfortdruck f&#xFC;r Serienbriefe zu verketten. Das Attribut ORDER definiert dabei die Reihenfolge, in der die einzelnen Druckfunktionen kombiniert werden, wobei Druckfunktionen mit kleinem ORDER-Wert vor Druckfunktionen mit h&#xF6;herem ORDER-Wert ausgef&#xFC;hrt werden. Das Attribut ORDER ist f&#xFC;r alle Druckfunktionen optional, sollte aber stets angegeben werden, damit die Aufrufkette immer eindeutig definiert ist. Ist das ORDER-Attribut nicht angegeben, so wird automatisch die Voreinstellung &quot;100&quot; verwendet.</p>
<h3 id="demuenchenallgitd51wollmuxfuncstandardprint">de.muenchen.allg.itd51.wollmux.func.StandardPrint</h3>
<p>Dieses Java-Modul enth&#xE4;lt einige vorgefertigte Standard-Druckfunktionen. Alle diese Druckfunktionen sind auch in der WollMux-Standard-Konfiguration definiert.</p>
<ul>
<li><em>sachleitendeVerfuegung</em>: Druckt die verschiedenen Ausdrucke eines Dokuments mit Sachleitenden Verf&#xFC;gungen.</li>
<li><em>sachleitendeVerfuegungOutput</em>: Die Druckfunktion wird automatisch im Hintergrund von der Druckfunktion sachleitendeVerfuegung verwendet und muss nie direkt aufgerufen bzw. eingebunden werden.</li>
<li><em>mailMergeWithoutSelection</em>: Serienbriefdruck: Druckt f&#xFC;r jeden Datensatz der &#xFC;ber Bearbeiten/Datenbank austauschen gew&#xE4;hlten Tabelle eine entsprechende Ausfertigung.</li>
<li><em>mailMergeWithSelection</em>: Serienbriefdruck: Pr&#xE4;sentiert dem Benutzer eine Auswahlliste in der er die Datens&#xE4;tze w&#xE4;hlen kann, f&#xFC;r die eine Ausfertigung gedruckt werden soll. Angezeigt wird in dieser Liste f&#xFC;r jeden Datensatz der Inhalt der Spalte &quot;WollMuxDescription&quot;. Ist eine Spalte &quot;WollMuxSelected&quot; vorhanden und enth&#xE4;lt &quot;1&quot;, &quot;ja&quot; oder &quot;true&quot;, so ist der entsprechende Datensatz in der Auswahlliste bereits vorselektiert.</li>
<li><em>superMailMerge</em>: Interaktive Seriendruckfunktion: L&#xE4;sst den Benutzer eine Tabelle einer in OOo registrierten Datenquelle <em>oder eine Tabelle einer offenen Calc-Datei</em> ausw&#xE4;hlen als Datenlieferant f&#xFC;r den Seriendruck. Im Falle der Calc-Tabelle werden nur die sichtbaren Zellen verwendet. Es ist also m&#xF6;glich, vor dem Seriendruck in Calc die Daten zu filtern. Ein Button <em>Einzelauswahl</em> erlaubt eine manuelle Selektion genau wie bei der Funktion <em>mailMergeWithSelection</em>. Die Spalten &quot;WollMuxDescription&quot; und &quot;WollMuxSelected&quot; werden in diesem Fall wie dort beschrieben ausgewertet.</li>
<li><em>printIntoFile</em>: &quot;Druckt&quot; den Inhalt in ein offenes Writer-Dokument. Das XTextDocument in das der Druck geschrieben werden soll kann &#xFC;ber das Property <code>PrintIntoFile_OutputDocument</code> des XPrintModels gesetzt werden. Ist dieses Property nicht gesetzt, so wird ein neues Dokumentfenster ge&#xF6;ffnet.</li>
</ul>
<p>Informationen zum Entwickeln eigener Konfortdruckfunktionen finden Sie unter: <a href="Schnittstellen_des_WollMux_fuer_Experten.html#einbinden-eigener-komfortdruckfunktionen">Schnittstellen f&#xFC;r Experten: Einbinden von Komfortdruckfunktionen</a>.</p>
<h2 id="formulare">Formulare</h2>
<p>Es gibt ein paar globale Einstellungen f&#xFC;r Formulare, die im Abschnitt <em>Formulare</em> festgelegt werden k&#xF6;nnen. Das folgende Beispiel zeigt einen entsprechenden Abschnitt.</p>
<pre><code>Formulare(
  Plausiwarnung(
    TYPE &quot;confirm&quot;
    TITLE &quot;WARNUNG!&quot;
    LABEL &quot;Sie wollen ein Formular produzieren, das fehlerhaft ausgef&#xFC;llt wurde. Wirklich fortfahren?&quot;
  )
)
</code></pre><h3 id="plausiwarnung">Plausiwarnung</h3>
<p>Der Abschnitt <em>Plausiwarnung</em> bestimmt, wie sich ein Formular verhalten soll, wenn der Benutzer versucht, es zu Drucken oder nach PDF zu konvertieren obwohl mindestens eine Plausibilit&#xE4;tspr&#xFC;fung einen Fehler meldet.</p>
<h2 id="formularanpassung">Formularanpassung</h2>
<p><em>Formularanpassung</em>-Abschnitte k&#xF6;nnen verwendet werden, um Ver&#xE4;nderungen an Formularen vorzunehmen, ohne die eigentlichen Formularvorlagen anzufassen. Diese M&#xF6;glichkeiten sollten mit Bedacht eingesetzt werden, da sie dazu f&#xFC;hren, dass das &#xD6;ffnen der <em>identischen</em> Vorlagendatei zu <em>unterschiedlichen</em> Ergebnissen f&#xFC;hrt je nach verwendeter WollMux-Konfiguration. Es ist in den meisten F&#xE4;llen w&#xFC;nschenswert, die Formular&#xE4;nderungen direkt in die Vorlagendateien zu integrieren. Auch dabei k&#xF6;nnen <em>Formularanpassung</em>-Abschnitte behilflich sein (siehe <em>Hinweise</em> weiter unten). Folgende Beispiel demonstrieren den Aufbau von <em>Formularanpassung</em>-Abschnitten:</p>
<p><strong>Beispiel 1</strong>:</p>
<pre><code>Formularanpassung(
     # Anpassung soll nur Formulare betreffen mit Titel &quot;BS-Bescheid&quot;, die einen
     # Reiter &quot;Empfaengerauswahl&quot; haben
  Match( TITLE &quot;BS-Bescheid&quot; )
  Match( Fenster(Empfaengerauswahl(Eingabefelder())) )

  Formular(
    Fenster(
      Empfaengerauswahl(
        TITLE &quot;Empf&#xE4;nger&quot;

        Eingabefelder(
          (LABEL &quot;Zustellvermerk&quot; TYPE &quot;combobox&quot; ID &quot;EmpfaengerZustellvermerk&quot; ...)
           ...
        )
        Buttons(
          (LABEL &quot;Abbrechen&quot;  TYPE &quot;button&quot; HOTKEY &quot;A&quot;  ACTION &quot;abort&quot; TIP &quot;Zum Abbrechen hier klicken&quot;)
        ...
        )
      )
    )
  )
)
</code></pre><p><strong>Beispiel 2</strong>:</p>
<pre><code># Bei allen Formularen den Drucken-Knopf verbieten, daf&#xFC;r aber einen PDF-Knopf anbieten
# Au&#xDF;erdem reparieren wir hier die Weiter/Zur&#xFC;ck-Steuerung, die durch das &#xC4;ndern des
# Empfaengerauswahl-Reiters durcheinandergebracht wird
Formularanpassung(
  # keine Match() Angaben, betrifft also alle Formulare

  Buttonanpassung(
      EinzigerTab( NEVER (&quot;printForm&quot; &quot;prevTab&quot;, &quot;nextTab&quot; )
                   ALWAYS (LABEL &quot;Als Pdf speichern...&quot; TYPE &quot;button&quot; TIP &quot;&quot; READONLY &quot;false&quot; ACTION &quot;form2PDF&quot;
                 )
      ErsterTab( NEVER (&quot;form2PDF&quot;, &quot;printForm&quot;, &quot;prevTab&quot;)
                 ALWAYS (LABEL &quot;Weiter-&gt;&quot;  TYPE &quot;button&quot; HOTKEY &quot;W&quot;  ACTION &quot;nextTab&quot;)
               )
      MittlererTab( NEVER (&quot;form2PDF&quot;, &quot;printForm&quot;)
                    ALWAYS (LABEL &quot;&lt;-Zur&#xFC;ck&quot;  TYPE &quot;button&quot; HOTKEY &quot;Z&quot;  ACTION &quot;prevTab&quot;)
                    ALWAYS (LABEL &quot;Weiter-&gt;&quot;  TYPE &quot;button&quot; HOTKEY &quot;W&quot;  ACTION &quot;nextTab&quot;)
                  )
      LetzterTab(NEVER (&quot;printForm&quot; &quot;nextTab&quot;)
                   ALWAYS (LABEL &quot;&lt;-Zur&#xFC;ck&quot;  TYPE &quot;button&quot; HOTKEY &quot;Z&quot;  ACTION &quot;prevTab&quot;)
                   ALWAYS (LABEL &quot;Als Pdf speichern...&quot; TYPE &quot;button&quot; TIP &quot;&quot; READONLY &quot;false&quot; ACTION &quot;form2PDF&quot;
                )
    )
)
</code></pre><p>Die Funktionsweise der <em>Formularanpassung</em>-Abschnitte ist wie folgt: Bei jedem ge&#xF6;ffneten Formular wird zuerst anhand der <em>Match</em>-Abschnitte (siehe unten) getestet, ob die Anpassung bei diesem Formular durchgef&#xFC;hrt werden soll. Falls ja, werden alle Reiter des <em>Formular</em>-Abschnitts der <em>Formularanpassung</em> vereinigt mit denen des Formulars. Gibt es dadurch mehrere Reiter mit der selben ID, werden von diesen nur die aus der <em>Formularanpassung</em> verwendet. Obiges Beispiel 1 f&#xFC;hrt also nicht zum Vorhandensein von 2 Empf&#xE4;ngerauswahl-Reitern, sondern ersetzt den in der Formulardatei gespeicherten Reiter durch den aus dem <em>Formularanpassung</em>-Abschnitt. Nach dem Mischen der Reiter werden die Buttons angepasst entsprechend der Vorgaben aus dem <em>Buttonanpassung</em>-Abschnitt (siehe unten).</p>
<p><strong>Hinweise</strong>:</p>
<ul>
<li>Die &#xC4;nderungen durch <em>Formularanpassung</em>-Abschnitte werden nicht nur auf die Anzeige der Formular-GUI angewendet, sondern betreffen auch WollMux-Funktionen, die die Formularbeschreibung ver&#xE4;ndern, allen voran der <a href="FormularMax_4000">FormularMax 4000</a>. D.h. falls ein von einem <em>Formularanpassung</em>-Abschnitt betroffenes Formular im FM4000 zum Bearbeiten ge&#xF6;ffnet wird, so wird dort die <em>angepasste</em> Formularbeschreibung angezeigt und mit dem n&#xE4;chsten Speichern wird diese permanent in die Vorlangendatei &#xFC;bertragen. Dies kann verwendet werden, um mit relativ geringem Aufwand &#xC4;nderungen in viele Formularvorlagen zu &#xFC;bertragen.</li>
<li>Bei Verwendung von <a href="Schnittstellen_des_WollMux_fuer_Experten.html#wollmuxopen">wollmux:Open</a> in Gegenwart von <em>Formularanpassung</em>-Abschnitten wird die <em>Buttonanpassung</em> des wollmux:Open Befehls <em>nach</em> der Abarbeitung aller <em>Formularanpassung</em>-Abschnitte durchgef&#xFC;hrt.</li>
<li>In der <a href="Format_von_WollMux-Config-Dateien.html">Syntax der wollmux.conf</a> bedeuten <code>Empfaengerauswahl()</code> und <code>&quot;Empfaengerauswahl&quot;</code> das selbe. Der Match-Ausdruck <code>Match(Fenster(Empfaengerauswahl()))</code> funktioniert also evtl. nicht so wie gew&#xFC;nscht. Er entspricht dem Ausdruck <code>Match(Fenster(&quot;Empfaengerauswahl&quot;))</code> der auch dann greift, wenn der String &quot;Empfaengerauswahl&quot; irgendwo im Formular vorkommt.</li>
</ul>
<h3 id="match">Match</h3>
<p>Durch die optionalen <em>Match</em>-Abschnitte kann bestimmt werden, f&#xFC;r welche Formulare die Anpassungen gelten sollen. Die Anpassung wird nur f&#xFC;r Formulare durchgef&#xFC;hrt aus deren Formularbeschreibung sich nur durch L&#xF6;schungen (d.h. ohne Einf&#xFC;gungen oder Verschiebungen) alle <em>Match</em>-Abschnitte ableiten lassen. Die <em>Match</em>-Abschnitte sind also quasi auf die wesentlichen Erkennungsmerkmale zusammengestutzte Formularbeschreibungen.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Die Reihenfolge von Abschnitten und Schl&#xFC;ssel-Wert-Paaren in <em>Match</em>-Abschnitten ist bedeutungslos. Deswegen kann man auch alle <em>Match</em>-Abschnitte zu einem gro&#xDF;en <em>Match</em>-Abschnitt zusammenfassen ohne die Bedeutung zu ver&#xE4;ndern.</p>
</blockquote>
<h3 id="buttonanpassung">Buttonanpassung</h3>
<p>Beim Mischen der Reiter des Formulars mit denen der <em>Formularanpassung</em> kann es dazu kommen, dass die Benutzerf&#xFC;hrung der Buttonleiste gest&#xF6;rt wird. Zum Beispiel ist es m&#xF6;glich, dass in der verschmolzenen Formular-GUI ein mittleres Tab keinen &quot;Weiter-&gt;&quot; Button, daf&#xFC;r jedoch einen Drucken-Button hat. Um diese Probleme zu umgehen kann ein Abschnitt Buttonanpassung verwendet werden. Dieser Abschnitt erlaubt es au&#xDF;erdem, global f&#xFC;r alle oder f&#xFC;r bestimmte Formulare Buttons vorzugeben oder zu verbieten. Im Abschnitt <em>Buttonanpassung</em> sind die folgenden Unterabschnitte m&#xF6;glich:</p>
<ul>
<li><em>EinzigerTab:</em> Wird angewendet, wenn die angepasste Formular-GUI genau einen Reiter besitzt.</li>
<li><em>ErsterTab:</em> Wird f&#xFC;r den ersten Reiter der angepassten Formular-GUI angewendet, wenn die Formular-GUI mindestens 2 Reiter besitzt.</li>
<li><em>LetzterTab:</em> Wird f&#xFC;r den letzten Reiter der angepassten Formular-GUI angewendet, wenn die Formular-GUI mindestens 2 Reiter besitzt.</li>
<li><em>MittlererTab:</em> Wird f&#xFC;r einen Reiter angewendet, der weder der erste noch der letzte Reiter der angepassten Formular-GUI ist. So ein Reiter existiert nur, wenn die Formular-GUI mindestens 3 Reiter besitzt.</li>
</ul>
<p>In jedem dieser Abschnitte k&#xF6;nnen Regeln angegeben werden wie im folgenden beschrieben.</p>
<h4 id="never-aktionsliste">NEVER (&lt;Aktionsliste&gt;)</h4>
<p>Alle Buttons, denen eine ACTION aus der &lt;Aktionsliste&gt; zugeordnet ist werden vom betreffenden Reiter entfernt.</p>
<h4 id="always-bedienelement">ALWAYS (&lt;Bedienelement&gt;)</h4>
<p>&#xDC;berpr&#xFC;ft, ob der betreffende Reiter bereits einen Button mit der selben ACTION-Angabe wie &lt;Bedienelement&gt; hat. Falls nicht, so wird der durch &lt;Bedienelement&gt; beschriebene Button in die Buttonleiste des Reiters eingef&#xFC;gt. Dabei wird soweit m&#xF6;glich die Reihenfolge der ALWAYS-Angaben eingehalten, auch bzgl. schon vorhandener Buttons. Durch die (unsch&#xE4;dliche) Aufnahme bereits vorhandener Buttons als ALWAYS-Angabe l&#xE4;sst sich also steuern, wo neue Buttons in die Buttonleiste eingef&#xFC;gt werden.</p>
<h2 id="externeanwendungen">ExterneAnwendungen</h2>
<p>&#xDC;ber die WollMux-Sidebar k&#xF6;nnen nicht nur Office-Vorlagen und Dokumente ge&#xF6;ffnet werden, sondern auch beliebige Dateien und URLs, die von externen Anwendungen verarbeitet werden (z.B. PDF-Dateien f&#xFC;r den Acrobat Reader). Der Abschnitt <em>ExterneAnwendungen</em> macht dem WollMux die entsprechenden externen Anwendungen bekannt. Ein Beispiel f&#xFC;r einen <em>ExterneAnwendungen</em>-Abschnitt:</p>
<pre><code>ExterneAnwendungen(
  (EXT (&quot;pdf&quot;, &quot;PDF&quot;)
     DOWNLOAD &quot;true&quot;
     PIPE &quot;true&quot;
     FILTER &quot;writer_pdf_Export&quot;
     PROGRAM (
       &quot;acroread&quot;,
       &quot;acroread.bat&quot;,
       &quot;AcroRd32.exe&quot;,
       &quot;C:\Programme\Adobe\Acrobat 6.0\Reader\AcroRd32.exe&quot;
    )
  )

 (EXT &quot;http:&quot;
    DOWNLOAD &quot;false&quot;
    PROGRAM (
      &quot;sensible-browser&quot;,
      &quot;sensible-browser.bat&quot;
    )
  )
)#ExterneAnwendungen
</code></pre><p>Die Attribute der Eintr&#xE4;ge des Abschnitts sind im folgenden n&#xE4;her erl&#xE4;utert.</p>
<h3 id="ext-liste">EXT &quot;&lt;Liste&gt;&quot;</h3>
<p>Die beim Attribut EXT angegebene Liste von Strings dient dazu, die externe Anwendung zu identifizieren zu der der Eintrag geh&#xF6;rt. &#xDC;ber das gleichnamige Attribut bei Buttons mit <a href="#das-attribut-action">ACTION &quot;openExt&quot;</a> wird der Bezug zwischen dem Button und der externen Anwendung hergestellt. Die Strings der &lt;Liste&gt; sind beliebig und Gro&#xDF;-/Kleinschreibung ist bedeutsam. Typischerweise werden hier die Dateierweiterungen verwendet, die die entsprechende Applikation verarbeitet. Im Falle, dass die Anwendung URLs direkt verarbeitet ist die Angabe des Protokolls als Bezeichner gefolgt von einem Doppelpunkt zur Abgrenzung gegen&#xFC;ber Dateierweiterungen sinnvoll (z.B. &quot;http:&quot;).</p>
<h3 id="program-liste">PROGRAM &quot;&lt;Liste&gt;&quot;</h3>
<p>Auf verschiedenen Plattformen ist das selbe Programm unter Umst&#xE4;nden unter verschiedenen Namen bzw. in verschiedenen Dateipfaden zu finden. Um dennoch eine einheitliche Konfiguration f&#xFC;r verschiedene Plattformen verwenden zu k&#xF6;nnen, erlaubt das PROGRAM-Attribut die Angabe einer &lt;Liste&gt; von Programmnamen und Pfaden. Soll die externe Anwendung gestartet werden, so versucht der WollMux die Eintr&#xE4;ge der &lt;Liste&gt; in der angegebenen Reihenfolge bis der Start des Programms erfolgreich war. F&#xFC;hrt kein Eintrag zum Ziel gibt es eine Dialogbox f&#xFC;r den Benutzer und einen Eintrag in der Logdatei.</p>
<h4 id="loadcomponentfromurl">/loadComponentFromUrl/</h4>
<p>Neben echten Programmen kann das virtuelle Programm &quot;/loadComponentFromURL/&quot; angegeben werden. Es ist ungef&#xE4;hr das selbe als ob man soffice bzw. soffice.exe angibt, allerdings wird nicht wirklich ein externes Programm gestartet sondern die interne Funktion von OOo zum Laden des Dokuments verwendet. Es ist m&#xF6;glich, Parameter mitzugeben, z.B.</p>
<p><code>PROGRAM(&quot;/loadComponentFromURL/AsTemplate=true/MacroExecutionMode=3/Hidden=false/&quot;)</code></p>
<p>Die Parameter sind optional und ihre Reihenfolge ist beliebig. F&#xFC;r MacroExecutionMode stehen folgende Konstanten zur Verf&#xFC;gung</p>
<pre><code> # NEVER_EXECUTE = 0;
 # FROM_LIST = 1;
 # ALWAYS_EXECUTE = 2;
 # USE_CONFIG = 3;
 # ALWAYS_EXECUTE_NO_WARN = 4;
 # USE_CONFIG_REJECT_CONFIRMATION = 5;
 # USE_CONFIG_APPROVE_CONFIRMATION = 6;
 # FROM_LIST_NO_WARN = 7;
 # FROM_LIST_AND_SIGNED_WARN = 8;
 # FROM_LIST_AND_SIGNED_NO_WARN = 9;
</code></pre><p>N&#xE4;heres siehe in der <a href="http://api.openoffice.org/docs/common/ref/com/sun/star/frame/XComponentLoader.html" target="_blank">IDL-Doku zu loadComponentFromURL</a>.</p>
<h4 id="technische-hinweise">Technische Hinweise</h4>
<ul>
<li>Angaben ohne Pfad werden wie allgemein &#xFC;blich mit Hilfe der Systemvariable PATH aufgel&#xF6;st.</li>
<li>Nach dem Start einer externen Anwendung schlie&#xDF;t der WollMux normalerweise den Standardeingabe-, Standardausgabe- sowie den Standardfehlerkanal, um zu verhindern, dass die Anwendung blockiert weil sie auf Eingabe wartet bzw. Ausgabe t&#xE4;tigen m&#xF6;chte. Nicht alle Programme kommen damit zurecht. F&#xFC;r Programme, die mit diesem Verhalten Probleme haben, kann entweder das <a href="#pipe-trueoderfalse">Attribut PIPE &quot;true&quot;</a> gesetzt oder ein einfaches Skript als Wrapper geschrieben werden, das die Eingabe/Ausgabe von/zu entsprechenden Stellen umleitet.</li>
</ul>
<h3 id="download-trueoderfalse">DOWNLOAD &quot;&lt;true_oder_false&gt;&quot;</h3>
<p>Die Angabe des Attributs DOWNLOAD ist optional (Defaultwert ist &quot;false&quot;). Im Falle DOWNLOAD &quot;false&quot; wird der externen Anwendung die URL der zu &#xF6;ffnenden Datei direkt als URL &#xFC;bergeben. Im Falle DOWNLOAD &quot;true&quot; wird die URL erst heruntergeladen und in einer tempor&#xE4;ren Datei gespeichert, deren Pfad an die externe Anwendung &#xFC;bergeben wird.</p>
<h4 id="technische-hinweise">Technische Hinweise</h4>
<ul>
<li>Die tempor&#xE4;re Datei wird im Standardverzeichnis f&#xFC;r benutzerspezifische tempor&#xE4;re Daten gespeichert (unter Windows 2000 ist dies C:\Benutzer\&lt;Anmeldek&#xFC;rzel&gt;\Lokale Einstellungen\Temp), in einem Unterverzeichnis wollmuxbar-temp-download-&lt;Zahl&gt;, wobei &lt;Zahl&gt; bei jeder Datei um 1 heraufgez&#xE4;hlt wird.</li>
<li>Die tempor&#xE4;re Datei wird durch den WollMux nicht automatisch gel&#xF6;scht. Eine automatische L&#xF6;schung ist technisch nicht m&#xF6;glich, da der WollMux keine M&#xF6;glichkeit hat, festzustellen, wann die Datei nicht mehr ben&#xF6;tigt wird. Viele Anwendungen (z.B. der Acrobat Reader) testen auf eine bereits laufende Instanz und reichen den Aufruf falls eine gefunden wird an diese weiter. Deshalb ist die Beendigung des aufgerufenen Programms kein hinreichender Hinweis darauf, dass die tempor&#xE4;re Datei nicht mehr ben&#xF6;tigt wird. Eine automatische L&#xF6;schung der tempor&#xE4;ren Datei durch den WollMux ist allerdings auch nicht erforderlich. Viele Anwendungen schreiben Dateien in dieses tempor&#xE4;re Verzeichnis, ohne diese sp&#xE4;ter zu l&#xF6;schen. Eine L&#xF6;schstrategie f&#xFC;r dieses Verzeichnis kann also vorausgesetzt werden. Auf dem Basisclient zum Beispiel wird das verwendete Verzeichnis (/tmp) bei jedem Reboot gel&#xF6;scht.</li>
</ul>
<h3 id="pipe-trueoderfalse">PIPE &quot;&lt;true_oder_false&gt;&quot;</h3>
<p>Die Angabe des Attributes PIPE ist optional (Defaultwert ist &quot;false&quot;). Hat es den Wert &quot;true&quot;, so liest der WollMux bzw. die WollMux-Sidebar nach Start der externen Anwendung deren Stdout und Stderr permanent aus. Ist PIPE &quot;false&quot; oder fehlt, so schlie&#xDF;t der WollMux diese Kan&#xE4;le nach Start der Anwendung. Es gibt manche Anwendungen (z.B. der Adobe Reader), die mit PIPE &quot;false&quot; nicht funktionieren. Da das Auslesen von Stdout/Stderr einen laufenden Thread erfordert, ist normalerweise ein Shell-Wrapper mit Umleitung nach /dev/null die bessere Wahl. Ein Nebeneffekt von PIPE &quot;true&quot;, der f&#xFC;r das Debugging n&#xFC;tzlich ist ist, dass der WollMux alle Ausgaben des externen Programms in die wollmux.log kopiert.</p>
<h3 id="filter-filtername">FILTER &quot;&lt;Filtername&gt;&quot;</h3>
<p>Die Angabe des Attributs FILTER ist nur notwendig, wenn der WollMux Dateien f&#xFC;r diese Anwendung schreiben muss. Dies ist z.B. der Fall, wenn die externe Anwendung &#xFC;ber die <a href="Dokumentkommandos_des_WollMux.html#action-aktion">ACTION &quot;closeAndOpenExt&quot; oder &quot;saveTempAndOpenExt&quot;</a>, die f&#xFC;r einen Button in der Formular-GUI eines WollMux-Formulars hinterlegt ist, ausgef&#xFC;hrt werden soll. Wenn ein Button mit der ACTION &quot;closeAndOpenExt&quot; oder &quot;saveTempAndOpenExt&quot; in einer Formular-GUI angeklickt wird, so speichert der WollMux das aktuelle Formular in einer tempor&#xE4;ren Datei, die dann von der angegeben Anwendung ge&#xF6;ffnet wird. Das Attribut FILTER gibt also in diesem Fall an, in welchem Format das Formular als tempor&#xE4;re Datei gespeichert werden soll. Dazu stehen dem WollMux alle Export-Filter zur Verf&#xFC;gung, die auch der verwendeten Version von LibreOffice zur Verf&#xFC;gung stehen.</p>
<p>Die zur Verf&#xFC;gung stehenden Filter lassen sich in der Datei &lt;Installationsverzeichnis&gt;<code>/basis3.1/share/registry/modules/org/openoffice/TypeDetection/Filter/fcfg_writer_filters.xcu</code> finden. Der als Filtername f&#xFC;r das FILTER-Attribut zu verwendende Bezeichner ist der dem gew&#xFC;nschten Format entsprechende String, der in dieser Datei hinter <code>&lt;code&gt;&lt;node oor:name=&lt;/code&gt;</code> steht. Wichtig: Es k&#xF6;nnen nur solche Filter zum Speichern verwendet werden, bei denen in der darauf folgenden Zeile (beginnt mit <code>&lt;prop oor:name=&quot;Flags&quot;&gt;</code>) das Wort &quot;EXPORT&quot; steht. Beispiele f&#xFC;r legale Filternamen sind z.B. &quot;Rich Text Format&quot;, &quot;HTML (StarWriter)&quot;, &quot;MS Word 95&quot;, &quot;writer_pdf_Export&quot;, etc.</p>
<h2 id="der-abschnitt-sachleitendeverfuegungen">Der Abschnitt SachleitendeVerfuegungen</h2>
<p>Der Abschnitt SachleitendeVerfuegungen enth&#xE4;lt Attribute, &#xFC;ber die das Verhalten der Funktionen der Sachleitenden Verf&#xFC;gunen gesteuert werden k&#xF6;nnen. Der Abschnitt hat folgenden Aufbau:</p>
<pre><code>SachleitendeVerfuegungen(
  NUMBERS &quot;&lt;zahlenformat&gt;&quot;
  ABDRUCK_NAME &quot;&lt;alternative-Bezeichnung&gt;&quot;

  ALL_VERSIONS_HIGHLIGHT_COLOR &quot;&lt;farbe&gt;&quot;
  NOT_IN_ORIGINAL_HIGHLIGHT_COLOR &quot;&lt;farbe&gt;&quot;
  ORIGINAL_ONLY_HIGHLIGHT_COLOR &quot;&lt;farbe&gt;&quot;
  DRAFT_ONLY_HIGHLIGHT_COLOR &quot;&lt;farbe&gt;&quot;
  COPY_ONLY_HIGHLIGHT_COLOR &quot;&lt;farbe&gt;&quot;
)
</code></pre><p>Das Attribut NUMBERS: Steuert die Darstellung der Ziffern von Verf&#xFC;gungspunkten und kann entweder die Werte &quot;roman&quot; (I., II., III., ...) oder &quot;arabic&quot; (1., 2., 3., ...) enthalten. Fehlt das Attribut, so ist &quot;roman&quot; Standardeinstellung.</p>
<p>Das Attribut ABDRUCK_NAME: Erm&#xF6;glicht die Definition einer alternativen Bezeichnung f&#xFC;r &quot;Abdruck&quot;, so dass bei Abdr&#xFC;cken z.B. der Text &quot;2. Kopie von 1.&quot; angezeigt werden k&#xF6;nnte. Fehlt dieses Attribut, so gilt die Standardeinstellung &quot;Abdruck&quot;.</p>
<p>Die Attribute *_HIGHLIGHT_COLOR &quot;&lt;farbe&gt;&quot;: &#xDC;ber die Attribute *_HIGHLIGHT_COLOR k&#xF6;nnen Hintergrundfarben vergeben werden, mit denen die <a href="Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.html#die-schaltfl&#xE4;chen-zur-drucksteuerung-einzelner-bl&#xF6;cke">Bl&#xF6;cke zur Drucksteuerung</a> der Sachleitenden Verf&#xFC;gungen hinterlegt werden k&#xF6;nnen, um sie optisch abzuheben und damit leichter orten zu k&#xF6;nnen. Die Farbe &lt;farbe&gt; wird als Hex-Zahl in der Form AARRGGBB (A=Alpha, R=Rot, G=Gr&#xFC;n, B=Blau) beschrieben (z.B. entspricht &quot;00ff0000&quot; der Farbe rot). F&#xFC;hrende Nullen k&#xF6;nnen dabei weggelassen werden - so kann die vorherige Beispielzahl auch als &quot;ff0000&quot; beschrieben werden. Um den Druckblock ohne farbliche Markierung erscheinen zu lassen, ist der Wert <strong>&quot;none&quot;</strong> zu verwenden. Der vordere Teil des Attributnamens (z.B. ALL_VERSIONS) ist analog zu den Namen der entsprechenden <a href="Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.html#">Dokumentkommandos</a> benannt. Beim Drucken der Sachleitenden Verf&#xFC;gungen werden die in *_HIGHLIGHT_COLOR gesetzten Farben <strong>nicht</strong> mit ausgedruckt.</p>
<p>Ein Beispielabschnitt sieht wie folgt aus:</p>
<pre><code>SachleitendeVerfuegungen(
  NUMBERS &quot;arabic&quot;
  ABDRUCK_NAME &quot;Kopie&quot;

  ALL_VERSIONS_HIGHLIGHT_COLOR &quot;ff0000&quot;
  NOT_IN_ORIGINAL_HIGHLIGHT_COLOR &quot;00ff00&quot;
  ORIGINAL_ONLY_HIGHLIGHT_COLOR &quot;ff00ff&quot;
  DRAFT_ONLY_HIGHLIGHT_COLOR &quot;0000ff&quot;
  COPY_ONLY_HIGHLIGHT_COLOR &quot;b8ffb8&quot;
)
</code></pre><p>Verwendet arabische Ziffern f&#xFC;r die Z&#xE4;hlung der Verf&#xFC;gungspunkte und schreibt f&#xFC;r Abdr&#xFC;cke immer &quot;1. Kopie von 2.&quot;, statt &quot;II. Abdruck von I.&quot;. Wird nun z.B. &#xFC;ber die Schaltfl&#xE4;che <a href="Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.html#schaltfl&#xE4;che-immer-drucken">Block: immer drucken</a> ein Block &quot;immer Drucken&quot; (repr&#xE4;sentiert durch das <a href="Dokumentkommandos_des_WollMux.html#das-kommando-allversions">Dokumentkommando allVersions</a>) eingef&#xFC;gt, so wird dieser Block mit der Hintergrundfarbe hinterlegt, die in ALL_VERSIONS_HIGHLIGHT_COLOR definiert ist (in diesem Fall rot).</p>
<p>Innerhalb der Konfigurationsdatei k&#xF6;nnen mehrere Abschnitte <em>SachleitendeVerfuegungen</em> vorkommen. Der WollMux verwendet dabei immer die zuletzt gesetzten Werte. So ist es z.B. m&#xF6;glich, zentrale Vorgaben zu machen und diese an einer sp&#xE4;teren Stelle an speziellere Bed&#xFC;rfnisse anzupassen.</p>
<h2 id="lokalisierung">Lokalisierung</h2>
<h3 id="automatische-anpassungen">Automatische Anpassungen</h3>
<p>Der WollMux passt sich automatisch an diverse regionsspezifische Merkmale an.</p>
<h4 id="dezimaltrennzeichen">Dezimaltrennzeichen</h4>
<p><a href="#arithmetik">WollMux-Funktionen</a> verwenden automatisch das f&#xFC;r die in LibreOffice eingestellte Region passende Dezimaltrennzeichen (normalerweise Punkt oder Komma).</p>
<h3 id="der-abschnitt-l10n">Der Abschnitt L10n</h3>
<p>&#xDC;ber den Abschnitt <em>L10n</em> in der <code>wollmux.conf</code> k&#xF6;nnen manuelle Lokalisierungsanpassungen vorgenommen werden.</p>
<h4 id="unterabschnitt-messages">Unterabschnitt Messages</h4>
<p>Der Unterabschnitt <em>Messages</em> ist verantwortlich f&#xFC;r die &#xDC;bersetzung der vom WollMux angezeigten Texte, inklusive der Beschriftung von Buttons, Men&#xFC;s,... Folgendes Beispiel demonstriert seinen Aufbau:</p>
<pre><code>Messages(
       original &quot;Bearbeiten...&quot;    # Originaltext, normalerweise deutsch
         en &quot;Edit...&quot;              # &#xDC;bersetzung in Sprache &quot;en&quot;(glisch)
         nl &quot;Wijzigen...&quot;          # &#xDC;bersetzung in Sprache &quot;n&quot;(ieder)&quot;l&quot;(&#xE4;ndisch)

       original &quot;Welchen Absender m&#xF6;chten Sie f&#xFC;r Ihre Briefk&#xF6;pfe verwenden ?&quot;
         en &quot;Which sender do you want to use in your letters?&quot;
         nl &quot;Welk afzender willt u voor de briefhoofden gebruiken?&quot;

       original &quot;Schlie&#xDF;en&quot;
         en &quot;Close&quot;
         nl &quot;Sluiten&quot;
)
</code></pre><p>Der WollMux beachtet die folgenden Quellen zur Bestimmung der zu verwendenden Sprache. Quellen mit h&#xF6;herer Nummer &#xFC;berschreiben jeweils die Auswahl durch Quellen mit niedrigerer Nummer.</p>
<ol>
<li>In LibreOffice eingestellte Sprache</li>
<li>Umgebungsvariable <code>LC_MESSAGES</code> (Zus&#xE4;tze wie &quot;.UTF-8&quot; oder &quot;@UTF-8&quot; werden ignoriert)</li>
</ol>
<p>&#xDC;ber den Abschnitt LanguageAliases (siehe unten) lassen sich verschiedene K&#xFC;rzel auf die selbe Sprache abbilden.</p>
<h4 id="unterabschnitt-languagealiases">Unterabschnitt LanguageAliases</h4>
<p>Teilweise gibt es verschiedene Sprachk&#xFC;rzel, die die selbe Sprache beschreiben oder Sprachk&#xFC;rzel, die fast identische Sprachen bezeichnen. Um nicht die selben &#xDC;bersetzungen mehrfach speichern zu m&#xFC;ssen, l&#xE4;sst sich &#xFC;ber LanguageAliases festlegen, dass wenn Sprache X eingestellt ist, die Meldungen zu Sprache Y verwendet werden sollen, <em>wenn keine spezielle Meldung f&#xFC;r Sprache X vorhanden ist</em>. Die Verwendung eines Aliases verhindert also nicht die Verwendung spezifischer Texte. Es ist dadurch m&#xF6;glich, z.B. f&#xFC;r die Sprache en_UK alle Meldungen aus der Sprache en_US zu &quot;erben&quot;, jedoch f&#xFC;r bestimmte Texte eine abweichende Meldung zu hinterlegen. Folgendes Beispiel demonstriert den Aufbau des Abschnitts:</p>
<pre><code>LanguageAliases(
   (&quot;en&quot;   &quot;en_US&quot; &quot;en_UK&quot; ...)
   (&quot;de&quot;   &quot;de_DE&quot; &quot;de_AT&quot; ...)
   ...
  )
</code></pre><p>Das erste Sprachk&#xFC;rzel der Zeile ist das K&#xFC;rzel unter dem die Texte im Abschnitt <em>Messages</em> hinterlegt sind. Alle folgenden K&#xFC;rzel sind die Sprachen f&#xFC;r die (in Abwesenheit spezifischer Eintr&#xE4;ge in <em>Messages</em>) ebenfalls die selben Texte verwendet werden sollen.</p>
<h2 id="dokumentaktionen">Dokumentaktionen</h2>
<p>Der Abschnitt <em>Dokumentaktionen</em> bietet die M&#xF6;glichkeit, dynamisch zu steuern, wie der WollMux Dokumente und Vorlagen verarbeitet. Sein Aufbau entspricht dem des Abschnitts <em><a href="#funktionen">Funktionen</a></em>.</p>
<pre><code>Dokumentaktionen(
  DMS(
    SELECT(
       # Falls die Benutzervariable FSC_CFGMUENCHEN_... vorhanden und leer ist =&gt; Vorlage bearbeiten
      IF(STRCMP(VALUE &quot;User/FSC_CFGMUENCHEN_15_1700_DocumentObjname&quot; &quot;&quot;) THEN &quot;noaction&quot;)
       # Falls die Benutzervariable FSC_CFGMUENCHEN_... vorhanden und nicht leer ist
       #   =&gt; Wir sind Sachbearbeiter und wollen Expansionen und FormularGUI haben.
      ELSE &quot;allactions&quot;
       # Falls die Benutzervariable FSC_CFGMUENCHEN_... *nicht* vorhanden ist, bricht SELECT
       # bereits beim ersten IF ab (weil STRCMP einen Fehler liefert weil VALUE einen Fehler liefert)
       # und liefert den ONERROR-Wert zur&#xFC;ck. Leerstring bedeutet =&gt; Diese Dokumentaktionen-Funktion
       # hat keine Meinung dazu, wie das Dokument verarbeitet werden soll.
      ONERROR &quot;&quot;
    )
  )
)
</code></pre><ul>
<li><p>Die WollMux-Funktionen in diesem Abschnitt werden der Reihe nach aufgerufen, bevor der WollMux das Dokument bearbeitet.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Bestimmte, teils auch ver&#xE4;ndernde, Handlungen f&#xFC;hrt der WollMux noch vorher aus.</p>
</blockquote>
</li>
<li><p>Die erste Funktion, die einen Wert ungleich leer zur&#xFC;ckliefert bestimmt, wie der WollMux das Dokument behandeln soll. Weitere Funktionen werden dann nicht aufgerufen.</p>
</li>
<li>Gibt die Funktion den Wert &quot;noaction&quot; zur&#xFC;ck, behandelt der WollMux das Dokument wie eine zum Bearbeiten ge&#xF6;ffnete Vorlage, d.h. es werden weder Expansionen ausgef&#xFC;hrt noch Werte eingef&#xFC;gt noch wird eine FormularGUI gestartet.</li>
<li>Gibt die Funktion den Wert &quot;allactions&quot; zur&#xFC;ck, f&#xFC;hrt der WollMux alle sinnvollen Aktionen auf dem Dokument aus, auch wenn dies ansonsten nicht geschehen w&#xE4;re (z.B. bei einer zum Bearbeiten ge&#xF6;ffneten Vorlage). Unsinnige Aktionen, wie das Anzeigen einer FormularGUI bei einem Dokument ohne Formularbeschreibung, werden nicht durchgef&#xFC;hrt.</li>
<li>In den Funktionen des Dokumentaktionen-Abschnitts wird die <a href="Konfigurationsdatei_wollmux.conf#VALUE_.3CArgument.3E">VALUE Grundfunktion</a> wie folgt verwendet:<ul>
<li>Das Argument ist in der Form &quot;&lt;Namensraum&gt;/&lt;id&gt;&quot;.</li>
<li>Derzeit wird f&#xFC;r &lt;Namensraum&gt; nur &quot;User&quot; unterst&#xFC;tzt, was auf Benutzervariablen (siehe Feldbefehle) zugreift. Die id ist in dem Fall der Variablenname.</li>
</ul>
</li>
</ul>
<h2 id="optionale-funktionen-der-wollmux-sidebar">Optionale Funktionen der WollMux-Sidebar</h2>
<p>Folgende Funktionen der WollMux-Sidebar sind optional und k&#xF6;nnen &#xFC;ber die Konfigurationsdatei <em>wollmux.conf</em> ein- oder ausgeschalten werden. Diese Einstellungen sind in der Regel f&#xFC;r Entwickler, f&#xFC;r die Fehlersuche oder die Evaluierung experimenteller Funktionen interessant:</p>
<h3 id="die-option-allowuserconfig">Die Option ALLOW_USER_CONFIG</h3>
<p>&#xDC;ber die Option ALLOW_USER_CONFIG kann gesteuert werden, ob die <a href="WollMuxBar#Konfiguration">Konfigurationsdatei <em>wollmuxbar.conf</em></a> beim Starten der WollMux-Sidebar ausgewertet werden darf, oder nicht. Ist diese Option deaktiviert, so wird die Konfiguration der WollMux-Sidebar ausschlie&#xDF;lich aus der Konfigurationsdatei <em>wollmux.conf</em> bezogen und die Einstellung aus der Datei <em>wollmuxbar.conf</em> ignoriert (falls die Datei existiert).</p>
<p><strong>Die Option ist standardm&#xE4;&#xDF;ig aktiviert</strong>, d.h. die Datei <em>wollmuxbar.conf</em> wird standardm&#xE4;&#xDF;ig ausgewertet. Sie kann &#xFC;ber folgende Zeile in der Konfigurationsdatei <em>wollmux.conf</em> deaktiviert werden:</p>
<p><code>ALLOW_USER_CONFIG &quot;false&quot;</code></p>
<p>Hintergrund dieser Option: Da die Einstellungen in der Datei <em>wollmuxbar.conf</em> grunds&#xE4;tzlich Vorrang vor den Einstellungen in der Datei <em>wollmux.conf</em> haben, besteht das Risiko, dass Benutzer ungewollt eine vorgegebene Einstellung aus den Referaten &#xFC;berschreiben. Durch Deaktivierung der Option ALLOW_USER_CONFIG kann dies (dauerhaft oder zum Zweck der Fehlersuche) sicher vermieden werden.</p>
<h3 id="die-option-allowexternalwollmux">Die Option ALLOW_EXTERNAL_WOLLMUX</h3>
<p>Die Option ALLOW_EXTERNAL_WOLLMUX unterst&#xFC;tzt die WollMux-Entwickler beim Debugging und ist auf der Seite <a href="Wollmux-Debugging.md#verwendung">Wollmux-Debugging - Einstellungen_in_der_wollmux.conf</a> ausf&#xFC;hrlicher beschrieben.</p>
<p><strong>Sie ist standardm&#xE4;&#xDF;ig deaktiviert</strong> und kann &#xFC;ber folgende Zeile in der Konfigurationsdatei <em>wollmux.conf</em> aktiviert werden:</p>
<p><code>ALLOW_EXTERNAL_WOLLMUX &quot;true&quot;</code></p>
<h2 id="formularmax4000">FormularMax4000</h2>
<p>Im Abschnitt <em>FormularMax4000</em> k&#xF6;nnen Einstellungen zum <a href="FormularMax_4000.html">FormularMax 4000</a> get&#xE4;tigt werden.</p>
<h3 id="unterabschnitt-standardelemente">Unterabschnitt <em>Standardelemente</em></h3>
<p>Im Unterabschnitt <em>Standardelemente</em> des Abschnitts <em>FormularMax4000</em> wird festgelegt, welche Eintr&#xE4;ge im Men&#xFC; <em>Einf&#xFC;gen/Standardelemente einf&#xFC;gen</em> vorhanden sein sollen. Folgendes Beispiel demonstriert seinen Aufbau (eine Erkl&#xE4;rung der im Beispiel verwendeten Formular-GUI-Beschreibung findet sich unter <a href="okumentkommandos_des_WollMux.md#beschreibung-der-formular-gui">Dokumentkommandos des WollMux</a>):</p>
<pre><code>FormularMax4000(
 Standardelemente(
   (  LABEL &quot;Empf&#xE4;ngerauswahl-Tab&quot;
      Tab(
        Empfaengerauswahl(
          TITLE &quot;Empf&#xE4;nger&quot;
          CLOSEACTION &quot;abort&quot;
          TIP &quot;Hier k&#xF6;nnen Sie den Empf&#xE4;nger ausw&#xE4;hlen&quot;
          HOTKEY &quot;E&quot;

          Eingabefelder(
            (LABEL &quot;Zustellvermerk&quot; TYPE &quot;combobox&quot; ID
               &quot;EmpfaengerZustellvermerk&quot; VALUES(&quot;&quot;, &quot;Einschreiben&quot; &quot;Einschreiben eigenh&#xE4;ndig&quot; &quot;Einschreiben mit R&#xFC;ckschein&quot; &quot;Einschreiben eigenh&#xE4;ndig mit R&#xFC;ckschein&quot; &quot;elektronischer Postzustellungsauftrag&quot; &quot;gegen Empfangsbekenntnis&quot; &quot;gegen Postzustellungsurkunde&quot; &quot;per E-Mail&quot; &quot;per Telefax&quot; &quot;&#xF6;ffentliche Zustellung&quot;))

            (LABEL &quot;Empf&#xE4;nger Zeile 1&quot; TYPE &quot;textfield&quot; ID &quot;EmpfaengerZeile1&quot;
               AUTOFILL(DIALOG(&quot;Empfaengerauswahl&quot;,&quot;EmpfaengerZeile1&quot;))
            )
            (LABEL &quot;Empf&#xE4;nger Zeile 2&quot; TYPE &quot;textfield&quot; ID &quot;EmpfaengerZeile2&quot;
               AUTOFILL(DIALOG(&quot;Empfaengerauswahl&quot;,&quot;EmpfaengerZeile2&quot;))
            )
            (LABEL &quot;Empf&#xE4;nger Zeile 3&quot; TYPE &quot;textfield&quot; ID &quot;EmpfaengerZeile3&quot;
               AUTOFILL(DIALOG(&quot;Empfaengerauswahl&quot;,&quot;EmpfaengerZeile3&quot;))
            )
            (LABEL &quot;Empf&#xE4;nger Zeile 4&quot; TYPE &quot;textfield&quot; ID &quot;EmpfaengerZeile4&quot;
               AUTOFILL(DIALOG(&quot;Empfaengerauswahl&quot;,&quot;EmpfaengerZeile4&quot;))
            )
            (LABEL &quot;Empf&#xE4;nger Zeile 5&quot; TYPE &quot;textfield&quot; ID &quot;EmpfaengerZeile5&quot;
               AUTOFILL(DIALOG(&quot;Empfaengerauswahl&quot;,&quot;EmpfaengerZeile5&quot;))
            )
            (LABEL &quot;Empf&#xE4;nger Zeile 6&quot; TYPE &quot;textfield&quot; ID &quot;EmpfaengerZeile6&quot;
               AUTOFILL(DIALOG(&quot;Empfaengerauswahl&quot;,&quot;EmpfaengerZeile6&quot;))
            )
            (LABEL &quot;Ihr Schreiben vom&quot; TYPE &quot;textfield&quot; ID &quot;IhrSchreibenVom&quot;)
            (LABEL &quot;Ihr Zeichen&quot; TYPE &quot;textfield&quot; ID &quot;IhrZeichen&quot;)
            (LABEL &quot;Unser Zeichen&quot; TYPE &quot;textfield&quot; ID &quot;UnserZeichen&quot;)
          )
          Buttons(
            (LABEL &quot;Abbrechen&quot;  TYPE &quot;button&quot; HOTKEY &quot;A&quot;  ACTION &quot;abort&quot; TIP &quot;Zum Abbrechen hier klicken&quot;)
            (TYPE &quot;glue&quot; MINSIZE &quot;20&quot;)
            (LABEL &quot;Adressauswahl&quot; TYPE &quot;button&quot; HOTKEY &quot;S&quot;  ACTION &quot;funcDialog&quot; DIALOG &quot;Empfaengerauswahl&quot; TIP &quot;Hier kommen Sie zur Empf&#xE4;ngerauswahl&quot;)
            (TYPE &quot;glue&quot; MINSIZE &quot;20&quot;)
            (LABEL &quot;Weiter-&gt;&quot;  TYPE &quot;button&quot; HOTKEY &quot;W&quot;  ACTION &quot;nextTab&quot;)
          )
        )
     )
   )

   (  LABEL &quot;Abbrechen, &lt;-Zur&#xFC;ck, Weiter-&gt;&quot;
      Buttons(
       (LABEL &quot;Abbrechen&quot;  TYPE &quot;button&quot; HOTKEY &quot;A&quot;  ACTION &quot;abort&quot;)
       (TYPE &quot;glue&quot; MINSIZE &quot;20&quot;)
       (LABEL &quot;&lt;-Zur&#xFC;ck&quot;  TYPE &quot;button&quot; HOTKEY &quot;Z&quot;  ACTION &quot;prevTab&quot;)
       (LABEL &quot;Weiter-&gt;&quot;  TYPE &quot;button&quot; HOTKEY &quot;W&quot;  ACTION &quot;nextTab&quot;)
      )
   )

   ( LABEL &quot;Abbrechen, &lt;-Zur&#xFC;ck, PDF, Drucken&quot;
     Buttons(
       (LABEL &quot;Abbrechen&quot;  TYPE &quot;button&quot; HOTKEY &quot;A&quot;  ACTION &quot;abort&quot;)
       (TYPE &quot;glue&quot; MINSIZE &quot;20&quot;)
       (LABEL &quot;Als Pdf speichern...&quot; TYPE &quot;button&quot; HOTKEY &quot;S&quot; ACTION &quot;form2PDF&quot;)
       (TYPE &quot;glue&quot; MINSIZE &quot;20&quot;)
       (LABEL &quot;&lt;-Zur&#xFC;ck&quot;  TYPE &quot;button&quot; HOTKEY &quot;Z&quot;  ACTION &quot;prevTab&quot;)
       (LABEL &quot;Drucken...&quot; TYPE &quot;button&quot; HOTKEY &quot;D&quot; ACTION &quot;printForm&quot;)
     )
   )

   ( LABEL &quot;Abbrechen, &lt;-Zur&#xFC;ck, Speichern, Drucken&quot;
     Buttons(
       (LABEL &quot;Abbrechen&quot;  TYPE &quot;button&quot; HOTKEY &quot;A&quot;  ACTION &quot;abort&quot;)
       (TYPE &quot;glue&quot; MINSIZE &quot;20&quot;)
       (LABEL &quot;Speichern...&quot; TYPE &quot;button&quot; HOTKEY &quot;S&quot; ACTION &quot;save&quot;)
       (TYPE &quot;glue&quot; MINSIZE &quot;20&quot;)
       (LABEL &quot;&lt;-Zur&#xFC;ck&quot;  TYPE &quot;button&quot; HOTKEY &quot;Z&quot;  ACTION &quot;prevTab&quot;)
       (LABEL &quot;Drucken...&quot; TYPE &quot;button&quot; HOTKEY &quot;D&quot; ACTION &quot;printForm&quot;)
     )
   )
 )
)
</code></pre><p><category:eierlegender_wollmux> <category:handbuch_des_wollmux></category:handbuch_des_wollmux></category:eierlegender_wollmux></p>
<script type="text/javascript">var className='toc';</script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.html" class="navigation navigation-prev " aria-label="Previous page: Hilfen für Sachleitende Verfügungen verwenden">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Schnittstellen_des_WollMux_fuer_Experten.html" class="navigation navigation-next " aria-label="Next page: Schnittstellen des WollMux für Experten">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Konfigurationsdatei wollmux.conf","level":"1.2.1.11","depth":3,"next":{"title":"Schnittstellen des WollMux für Experten","level":"1.2.1.12","depth":3,"path":"18.1/Schnittstellen_des_WollMux_fuer_Experten.md","ref":"18.1/Schnittstellen_des_WollMux_fuer_Experten.md","articles":[]},"previous":{"title":"Hilfen für Sachleitende Verfügungen verwenden","level":"1.2.1.10","depth":3,"path":"18.1/Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.md","ref":"18.1/Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.md","articles":[]},"dir":"ltr"},"config":{"plugins":["atoc","collapsible-menu","forkmegithub","richquotes","redirect","splitter","back-to-top-button","link-checker"],"root":"markdown","styles":{"website":"styles/website.css"},"pluginsConfig":{"link-checker":{"dieOnError":false,"fqdn":[]},"collapsible-menu":{},"atoc":{"addClass":true,"className":"toc"},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"richquotes":{},"highlight":{},"back-to-top-button":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"redirect":{},"forkmegithub":{"color":"gray","url":"https://github.com/WollMux/WollMux"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Landeshauptstadt München","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"Hauptseite.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"WollMux Handbuch","language":"de","links":{"sidebar":{"Homepage":"http://www.wollmux.org"}},"gitbook":"3.x.x"},"file":{"path":"18.1/Konfigurationsdatei_wollmux_conf.md","mtime":"2020-08-03T14:23:40.758Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-08-04T06:36:25.750Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-atoc/atoc.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-forkmegithub/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

