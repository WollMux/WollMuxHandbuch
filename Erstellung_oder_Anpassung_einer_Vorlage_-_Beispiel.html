
<!DOCTYPE HTML>
<html lang="de" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Erstellung oder Anpassung einer Vorlage - Beispiel · WollMux Handbuch</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        <meta name="author" content="Landeshauptstadt München">
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-atoc/atoc.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-forkmegithub/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="styles/website.css">
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Fehler_im_WollMux_melden.html" />
    
    
    <link rel="prev" href="Dokumentkommandos_des_WollMux.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Suchbegriff eingeben" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://www.wollmux.org" target="_blank" class="custom-link">Homepage</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="Hauptseite.html">
            
                <a href="Hauptseite.html">
            
                    
                    Einführung
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="News.html">
            
                <a href="News.html">
            
                    
                    News
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Eierlegender_WollMux.html">
            
                <a href="Eierlegender_WollMux.html">
            
                    
                    Eierlegender WollMux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="Features.html">
            
                <a href="Features.html">
            
                    
                    Features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="Download.html">
            
                <a href="Download.html">
            
                    
                    Download
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="Repository.html">
            
                <a href="Repository.html">
            
                    
                    Code Repository
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="Releasenotes_16.04.html">
            
                <a href="Releasenotes_16.04.html">
            
                    
                    Releasenotes
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="Releasenotes_16.04.html">
            
                <a href="Releasenotes_16.04.html">
            
                    
                    Releasenotes 16.04
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="Releasenotes_15.04.html">
            
                <a href="Releasenotes_15.04.html">
            
                    
                    Releasenotes 15.04
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="Mailinglisten.html">
            
                <a href="Mailinglisten.html">
            
                    
                    Mailinglisten
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="WollMux-Schulungen.html">
            
                <a href="WollMux-Schulungen.html">
            
                    
                    WollMux Schulungen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="Community-Mitglieder_und_Ansprechpartner.html">
            
                <a href="Community-Mitglieder_und_Ansprechpartner.html">
            
                    
                    Community Mitglieder und Ansprechpartner
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="1._WollMux_Community_Workshop.html">
            
                <a href="1._WollMux_Community_Workshop.html">
            
                    
                    1. WollMux Community Workshop
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="Handbuch_des_WollMux.html">
            
                <a href="Handbuch_des_WollMux.html">
            
                    
                    Handbuch des WollMux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="Bedienelemente_des_WollMux.html">
            
                <a href="Bedienelemente_des_WollMux.html">
            
                    
                    Bedienelemente des WollMux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="Bekannte_Probleme_mit_WollMux-Releases.html">
            
                <a href="Bekannte_Probleme_mit_WollMux-Releases.html">
            
                    
                    Bekannte Probleme mit WollMux Releases
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="Datenbanken_mit_dem_WollMux_verwenden.html">
            
                <a href="Datenbanken_mit_dem_WollMux_verwenden.html">
            
                    
                    Datenbanken mit dem WollMux verwenden
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="Dokumentkommandos_des_WollMux.html">
            
                <a href="Dokumentkommandos_des_WollMux.html">
            
                    
                    Dokumentkommandos des WollMux
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.5" data-path="Erstellung_oder_Anpassung_einer_Vorlage_-_Beispiel.html">
            
                <a href="Erstellung_oder_Anpassung_einer_Vorlage_-_Beispiel.html">
            
                    
                    Erstellung oder Anpassung einer Vorlage - Beispiel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="Fehler_im_WollMux_melden.html">
            
                <a href="Fehler_im_WollMux_melden.html">
            
                    
                    Fehler im WollMux Melden
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="Format_von_WollMux-Config-Dateien.html">
            
                <a href="Format_von_WollMux-Config-Dateien.html">
            
                    
                    Format von WollMux Config Dateien
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="Formatvorlagen.html">
            
                <a href="Formatvorlagen.html">
            
                    
                    Formatvorlagen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="FormularMax_4000.html">
            
                <a href="FormularMax_4000.html">
            
                    
                    FormularMax 4000
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="Fragen_rund_um_Datenquellen.html">
            
                <a href="Fragen_rund_um_Datenquellen.html">
            
                    
                    Fragen rund um Datenquellen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="Funktionen_des_WollMux_in_der_Praxis.html">
            
                <a href="Funktionen_des_WollMux_in_der_Praxis.html">
            
                    
                    Funktionen des WollMux in der Praxis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="Funktionen_im_WollMux_-_Workshop.html">
            
                <a href="Funktionen_im_WollMux_-_Workshop.html">
            
                    
                    Funktionen im WollMux - Workshop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.13" data-path="Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.html">
            
                <a href="Hilfen_fuer_Sachleitende_Verfuegungen_verwenden.html">
            
                    
                    Hilfen für Sachleitende Verfügungen verwenden
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.14" data-path="Konfiguration_des_WollMux_in_Ihrem_Referat.html">
            
                <a href="Konfiguration_des_WollMux_in_Ihrem_Referat.html">
            
                    
                    Konfiguration des WollMux in ihrem Referat
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.15" data-path="Konfigurationsdatei_wollmux_conf.html">
            
                <a href="Konfigurationsdatei_wollmux_conf.html">
            
                    
                    Konfigurationsdatei wollmux.conf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.16" data-path="Rebranding.html">
            
                <a href="Rebranding.html">
            
                    
                    Rebranding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.17" data-path="Repository.html">
            
                <a href="Repository.html">
            
                    
                    Repository
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.18" data-path="Schnittstellen_des_WollMux_fuer_Experten.html">
            
                <a href="Schnittstellen_des_WollMux_fuer_Experten.html">
            
                    
                    Schnittstellen des WollMux für Experten
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.19" data-path="Seriendruck_erweiterte_Funktion.html">
            
                <a href="Seriendruck_erweiterte_Funktion.html">
            
                    
                    Seriendruck, erweiterte Funktion
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.20" data-path="Seriendruckvorlagen_mit_dem_WollMux_erstellen.html">
            
                <a href="Seriendruckvorlagen_mit_dem_WollMux_erstellen.html">
            
                    
                    Seriendruckvorlagen mit dem WollMux erstellen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.21" data-path="Standardkonfiguration_des_WollMux.html">
            
                <a href="Standardkonfiguration_des_WollMux.html">
            
                    
                    Standardkonfiguration des WollMux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.22" data-path="Standardkonfiguration_des_WollMux_installieren_und_pflegen.html">
            
                <a href="Standardkonfiguration_des_WollMux_installieren_und_pflegen.html">
            
                    
                    Standardkonfiguration des WollMux installieren und pflegen
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.23" data-path="Textfragmente_im_WollMux.html">
            
                <a href="Textfragmente_im_WollMux.html">
            
                    
                    Textfragmente im WollMux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.24" data-path="WollMux_installieren.html">
            
                <a href="WollMux_installieren.html">
            
                    
                    WollMux installieren
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.24.1" data-path="WollMux_installieren_vor_Version_16.04.html">
            
                <a href="WollMux_installieren_vor_Version_16.04.html">
            
                    
                    WollMux installieren (vor Version 16.04)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.24.2" data-path="WollMux_installieren_vor_Version_16.04.html">
            
                <a href="WollMux_installieren_vor_Version_16.04.html">
            
                    
                    WollMux installieren (vor_Version 16.04a)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.25" data-path="WollMux_Komfortdruck_geht_nicht.html">
            
                <a href="WollMux_Komfortdruck_geht_nicht.html">
            
                    
                    WollMux Komfortdruck geht nicht (Problem Und Lösung)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.26" data-path="WollMux_kompilieren.html">
            
                <a href="WollMux_kompilieren.html">
            
                    
                    WollMux kompilieren
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.26.1" data-path="WollMux_kompilieren_vor_Version_16.04.html">
            
                <a href="WollMux_kompilieren_vor_Version_16.04.html">
            
                    
                    WollMux kompilieren (bis_Version 15.04a)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.26.2" data-path="WollMux_kompilieren_vor_Version_16.04.html">
            
                <a href="WollMux_kompilieren_vor_Version_16.04.html">
            
                    
                    WollMux kompilieren (vor_Version 16.04)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.26.3" data-path="WollMux_kompilieren_vor_Version_16.04.html">
            
                <a href="WollMux_kompilieren_vor_Version_16.04.html">
            
                    
                    WollMux kompilieren (vor_Version 16.04a)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.27" data-path="WollMux_manuell_installieren.html">
            
                <a href="WollMux_manuell_installieren.html">
            
                    
                    WollMux manuell installieren
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.28" data-path="WollMux_mit_LibreOffice_Portable.html">
            
                <a href="WollMux_mit_LibreOffice_Portable.html">
            
                    
                    WollMux mit LibreOffice Portable
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.29" data-path="Wollmux-Debugging.html">
            
                <a href="Wollmux-Debugging.html">
            
                    
                    WollMux Debugging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.30" data-path="WollMuxBar.html">
            
                <a href="WollMuxBar.html">
            
                    
                    WollMuxBar
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="./">
            
                <a href="./">
            
                    
                    Hidden
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Veröffentlicht mit GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Erstellung oder Anpassung einer Vorlage - Beispiel</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Dieser Artikel beschreibt anhand eines Beispiels die Erstellung eigener Vorlagen bzw. die Anpassung bestehender Vorlagen basierend auf der Seite <a href="Textfragmente_im_WollMux.html" title="wikilink">Textfragmente im WollMux</a>, die auch ausf&#xFC;hrliche Informationen zum neuen Konzept der sog. &quot;Textfragmente&quot; enth&#xE4;lt, die der WollMux unterst&#xFC;tzt.</p>
</blockquote>
<p>Als Beispiel dient die Vorlage f&#xFC;r den externen Briefkopf, die f&#xFC;r den
Wollmux neu - nach dem <a href="http://intranet.muenchen.de/?url=http://intranet.muenchen.de/basis/publ/erscheinungsbild/index.html" target="_blank">Visuellen Erscheinungsbild</a>
der Landeshauptstadt M&#xFC;nchen - erstellt wurde. Hinweise zur Gestaltung
des Briefkopfes sind im <a href="Leitfaden_zum_Dokumentenaustausch_zwischen_MS_Office_und_OOo#Erstellung_von_mit_MS_Office_austauschbaren_Vorlagen_in_Open_Office" title="wikilink">Leitfaden zum Dokumentenaustausch</a> zu finden. Deshalb geht der Artikel nur auf die Einbindung der
entsprechenden Daten &#xFC;ber <a href="Textfragmente_im_WollMux.html" title="wikilink">Textfragmente</a> in vorhandenden oder
neu erstellten Vorlagen ein.</p>
<h2 id="weitere-dokumentationen">Weitere Dokumentationen</h2>
<p>Hinweise zu den weiteren Dokumentationen zum Wollmux und zum Briefkopf
bzw. Formularsystem und welche davon sie f&#xFC;r welche Fragestellung
ben&#xF6;tigen, erfahren Sie im <a href="Handbuch_des_WollMux.html#wegweiser" title="wikilink">Wegweiser</a>.</p>
<h1 id="aufbau-des-externen-briefkopfs">Aufbau des externen Briefkopfs</h1>
<p>Der Briefkopf wurde so erstellt, dass er m&#xF6;glichst flexibel f&#xFC;r
Anpassungen von Inhalten ist. Alle Inhalte (bis auf den Schriftzug
&quot;Landeshaupstadt M&#xFC;nchen&quot;) werden &#xFC;ber Textfragmente, bzw. bei der
Referatsbezeichnung &#xFC;ber eine Textmarke, die auf eine Datenbank verweist
eingef&#xFC;gt. Die Vorlage besteht daher eigentlich &#xFC;berwiegend aus leeren
Rahmen, die die Textmarken enthalten. Die Textmarken werden beim
Generieren des Dokuments durch die Daten (aus verschiedenen
Datenquellen) ersetzt. Der gr&#xF6;sste Teil des Inhalts kommt dabei aus dem
LDAP, Teile der Daten kommen aber auch aus anderen Datenquellen, z.B.
kommen die &#xD6;PNV Verbindungen aus Textdateien.</p>
<p><strong>Abbildung 1</strong> zeigt die Briefkopfvorlage mit den Textmarken.</p>
<p><strong>Abbildung 2</strong> zeigt dann das daraus erzeugte fertige mit Daten
versehene Dokument.</p>
<p><img src="400px-Ext_Briefkopf_Textmarken.jpg" alt="**Abbildung 1: Vorlage f&#xFC;r den externen Briefkopf**" title="Abbildung 1: Vorlage f&#xFC;r den externen Briefkopf"><br>Abbildung 1   </p>
<p><img src="400px-Ext_Briefkopf_fertig.jpg" alt="**Abbildung 2: Der ausgef&#xFC;llte Briefkopf**" title="Abbildung 2: Der ausgef&#xFC;llte Briefkopf"><br>Abbildung 2</p>
<p>Die Textmarken verweisen auf andere Vorlagen, &#xFC;ber die der Briefkopf
dann bef&#xFC;llt wird. Der Briefkopf besteht somit eigentlich aus mehreren
Vorlagen, wobei die Vorlage mit dem Layout des Briefkopfes die
&quot;Mastervorlage&quot; ist. Der Gedanke dahinter ist, dass das Masterdokument
f&#xFC;r alle Referate gleich bleibt und nicht anpepasst werden muss. Die
&#xC4;nderungen, die in den Referaten erforderlich sind, sollen &#xFC;ber
Ver&#xE4;nderungen in den Textfragmenten vorgenommen werden k&#xF6;nnen. Dadurch
wird verhindert, dass es viele - teils unterschiedliche -
Briefkopfvorlagen f&#xFC;r eigentlich einen Externen Briefkopf gibt. Sollten
&#xC4;nderungen am Layout n&#xF6;tig sein, muss dies nur einmal zentral gemacht
werden.</p>
<p>In den n&#xE4;chsten Kapiteln werden die zwei M&#xF6;glichkeiten beschrieben, wie
die Textmarken im Masterdokument aufgebaut sind, um die Daten entweder
direkt oder &#xFC;ber Textfragmente einzuf&#xFC;gen.</p>
<h1 id="direkte-einbindung-von-datenfeldern">Direkte Einbindung von Datenfeldern</h1>
<p>Im Externen Briefkopf wird nur der Referatsname mit einem direkten
Verweis auf die Datenquelle eingef&#xFC;gt. Dies konnte so gel&#xF6;st werden, da
davon auszugehen ist, dass sich im Bereich des Referatsnamens keine
&#xC4;nderungen bzgl. des Erscheinungsbildes (bzw. der Formatierung) ergeben
werden. Ist dies nicht sicher, eignen sich Textfragmente besser, da sie
wesentlich flexibler angepasst werden k&#xF6;nnen. Nur beim direkten Einf&#xFC;gen
von Werten &#xFC;ber Textmarken wird die Formatierung direkt im
&quot;Masterdokument&quot; vorgenommen.</p>
<p>Die Textmarke sieht folgendermassen aus:</p>
<p><code>WM(CMD &apos;insertValue&apos; DB_SPALTE &apos;Referat&apos;)</code></p>
<p>Die Beschreibung zum Aufbau der Textmarke ist im Artikel <a href="Dokumentkommandos_des_WollMux.html#das-kommando-insertformvalue" title="wikilink">Dokumentkommandos des Wollmux</a>
zu finden. Im Externen Briefkopf wird mit dieser Textmarke automatisch
das zum aktuellen Absender passende Referat eingef&#xFC;gt.</p>
<p>Die Textmarken, die auf Datenquellen verweisen, sind ebenfalls in den
Textfragmenten zu finden; die Textfragmente fassen zusammengeh&#xF6;rende
Datenfelder f&#xFC;r bestimmte Rahmen im Briefkopf, z.B. Absenderdaten
zusammen und erleichtern somit die Anpassung der Briefkopfdaten.</p>
<p>Wie die Abbildung der Daten des LDAP auf die im BKS verwendete
Spaltenstruktur erfolgt, sieht man
<a href="Dokumentkommandos_des_WollMux.html#verwendete-felder-aus-dem-ldap" title="wikilink">hier</a>.</p>
<h1 id="erstellung-von-textfragmenten">Erstellung von Textfragmenten</h1>
<p>Die Erstellung von Textfragementen ist denkbar einfach. Sie ersetzen die
direkte Einbindung von Datenfeldern, indem sie zusammengeh&#xF6;rende Werte
quasi in andere Vorlagen (Textfragmente) auslagern. Dies gew&#xE4;hrleistet
eine hohe Flexibilit&#xE4;t im Bezug auf Anpassung von Formatierungen und
Anpassung/Erg&#xE4;nzung von Werten. Ein Beispiel f&#xFC;r den Aufbau eines
Textfragment sieht man in <strong>Abbildung 3</strong>.</p>
<p><img src="200px-Fragment_Absenderangaben.jpg" alt="**Abbildung 3: Aufbau eines Texfragments**" title="Abbildung 3: Aufbau eines Texfragments"><br>Abbildung 3</p>
<p><strong>Aufbau des Textfragments:</strong></p>
<ul>
<li>in diesem Beispiel ist die erste Leerzeile f&#xFC;r die Leerzeile zwischen der Angabe zur Hauptabteilung und den restlichen Adressangaben</li>
<li>bevor die Auflistung der Platzhalter beginnt, ist immer eine Leerzeile n&#xF6;tig, genauso am Ende des Textfragments, werden diese weggelassen, kann es passieren, dass die erste oder letzte Zeile des Fragements im Masterdokument falsch formatiert wird.</li>
<li>in diesem Beispiel sind die Platzhalter zur besseren Unterscheidung immer mit &quot;&lt;...&gt;&quot; gekennzeichnet</li>
<li>damit die Darstellung auch unter MS Word noch passt, ist am Ende jeder Zeilen nach der letzten Textmarke ein Leerzeichen einzuf&#xFC;gen, ansonsten wird der Zeilenumbruch in MS Word &quot;verschluckt&quot;; <strong>ab der Wollmux Version 0.96 sind keine Leerzeichen in den Vorlagen mehr erforderlich</strong></li>
<li>Die Formatierung (&#xFC;ber Formatvorlage) erfolgt im Textfragment, allerdings sind die verwendeten Formatvorlagen ausgelagert, um sie einfacher f&#xFC;r mehrere Vorlagen verwenden zu k&#xF6;nnen. Genaueres steht weiter unten unter <a href="#formatvorlagen" title="wikilink"> Hinweise und Tips</a></li>
</ul>
<p>Die Textmarken entsprechen der Syntax wie sie bereits oben erw&#xE4;hnt ist,
z.B. f&#xFC;gt folgende Textmarke die Strasse f&#xFC;r die Postanschrift ein:</p>
<p><code>WM(CMD&apos;insertValue&apos; DB_SPALTE&apos;Postanschrift&apos;)</code></p>
<h1 id="einbinden-von-textfragmenten">Einbinden von Textfragmenten</h1>
<hr>
<h2 id="-achtung-dieser-punkt-ist-veraltet-und-bedarf-einer-&#xFC;berarbeitung">  <strong>Achtung: Dieser Punkt ist veraltet und bedarf einer &#xDC;berarbeitung</strong></h2>
<p>Nachdem das Textfragment erstellt wurde muss es nat&#xFC;rlich noch in das
Masterdokument &quot;eingebunden&quot; werden. Dies geschieht wieder &#xFC;ber
Textmarken. Dazu geht man folgendermassen vor, wobei die Reihenfolge
(bei 1. - 3.) nicht zwingend ist:</p>
<ol>
<li><p>Im Masterdokument (bzw. in einem Textfragment) wird eine Textmarke
angelegt mit folgendem Aufbau:</p>
<p><code>WM(CMD &apos;insertFrag&apos; FRAG_ID &apos;Adresse_Angaben&apos;)</code></p>
<p>Der Befehl wird in <a href="Dokumentkommandos_des_WollMux.html#das-kommando-insertfrag" title="wikilink">Dokumentkommandos des    Wollmux</a> erl&#xE4;utert.</p>
</li>
<li><p>Nat&#xFC;rlich funktioniert das Ganze so noch nicht, da die FRAG_ID
&apos;Adresse_Angabe&apos; undefiniert ist. Folgender Schritt ist deshalb
noch notwendig: in der
<a href="http://limux.tvc.muenchen.de/ablage/sonstiges/wollmux/Textfragmente.conf" target="_blank">Textfragmente.conf</a>
ist ein entsprechender Eintrag vorzunehmen, der der FRAG_ID eine
entsprechende Datei bzw. Vorlage zuweist. In diesem Fall schaut die
entsprechende Zeile in der
<a href="http://limux.tvc.muenchen.de/ablage/sonstiges/wollmux/Textfragmente.conf" target="_blank">Textfragmente.conf</a>
so aus:</p>
<p><code>(FRAG_ID &quot;Adresse_Angaben&quot; URL &quot;${StadtweiteVorlagen}/WOL_Briefkopf-Fragment-Absenderadresse_v1_2005-11-21.ott&quot;)</code></p>
<p>Es ist empfehlenswert die Eintr&#xE4;ge mit einem Kommentar zu versehen,
da man aus dem Dateinamen nicht unbedingt erkennen kann, f&#xFC;r was das
Textfragment steht.</p>
</li>
<li><p>Die Datei muss in das Verzeichnis, auf das {StadtweiteVorlagen}
verweist, gestellt werden, damit die entsprechende Aufl&#xF6;sung &#xFC;ber
die Textfragmente.conf auch funktionieren kann.</p>
</li>
<li><p>Nach dem Vornehmen dieser &#xC4;nderungen muss OpenOffice.org komplett
neu gestartet werden, dazu m&#xFC;ssen alle offenen OpenOffice Fenster
und auch der Schnellstarter beendet werden.</p>
</li>
<li><p>Bei Problemen empfiehlt es sich, die Meldungen in der wollmux.log im
entsprechenden Benutzerverzeichnis anzusehen.</p>
</li>
</ol>
<h1 id="mischen-von-dokumentinhalten-und-briefk&#xF6;pfen">Mischen von Dokumentinhalten und Briefk&#xF6;pfen</h1>
<p>Der Wollmux erm&#xF6;glicht es Inhalte von Dokumenten mit Briefk&#xF6;pfen zu
mischen und so Briefe oder Dokumente zu erstellen, die mit aktuellen
Benutzerdaten bef&#xFC;llt werden k&#xF6;nnen. Dazu geht man folgenderma&#xDF;en:</p>
<ul>
<li>In der WollMuxLeiste im Men&#xFC; Standard im Untermen&#xFC; Mischvorlagen die
passende Vorlage w&#xE4;hlen.</li>
<li>Es &#xF6;ffnet sich ein Dokument, das im ersten Absatz einen Platzhalter
enth&#xE4;lt, z.B. &quot;&lt;externerBriefkopf&gt;&quot;. Dieser ganze erste Absatz und
der darauffolgende leere Absatz d&#xFC;rfen nicht bearbeitet werden.</li>
</ul>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> Wenn Sie beim &#xD6;ffnen der Mischvorlage nicht den oben erw&#xE4;hnten Platzhalter sehen, sondern ein kompletter Briefkopf aufgebaut wird, dann liegt ein Fehler vor. Generell ist es so, dass Sie beim Bearbeiten einer Vorlage <strong>niemals</strong> Sachbearbeiterdaten sehen sollten. <strong>Wenn Sie einen Briefkopf mit Sachbearbeiterdaten sehen, so werden diese beim n&#xE4;chsten Speichern fest in das Dokument integriert. Der WollMux kann solche Vorlagen <em>nicht</em> mit neuen Sachbearbeiterdaten bef&#xFC;llen.</strong> Das Mischprinzip wird dadurch ausgehebelt. Dies sollte unbedingt vermieden werden.</p>
</blockquote>
<ul>
<li>F&#xFC;gen Sie nun anstelle des Erkl&#xE4;rungstextes Ihren gew&#xFC;nschten Text
f&#xFC;r die Vorlage ein.</li>
<li>Speichern Sie die Vorlage nun: <em><beliebiger name="">.ott</beliebiger></em></li>
</ul>
<blockquote class="clearfix alert alert-warning"><strong class="fa fa-2x fa-exclamation-triangle"></strong>
<p> W&#xE4;hlen Sie beim Speichern unbedingt den Typ &quot;OpenDocument Textdokumentvorlage (*.ott)&quot;</p>
</blockquote>
<ul>
<li>Wenn Sie jetzt die Vorlage normal durch Doppelklick im Dateimanager
&#xF6;ffnen, erhalten Sie einen ausgef&#xFC;llten Briefkopf mit dem von Ihnen
eingef&#xFC;gten Text. Als Absender wird immer der in der Wollmux
Kommandozentrale eingestellte Absender verwendet.</li>
<li>Falls gew&#xFC;nscht kann die Vorlage in ein Men&#xFC; der WollMux-Leiste
eingepflegt werden.</li>
</ul>
<h1 id="hinweise-und-tips">Hinweise und Tips</h1>
<h2 id="grafiken-und-text-in-der-fusszeile">Grafiken und Text in der Fusszeile</h2>
<p>Viele Dienststellen verwenden in der Fusszeile ihres externen
Briefkopfes Logos. F&#xFC;r die Fusszeilen wurden 3 Beispiele (2-, 3-, oder
4-spaltig) zur Verf&#xFC;gung gestellt. Die Logos k&#xF6;nnen &#xFC;ber Textfragmente
an beliebiger Stelle in der Fusszeile eingef&#xFC;gt werden. Allerdings ist
zu beachten, dass Grafiken und Text m&#xF6;glichst nicht in einer Spalte
stehen sollten, da die Formatierung des Textes (insb. der ersten Zeile)
verloren geht. Am besten legt man das Logo in eine eigene kleine Spalte,
die in jede der Fusszeilen(-spalten) eingef&#xFC;gt werden kann.</p>
<h2 id="formatvorlagen">Formatvorlagen</h2>
<p>Wie oben schon erw&#xE4;hnt, befinden sich die in den Textfragmenten <a href="Formatvorlagen.html" title="wikilink">verwendeten Formatvorlagen</a> in separaten
Vorlagendateien. Dies erleichtert es die gleichen Formatvorlagen in
allen Textfragmente und Briefkopfvorlagen zu verwenden. Die Vorlage mit
den &quot;ausgelagerten&quot; Formatvorlagen wird genauso wie die Textfragmente
&#xFC;ber eine Textmarke in die &quot;Mastervorlage&quot; eingef&#xFC;gt. Damit stehen dort
alle Formatvorlagen zur Verf&#xFC;gung.</p>
<p>Einige Punkte gibt es dabei zu beachten:</p>
<ol>
<li>Die Formatvorlage &quot;Standard&quot; darf nicht in Vorlagen und auch nicht
als Basis f&#xFC;r Verkn&#xFC;pfungen verwendet werden. Statt dessen kann f&#xFC;r
normalen Flie&#xDF;text die Formatvorlage &quot;Flie&#xDF;text&quot; benutzt werden.</li>
<li>Es d&#xFC;rfen in der Mastervorlage keine Formatvorlagen mit gleichen
Namen, wie die einzuf&#xFC;genden Formatvorlagen verwendet werden. Eine
&quot;&#xDC;berschreibung&quot; der Werte der bereits vorhandenen Formatvorlagen
mit neu eingef&#xFC;gten ist nicht m&#xF6;glich.</li>
<li>Die Textmarke f&#xFC;r die Vorlagendatei muss m&#xF6;glichst am Anfang der
Mastervorlage vor der ersten Textmarke, die auf ein Textfragment
verweist, eingef&#xFC;gt werden. Im externen Briefkopf steht die
Textmarke vor dem &quot;L&quot; von &quot;Landeshauptstadt M&#xFC;nchen&quot;. Auf das Layout
des Briefkopfs hat dies keine Auswirkung.</li>
<li>Die Formatvorlagen f&#xFC;r vorgegebenen Text oder f&#xFC;r Textmarken, die
direkt auf Datenquellen verweisen, m&#xFC;ssen sich logischerweise in der
&quot;Mastervorlage&quot; befinden, damit sie verwendet werden. Es schadet
nicht, wenn die Formatvorlagen mit gleichen Namen mittels der &#xFC;ber
ein Textfragment eingef&#xFC;gten Vorlage mit den ausgelagerten
Formatvorlagen nochmals eingef&#xFC;gt werden, da sie nicht
&#xFC;berschrieben werden.</li>
<li><p>Wichtig ist, dass die Formatvorlagen in den Textfragmenten den
gleichen Namen wie die passende Formatvorlage in der Vorlage mit den
Formatvorlagen haben. Ist dies nicht der Fall , werden beim Einf&#xFC;gen
in die Mastervorlage die Formatvorlagen aus dem Textfragment
verwendet und nicht die Formatvorlagen aus der Vorlagendatei. Es
spielt keine Rolle, ob die Formatvorlagen im Textfragment nur den
entsprechenden Namen oder den entsprechenden Namen mit den
identischen Einstellungen haben, da beim Einf&#xFC;gen ins Masterdokument
die Einstellungen aus der Vorlagendatei hergenommen werden.</p>
<p>Zweck dieses Vorgehens ist es alle Formatvorlagen an einer zentralen Stelle zu sammeln, um bei sp&#xE4;teren &#xC4;nderungen an den Formaten, diese nur an einer Stelle vornehmen zu m&#xFC;ssen.</p>
</li>
</ol>
<h2 id="verschachtelte-textfragmente">&quot;Verschachtelte&quot; Textfragmente</h2>
<p>Es besteht nat&#xFC;rlich auch die M&#xF6;glichkeit in Textfragmenten auf andere
Textfragmente zu verweisen. Im Externen Briefkopf z.B. gibt es eine
Textmarke, die auf eine Textfragment &quot;Fusszeile...&quot; verweist. Das
Textfragment &quot;Fusszeile...&quot; verweist wiederum auf weitere Textfragmente,
die Informationen zu &#xD6;PNV, Homepage o.&#xE4;. enthalten.</p>
<h2 id="dokumentschutz">Dokumentschutz</h2>
<p>Es gibt verschiedene Methoden, das Dokument zu sch&#xFC;tzen</p>
<ul>
<li>Extras/Optionen/OpenOffice.org/Sicherheit Checkbox &quot;Dieses Dokument
schreibgesch&#xFC;tzt &#xF6;ffnen&quot; anschalten, dann wird das aktuelle Dokument
beim Speichern gesch&#xFC;tzt, so dass es beim erneuten &#xD6;ffnen
schreibgesch&#xFC;tzt ge&#xF6;ffnet wird.<ul>
<li>Die Funktion betrifft nur das aktuelle Dokument (obwohl sie in
Extras/Optionen steht)</li>
<li>Dies funktioniert auch bei Vorlagen (dann wird das Unbenannte
Dokument schreibgesch&#xFC;tzt)</li>
<li>Man kann Bereiche definieren, die auch bei schreibgesch&#xFC;tzten
Dokumenten bearbeitbar sind (nur so ergibt z.B. das Sch&#xFC;tzen von
Vorlagen einen Sinn)</li>
</ul>
</li>
<li>Mit der Maus Text markieren und Einf&#xFC;gen/Bereich w&#xE4;hlen erlaubt es,
einen Bereich einzuf&#xFC;hren, den man sch&#xFC;tzen kann. Dieser Bereich ist
auch im nicht schreibgesch&#xFC;tzten Dokument nicht beschreibbar. Wie
oben erw&#xE4;hnt kann man umgekehrt auch Bereiche definieren, die auch
in schreibgesch&#xFC;tzten Dokumenten beschreibbar sind.</li>
</ul>
<kategorie:office_vorlagenumsteller_handbuch>

<p><category:ag-office> <category:eierlegender_wollmux></category:eierlegender_wollmux></category:ag-office></p>
<category:handbuch_des_wollmux>



<script type="text/javascript">var className='toc';</script></category:handbuch_des_wollmux></kategorie:office_vorlagenumsteller_handbuch>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Dokumentkommandos_des_WollMux.html" class="navigation navigation-prev " aria-label="Previous page: Dokumentkommandos des WollMux">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Fehler_im_WollMux_melden.html" class="navigation navigation-next " aria-label="Next page: Fehler im WollMux Melden">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Erstellung oder Anpassung einer Vorlage - Beispiel","level":"1.4.5","depth":2,"next":{"title":"Fehler im WollMux Melden","level":"1.4.6","depth":2,"path":"Fehler_im_WollMux_melden.md","ref":"Fehler_im_WollMux_melden.md","articles":[]},"previous":{"title":"Dokumentkommandos des WollMux","level":"1.4.4","depth":2,"path":"Dokumentkommandos_des_WollMux.md","ref":"Dokumentkommandos_des_WollMux.md","articles":[]},"dir":"ltr"},"config":{"plugins":["atoc","collapsible-menu","forkmegithub","richquotes","redirect","splitter","back-to-top-button"],"root":"markdown","styles":{"website":"styles/website.css"},"pluginsConfig":{"collapsible-menu":{},"atoc":{"addClass":true,"className":"toc"},"splitter":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"richquotes":{},"highlight":{},"back-to-top-button":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"redirect":{},"forkmegithub":{"color":"gray","url":"https://github.com/WollMux/WollMux"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Landeshauptstadt München","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"WollMux Handbuch","language":"de","links":{"sidebar":{"Homepage":"http://www.wollmux.org"}},"gitbook":"3.x.x"},"file":{"path":"Erstellung_oder_Anpassung_einer_Vorlage_-_Beispiel.md","mtime":"2017-06-27T06:51:47.556Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2018-12-10T13:17:07.315Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-atoc/atoc.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-forkmegithub/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

